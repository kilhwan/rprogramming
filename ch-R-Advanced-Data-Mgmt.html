<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 R 고급 데이터 변환 | R 프로그래밍 (개정판)</title>
  <meta name="description" content="이 책은 경영정보시스템실습의 주교재로 사용되기 위해 개발되었습니다." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 R 고급 데이터 변환 | R 프로그래밍 (개정판)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="이 책은 경영정보시스템실습의 주교재로 사용되기 위해 개발되었습니다." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 R 고급 데이터 변환 | R 프로그래밍 (개정판)" />
  
  <meta name="twitter:description" content="이 책은 경영정보시스템실습의 주교재로 사용되기 위해 개발되었습니다." />
  

<meta name="author" content="Kilhwan Kim" />


<meta name="date" content="2020-09-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch-visualization.html"/>
<link rel="next" href="ch-R-Programming-Structure.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-176754989-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176754989-1');
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R 프로그래밍</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#판-서문"><i class="fa fa-check"></i>1판 서문</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#판-서문-1"><i class="fa fa-check"></i>2판 서문</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ch-intro.html"><a href="ch-intro.html"><i class="fa fa-check"></i><b>1</b> R 설치 및 시작</a><ul>
<li class="chapter" data-level="1.1" data-path="ch-intro.html"><a href="ch-intro.html#sec:Rintro"><i class="fa fa-check"></i><b>1.1</b> R 소개</a></li>
<li class="chapter" data-level="1.2" data-path="ch-intro.html"><a href="ch-intro.html#sec:installation"><i class="fa fa-check"></i><b>1.2</b> R 설치하기</a><ul>
<li class="chapter" data-level="1.2.1" data-path="ch-intro.html"><a href="ch-intro.html#r-배포판-내려받기"><i class="fa fa-check"></i><b>1.2.1</b> R 배포판 내려받기</a></li>
<li class="chapter" data-level="1.2.2" data-path="ch-intro.html"><a href="ch-intro.html#설치에-앞서-주의할-사항"><i class="fa fa-check"></i><b>1.2.2</b> 설치에 앞서 주의할 사항</a></li>
<li class="chapter" data-level="1.2.3" data-path="ch-intro.html"><a href="ch-intro.html#r-설치하기"><i class="fa fa-check"></i><b>1.2.3</b> R 설치하기</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ch-intro.html"><a href="ch-intro.html#sec:RStudio"><i class="fa fa-check"></i><b>1.3</b> RStudio</a><ul>
<li class="chapter" data-level="1.3.1" data-path="ch-intro.html"><a href="ch-intro.html#rstudio-설치"><i class="fa fa-check"></i><b>1.3.1</b> RStudio 설치</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ch-intro.html"><a href="ch-intro.html#sec:R_start"><i class="fa fa-check"></i><b>1.4</b> RStudio로 R 시작하기</a><ul>
<li class="chapter" data-level="1.4.1" data-path="ch-intro.html"><a href="ch-intro.html#r-콘솔과-프롬프트"><i class="fa fa-check"></i><b>1.4.1</b> R 콘솔과 프롬프트</a></li>
<li class="chapter" data-level="1.4.2" data-path="ch-intro.html"><a href="ch-intro.html#r-콘솔-사용과-관련된-몇-가지-팁"><i class="fa fa-check"></i><b>1.4.2</b> R 콘솔 사용과 관련된 몇 가지 팁</a></li>
<li class="chapter" data-level="1.4.3" data-path="ch-intro.html"><a href="ch-intro.html#r-스크립트-파일-만들기"><i class="fa fa-check"></i><b>1.4.3</b> R 스크립트 파일 만들기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html"><i class="fa fa-check"></i><b>2</b> R 데이터 기초</a><ul>
<li class="chapter" data-level="2.1" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#단순한-데이터-형태"><i class="fa fa-check"></i><b>2.1</b> 단순한 데이터 형태</a></li>
<li class="chapter" data-level="2.2" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#단순-연산"><i class="fa fa-check"></i><b>2.2</b> 단순 연산</a></li>
<li class="chapter" data-level="2.3" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#변수와-할당"><i class="fa fa-check"></i><b>2.3</b> 변수와 할당</a></li>
<li class="chapter" data-level="2.4" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#함수를-이용한-연산"><i class="fa fa-check"></i><b>2.4</b> 함수를 이용한 연산</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html"><i class="fa fa-check"></i><b>3</b> R 벡터</a><ul>
<li class="chapter" data-level="3.1" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#숫자-벡터"><i class="fa fa-check"></i><b>3.1</b> 숫자 벡터</a><ul>
<li class="chapter" data-level="3.1.1" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#c-함수를-이용한-숫자-벡터-만들기"><i class="fa fa-check"></i><b>3.1.1</b> c() 함수를 이용한 숫자 벡터 만들기</a></li>
<li class="chapter" data-level="3.1.2" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#패턴을-이용한-숫자-벡터-만들기"><i class="fa fa-check"></i><b>3.1.2</b> 패턴을 이용한 숫자 벡터 만들기</a></li>
<li class="chapter" data-level="3.1.3" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#숫자-벡터의-연산"><i class="fa fa-check"></i><b>3.1.3</b> 숫자 벡터의 연산</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#논리-벡터"><i class="fa fa-check"></i><b>3.2</b> 논리 벡터</a></li>
<li class="chapter" data-level="3.3" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#문자-벡터"><i class="fa fa-check"></i><b>3.3</b> 문자 벡터</a></li>
<li class="chapter" data-level="3.4" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#결측치-missing-values"><i class="fa fa-check"></i><b>3.4</b> 결측치 (Missing Values)</a></li>
<li class="chapter" data-level="3.5" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#인덱스-벡터와-필터링"><i class="fa fa-check"></i><b>3.5</b> 인덱스 벡터와 필터링</a><ul>
<li class="chapter" data-level="3.5.1" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#자연수-인덱스-벡터"><i class="fa fa-check"></i><b>3.5.1</b> 자연수 인덱스 벡터</a></li>
<li class="chapter" data-level="3.5.2" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#음의-정수-인덱스-벡터"><i class="fa fa-check"></i><b>3.5.2</b> 음의 정수 인덱스 벡터</a></li>
<li class="chapter" data-level="3.5.3" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#논리-인덱스-벡터"><i class="fa fa-check"></i><b>3.5.3</b> 논리 인덱스 벡터</a></li>
<li class="chapter" data-level="3.5.4" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#이름-인덱스-벡터"><i class="fa fa-check"></i><b>3.5.4</b> 이름 인덱스 벡터</a></li>
<li class="chapter" data-level="3.5.5" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#인덱스-벡터를-이용해-벡터-요소에-값-할당하기"><i class="fa fa-check"></i><b>3.5.5</b> 인덱스 벡터를 이용해 벡터 요소에 값 할당하기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html"><i class="fa fa-check"></i><b>4</b> R 행렬</a><ul>
<li class="chapter" data-level="4.1" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬-만들기"><i class="fa fa-check"></i><b>4.1</b> 행렬 만들기</a></li>
<li class="chapter" data-level="4.2" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#벡터를-결합하여-행렬-만들기"><i class="fa fa-check"></i><b>4.2</b> 벡터를 결합하여 행렬 만들기</a></li>
<li class="chapter" data-level="4.3" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬의-필터링"><i class="fa fa-check"></i><b>4.3</b> 행렬의 필터링</a></li>
<li class="chapter" data-level="4.4" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬의-연산"><i class="fa fa-check"></i><b>4.4</b> 행렬의 연산</a></li>
<li class="chapter" data-level="4.5" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬과-함수"><i class="fa fa-check"></i><b>4.5</b> 행렬과 함수</a><ul>
<li class="chapter" data-level="4.5.1" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬을-인수로-하는-함수들"><i class="fa fa-check"></i><b>4.5.1</b> 행렬을 인수로 하는 함수들</a></li>
<li class="chapter" data-level="4.5.2" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬의-행별-또는-열별로-함수를-적용하는-방법"><i class="fa fa-check"></i><b>4.5.2</b> 행렬의 행별 또는 열별로 함수를 적용하는 방법</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#sec:RMatrix-array"><i class="fa fa-check"></i><b>4.6</b> 배열</a><ul>
<li class="chapter" data-level="4.6.1" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#배열의-생성"><i class="fa fa-check"></i><b>4.6.1</b> 배열의 생성</a></li>
<li class="chapter" data-level="4.6.2" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#배열도-결국-벡터"><i class="fa fa-check"></i><b>4.6.2</b> 배열도 결국 벡터</a></li>
<li class="chapter" data-level="4.6.3" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#배열의-연산과-필터링"><i class="fa fa-check"></i><b>4.6.3</b> 배열의 연산과 필터링</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#sec:RMatrix-operation-advanced"><i class="fa fa-check"></i><b>4.7</b> 행렬과 배열의 고급 연산</a><ul>
<li class="chapter" data-level="4.7.1" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬의-곱"><i class="fa fa-check"></i><b>4.7.1</b> 행렬의 곱</a></li>
<li class="chapter" data-level="4.7.2" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬의-주대각선-요소와-대각행렬"><i class="fa fa-check"></i><b>4.7.2</b> 행렬의 주대각선 요소와 대각행렬</a></li>
<li class="chapter" data-level="4.7.3" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#연립-일차-방정식과-역행렬"><i class="fa fa-check"></i><b>4.7.3</b> 연립 일차 방정식과 역행렬</a></li>
<li class="chapter" data-level="4.7.4" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#고유치eigenvalues와-고유벡터eigenvectors"><i class="fa fa-check"></i><b>4.7.4</b> 고유치(eigenvalues)와 고유벡터(eigenvectors)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-R-List.html"><a href="ch-R-List.html"><i class="fa fa-check"></i><b>5</b> R 리스트</a><ul>
<li class="chapter" data-level="5.1" data-path="ch-R-List.html"><a href="ch-R-List.html#객체-객체의-타입-객체의-속성"><i class="fa fa-check"></i><b>5.1</b> 객체, 객체의 타입, 객체의 속성</a></li>
<li class="chapter" data-level="5.2" data-path="ch-R-List.html"><a href="ch-R-List.html#리스트의-생성-및-필터링"><i class="fa fa-check"></i><b>5.2</b> 리스트의 생성 및 필터링</a></li>
<li class="chapter" data-level="5.3" data-path="ch-R-List.html"><a href="ch-R-List.html#리스트의-변경-및-연결"><i class="fa fa-check"></i><b>5.3</b> 리스트의 변경 및 연결</a></li>
<li class="chapter" data-level="5.4" data-path="ch-R-List.html"><a href="ch-R-List.html#리스트에-함수-적용하기"><i class="fa fa-check"></i><b>5.4</b> 리스트에 함수 적용하기</a><ul>
<li class="chapter" data-level="5.4.1" data-path="ch-R-List.html"><a href="ch-R-List.html#lapply-함수"><i class="fa fa-check"></i><b>5.4.1</b> lapply() 함수</a></li>
<li class="chapter" data-level="5.4.2" data-path="ch-R-List.html"><a href="ch-R-List.html#sapply-함수"><i class="fa fa-check"></i><b>5.4.2</b> sapply() 함수</a></li>
<li class="chapter" data-level="5.4.3" data-path="ch-R-List.html"><a href="ch-R-List.html#mapply-함수"><i class="fa fa-check"></i><b>5.4.3</b> mapply() 함수</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="ch-R-List.html"><a href="ch-R-List.html#리스트-활용-분야"><i class="fa fa-check"></i><b>5.5</b> 리스트 활용 분야</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html"><i class="fa fa-check"></i><b>6</b> R 데이터 프레임</a><ul>
<li class="chapter" data-level="6.1" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#범주형-데이터와-요인-factors"><i class="fa fa-check"></i><b>6.1</b> 범주형 데이터와 요인 (Factors)</a><ul>
<li class="chapter" data-level="6.1.1" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#명목형-변수와-요인"><i class="fa fa-check"></i><b>6.1.1</b> 명목형 변수와 요인</a></li>
<li class="chapter" data-level="6.1.2" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#순서형-변수와-요인"><i class="fa fa-check"></i><b>6.1.2</b> 순서형 변수와 요인</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#데이터-프레임-만들기"><i class="fa fa-check"></i><b>6.2</b> 데이터 프레임 만들기</a></li>
<li class="chapter" data-level="6.3" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#데이터-프레임-각-열의-지정"><i class="fa fa-check"></i><b>6.3</b> 데이터 프레임 각 열의 지정</a></li>
<li class="chapter" data-level="6.4" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#데이터-프레임의-필터링"><i class="fa fa-check"></i><b>6.4</b> 데이터 프레임의 필터링</a><ul>
<li class="chapter" data-level="6.4.1" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#리스트-형식으로-필터링"><i class="fa fa-check"></i><b>6.4.1</b> 리스트 형식으로 필터링</a></li>
<li class="chapter" data-level="6.4.2" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#행렬-형식으로-필터링"><i class="fa fa-check"></i><b>6.4.2</b> 행렬 형식으로 필터링</a></li>
<li class="chapter" data-level="6.4.3" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#subset을-이용한-필터링"><i class="fa fa-check"></i><b>6.4.3</b> subset()을 이용한 필터링</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#데이터-프레임에-함수-적용하기"><i class="fa fa-check"></i><b>6.5</b> 데이터 프레임에 함수 적용하기</a></li>
<li class="chapter" data-level="6.6" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#파일에서-데이터-읽어오기"><i class="fa fa-check"></i><b>6.6</b> 파일에서 데이터 읽어오기</a><ul>
<li class="chapter" data-level="6.6.1" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#텍스트-파일에서-데이터-읽어오기"><i class="fa fa-check"></i><b>6.6.1</b> 텍스트 파일에서 데이터 읽어오기</a></li>
<li class="chapter" data-level="6.6.2" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#excel-파일에서-데이터-읽어오기"><i class="fa fa-check"></i><b>6.6.2</b> Excel 파일에서 데이터 읽어오기</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#파일에-데이터-프레임-쓰기"><i class="fa fa-check"></i><b>6.7</b> 파일에 데이터 프레임 쓰기</a></li>
<li class="chapter" data-level="6.8" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#데이터-프레임의-열을-변수처럼-이용하는-방법"><i class="fa fa-check"></i><b>6.8</b> 데이터 프레임의 열을 변수처럼 이용하는 방법</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html"><i class="fa fa-check"></i><b>7</b> dplyr을 이용한 데이터 변환</a><ul>
<li class="chapter" data-level="7.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec:tidyData"><i class="fa fa-check"></i><b>7.1</b> 정돈 데이터 (tidy data)</a><ul>
<li class="chapter" data-level="7.1.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#정돈-데이터-형식의-조건"><i class="fa fa-check"></i><b>7.1.1</b> 정돈 데이터 형식의 조건</a></li>
<li class="chapter" data-level="7.1.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#비정돈-데이터-형식"><i class="fa fa-check"></i><b>7.1.2</b> 비정돈 데이터 형식</a></li>
<li class="chapter" data-level="7.1.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#정돈-데이터를-사용하는-이유"><i class="fa fa-check"></i><b>7.1.3</b> 정돈 데이터를 사용하는 이유</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#tidyverse-패키지"><i class="fa fa-check"></i><b>7.2</b> <code>tidyverse</code> 패키지</a><ul>
<li class="chapter" data-level="7.2.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#tidyverse-패키지-설치"><i class="fa fa-check"></i><b>7.2.1</b> <code>tidyverse</code> 패키지 설치</a></li>
<li class="chapter" data-level="7.2.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#tidyverse-패키지-적재"><i class="fa fa-check"></i><b>7.2.2</b> <code>tidyverse</code> 패키지 적재</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec:dplyr"><i class="fa fa-check"></i><b>7.3</b> <code>dplyr</code> 패키지와 정돈 데이터의 변환</a><ul>
<li class="chapter" data-level="7.3.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#dplyr-패키지"><i class="fa fa-check"></i><b>7.3.1</b> <code>dplyr</code> 패키지</a></li>
<li class="chapter" data-level="7.3.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#정돈-데이터-변환의-종류"><i class="fa fa-check"></i><b>7.3.2</b> 정돈 데이터 변환의 종류</a></li>
<li class="chapter" data-level="7.3.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#mpg-데이터"><i class="fa fa-check"></i><b>7.3.3</b> <code>mpg</code> 데이터</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec:filter"><i class="fa fa-check"></i><b>7.4</b> <code>filter()</code>로 행 선택하기</a><ul>
<li class="chapter" data-level="7.4.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#선택-조건이-하나인-경우"><i class="fa fa-check"></i><b>7.4.1</b> 선택 조건이 하나인 경우</a></li>
<li class="chapter" data-level="7.4.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#여러-조건을-만족하는-행-추출하기"><i class="fa fa-check"></i><b>7.4.2</b> 여러 조건을 만족하는 행 추출하기</a></li>
<li class="chapter" data-level="7.4.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#논리-연산자로-복합-조건-만들기"><i class="fa fa-check"></i><b>7.4.3</b> 논리 연산자로 복합 조건 만들기</a></li>
<li class="chapter" data-level="7.4.4" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#결측치가-있는-경우"><i class="fa fa-check"></i><b>7.4.4</b> 결측치가 있는 경우</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec:arrange"><i class="fa fa-check"></i><b>7.5</b> <code>arrange()</code>로 행 정렬하기</a><ul>
<li class="chapter" data-level="7.5.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#desc를-이용하여-내림차순으로-정렬하기"><i class="fa fa-check"></i><b>7.5.1</b> <code>desc()</code>를 이용하여 내림차순으로 정렬하기</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec:select"><i class="fa fa-check"></i><b>7.6</b> <code>select()</code>를 이용하여 변수 이름으로 열 선택하기</a><ul>
<li class="chapter" data-level="7.6.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-이름을-나열하여-선택하기"><i class="fa fa-check"></i><b>7.6.1</b> 변수 이름을 나열하여 선택하기</a></li>
<li class="chapter" data-level="7.6.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-이름으로-변수-범위를-선택하기"><i class="fa fa-check"></i><b>7.6.2</b> 변수 이름으로 변수 범위를 선택하기</a></li>
<li class="chapter" data-level="7.6.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-이름을-매칭하여-선택하기"><i class="fa fa-check"></i><b>7.6.3</b> 변수 이름을 매칭하여 선택하기</a></li>
<li class="chapter" data-level="7.6.4" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-이름-바꾸기"><i class="fa fa-check"></i><b>7.6.4</b> 변수 이름 바꾸기</a></li>
<li class="chapter" data-level="7.6.5" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-순서-바꾸기"><i class="fa fa-check"></i><b>7.6.5</b> 변수 순서 바꾸기</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec:mutate"><i class="fa fa-check"></i><b>7.7</b> <code>mutate()</code>로 새로운 변수 만들기</a><ul>
<li class="chapter" data-level="7.7.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#transmute로-새로운-변수만-남기기"><i class="fa fa-check"></i><b>7.7.1</b> <code>transmute()</code>로 새로운 변수만 남기기</a></li>
<li class="chapter" data-level="7.7.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#새로운-변수를-만들-때-사용할-수-있는-함수들"><i class="fa fa-check"></i><b>7.7.2</b> 새로운 변수를 만들 때 사용할 수 있는 함수들</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec:summarize"><i class="fa fa-check"></i><b>7.8</b> <code>summarize()</code>로 변수 요약하기</a></li>
<li class="chapter" data-level="7.9" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec:groupBy"><i class="fa fa-check"></i><b>7.9</b> <code>group_by()</code>로 그룹 별로 요약하기</a></li>
<li class="chapter" data-level="7.10" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec:pipeOperator"><i class="fa fa-check"></i><b>7.10</b> <code>%&gt;%</code> 파이프 연산자</a><ul>
<li class="chapter" data-level="7.10.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#여러-단계를-거쳐-데이터를-변환할-때"><i class="fa fa-check"></i><b>7.10.1</b> 여러 단계를 거쳐 데이터를 변환할 때</a></li>
<li class="chapter" data-level="7.10.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#파이프-연산자"><i class="fa fa-check"></i><b>7.10.2</b> 파이프 연산자</a></li>
<li class="chapter" data-level="7.10.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#ungroup"><i class="fa fa-check"></i><b>7.10.3</b> <code>ungroup()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch-visualization.html"><a href="ch-visualization.html"><i class="fa fa-check"></i><b>8</b> ggplot2를 이용한 데이터 시각화</a><ul>
<li class="chapter" data-level="8.1" data-path="ch-visualization.html"><a href="ch-visualization.html#sec:getStarted-ggplot2"><i class="fa fa-check"></i><b>8.1</b> ggplot2 시작하기</a><ul>
<li class="chapter" data-level="8.1.1" data-path="ch-visualization.html"><a href="ch-visualization.html#subsec:tryGgplot"><i class="fa fa-check"></i><b>8.1.1</b> ggplot2 그래프 그려보기</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="ch-visualization.html"><a href="ch-visualization.html#sec:aesMapping"><i class="fa fa-check"></i><b>8.2</b> 데이터의 열을 도형의 속성에 대응시키기 (aesthetic mapping)</a><ul>
<li class="chapter" data-level="8.2.1" data-path="ch-visualization.html"><a href="ch-visualization.html#색상color-속성"><i class="fa fa-check"></i><b>8.2.1</b> 색상(<code>color</code>) 속성</a></li>
<li class="chapter" data-level="8.2.2" data-path="ch-visualization.html"><a href="ch-visualization.html#모양shape-속성"><i class="fa fa-check"></i><b>8.2.2</b> 모양(<code>shape</code>) 속성</a></li>
<li class="chapter" data-level="8.2.3" data-path="ch-visualization.html"><a href="ch-visualization.html#크기size와-투명도alpha-속성"><i class="fa fa-check"></i><b>8.2.3</b> 크기(<code>size</code>)와 투명도(<code>alpha</code>) 속성</a></li>
<li class="chapter" data-level="8.2.4" data-path="ch-visualization.html"><a href="ch-visualization.html#데이터의-한-열을-도형의-여러-속성에-대응시키기"><i class="fa fa-check"></i><b>8.2.4</b> 데이터의 한 열을 도형의 여러 속성에 대응시키기</a></li>
<li class="chapter" data-level="8.2.5" data-path="ch-visualization.html"><a href="ch-visualization.html#도형의-속성에-대응시키기-vs.-도형의-속성-인수를-설정하기"><i class="fa fa-check"></i><b>8.2.5</b> 도형의 속성에 대응시키기 vs. 도형의 속성 인수를 설정하기</a></li>
<li class="chapter" data-level="8.2.6" data-path="ch-visualization.html"><a href="ch-visualization.html#group-속성"><i class="fa fa-check"></i><b>8.2.6</b> <code>group</code> 속성</a></li>
<li class="chapter" data-level="8.2.7" data-path="ch-visualization.html"><a href="ch-visualization.html#그룹으로-나누어-선-그래프-그리기"><i class="fa fa-check"></i><b>8.2.7</b> 그룹으로 나누어 선 그래프 그리기</a></li>
<li class="chapter" data-level="8.2.8" data-path="ch-visualization.html"><a href="ch-visualization.html#이산형-변수는-group-속성으로-자동-매핑된다."><i class="fa fa-check"></i><b>8.2.8</b> 이산형 변수는 <code>group</code> 속성으로 자동 매핑된다.</a></li>
<li class="chapter" data-level="8.2.9" data-path="ch-visualization.html"><a href="ch-visualization.html#geom_smooth-함수에서-group-속성"><i class="fa fa-check"></i><b>8.2.9</b> <code>geom_smooth()</code> 함수에서 <code>group</code> 속성</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="ch-visualization.html"><a href="ch-visualization.html#sec:commonProblems"><i class="fa fa-check"></i><b>8.3</b> ggplot 명령문을 입력할 때 자주 발생하는 문제들</a></li>
<li class="chapter" data-level="8.4" data-path="ch-visualization.html"><a href="ch-visualization.html#sec:facets"><i class="fa fa-check"></i><b>8.4</b> 측면(facets)으로 나누어 그리기</a><ul>
<li class="chapter" data-level="8.4.1" data-path="ch-visualization.html"><a href="ch-visualization.html#facet_wrap로-일차원-측면-그래프-그리기"><i class="fa fa-check"></i><b>8.4.1</b> <code>facet_wrap()</code>로 일차원 측면 그래프 그리기</a></li>
<li class="chapter" data-level="8.4.2" data-path="ch-visualization.html"><a href="ch-visualization.html#facet_grid로-이차원-측면-그래프-그리기"><i class="fa fa-check"></i><b>8.4.2</b> <code>facet_grid()</code>로 이차원 측면 그래프 그리기</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="ch-visualization.html"><a href="ch-visualization.html#sec:layerAndGeom"><i class="fa fa-check"></i><b>8.5</b> 그래프 계층(layers)과 도형(geoms)</a><ul>
<li class="chapter" data-level="8.5.1" data-path="ch-visualization.html"><a href="ch-visualization.html#geom-함수의-순서와-그래프-계층"><i class="fa fa-check"></i><b>8.5.1</b> geom 함수의 순서와 그래프 계층</a></li>
<li class="chapter" data-level="8.5.2" data-path="ch-visualization.html"><a href="ch-visualization.html#ggplot-함수는-좌표축을-자동-조정한다."><i class="fa fa-check"></i><b>8.5.2</b> <code>ggplot()</code> 함수는 좌표축을 자동 조정한다.</a></li>
<li class="chapter" data-level="8.5.3" data-path="ch-visualization.html"><a href="ch-visualization.html#여러-데이터를-사용하여-그래프-계층-만들기"><i class="fa fa-check"></i><b>8.5.3</b> 여러 데이터를 사용하여 그래프 계층 만들기</a></li>
<li class="chapter" data-level="8.5.4" data-path="ch-visualization.html"><a href="ch-visualization.html#다른-데이터-범위로-그래프-계층-만들기"><i class="fa fa-check"></i><b>8.5.4</b> 다른 데이터 범위로 그래프 계층 만들기</a></li>
<li class="chapter" data-level="8.5.5" data-path="ch-visualization.html"><a href="ch-visualization.html#subsec:commonDataMapping"><i class="fa fa-check"></i><b>8.5.5</b> 공통 <code>data</code>와 <code>mapping</code>의 설정</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="ch-visualization.html"><a href="ch-visualization.html#sec:ggplotStat"><i class="fa fa-check"></i><b>8.6</b> 통계 변환</a><ul>
<li class="chapter" data-level="8.6.1" data-path="ch-visualization.html"><a href="ch-visualization.html#subsec:statCategorical"><i class="fa fa-check"></i><b>8.6.1</b> 범주형 변수의 통계 요약</a></li>
<li class="chapter" data-level="8.6.2" data-path="ch-visualization.html"><a href="ch-visualization.html#subsec:statNumerical"><i class="fa fa-check"></i><b>8.6.2</b> 수치형 변수의 통계 요약</a></li>
<li class="chapter" data-level="8.6.3" data-path="ch-visualization.html"><a href="ch-visualization.html#subsec:statNumericalPerCategory"><i class="fa fa-check"></i><b>8.6.3</b> 수치형 변수의 범주별 통계요약</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="ch-visualization.html"><a href="ch-visualization.html#sec:position"><i class="fa fa-check"></i><b>8.7</b> 위치 조정</a></li>
<li class="chapter" data-level="8.8" data-path="ch-visualization.html"><a href="ch-visualization.html#sec:typeofgraph"><i class="fa fa-check"></i><b>8.8</b> ggplot2 그래프의 종류</a><ul>
<li class="chapter" data-level="8.8.1" data-path="ch-visualization.html"><a href="ch-visualization.html#basic-graph"><i class="fa fa-check"></i><b>8.8.1</b> 기본 그래픽 함수</a></li>
<li class="chapter" data-level="8.8.2" data-path="ch-visualization.html"><a href="ch-visualization.html#onecategory"><i class="fa fa-check"></i><b>8.8.2</b> 한 범주형 변수의 그래프</a></li>
<li class="chapter" data-level="8.8.3" data-path="ch-visualization.html"><a href="ch-visualization.html#onenumeric"><i class="fa fa-check"></i><b>8.8.3</b> 한 수치형 변수의 그래프</a></li>
<li class="chapter" data-level="8.8.4" data-path="ch-visualization.html"><a href="ch-visualization.html#twocategories"><i class="fa fa-check"></i><b>8.8.4</b> 두 범주형 변수의 그래프</a></li>
<li class="chapter" data-level="8.8.5" data-path="ch-visualization.html"><a href="ch-visualization.html#category-numeric"><i class="fa fa-check"></i><b>8.8.5</b> 범주형 변수와 수치형 변수의 그래프</a></li>
<li class="chapter" data-level="8.8.6" data-path="ch-visualization.html"><a href="ch-visualization.html#twonumeric"><i class="fa fa-check"></i><b>8.8.6</b> 두 수치형 변수의 그래프</a></li>
<li class="chapter" data-level="8.8.7" data-path="ch-visualization.html"><a href="ch-visualization.html#morethanthree"><i class="fa fa-check"></i><b>8.8.7</b> 세 변수 이상의 그래프</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="ch-visualization.html"><a href="ch-visualization.html#modification"><i class="fa fa-check"></i><b>8.9</b> 그래프의 외양 바꾸기</a><ul>
<li class="chapter" data-level="8.9.1" data-path="ch-visualization.html"><a href="ch-visualization.html#axes"><i class="fa fa-check"></i><b>8.9.1</b> 좌표축의 조정</a></li>
<li class="chapter" data-level="8.9.2" data-path="ch-visualization.html"><a href="ch-visualization.html#labelsmodification"><i class="fa fa-check"></i><b>8.9.2</b> 레이블 조정</a></li>
<li class="chapter" data-level="8.9.3" data-path="ch-visualization.html"><a href="ch-visualization.html#themes"><i class="fa fa-check"></i><b>8.9.3</b> 테마 변경</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="ch-visualization.html"><a href="ch-visualization.html#misc"><i class="fa fa-check"></i><b>8.10</b> 기타 유용한 팁들</a><ul>
<li class="chapter" data-level="8.10.1" data-path="ch-visualization.html"><a href="ch-visualization.html#combinegraph"><i class="fa fa-check"></i><b>8.10.1</b> 여러 그래프를 한 도표에 넣기</a></li>
<li class="chapter" data-level="8.10.2" data-path="ch-visualization.html"><a href="ch-visualization.html#savegraph"><i class="fa fa-check"></i><b>8.10.2</b> 그래프 저장하기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html"><i class="fa fa-check"></i><b>9</b> R 고급 데이터 변환</a><ul>
<li class="chapter" data-level="9.1" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#데이터의-단순-결합"><i class="fa fa-check"></i><b>9.1</b> 데이터의 단순 결합</a><ul>
<li class="chapter" data-level="9.1.1" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#데이터를-행으로-결합하기"><i class="fa fa-check"></i><b>9.1.1</b> 데이터를 행으로 결합하기</a></li>
<li class="chapter" data-level="9.1.2" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#데이터를-열로-결합하기"><i class="fa fa-check"></i><b>9.1.2</b> 데이터를 열로 결합하기</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#관계형-데이터베이스처럼-데이터-결합하기"><i class="fa fa-check"></i><b>9.2</b> 관계형 데이터베이스처럼 데이터 결합하기</a><ul>
<li class="chapter" data-level="9.2.1" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#inner-join과-outer-join"><i class="fa fa-check"></i><b>9.2.1</b> Inner join과 outer join</a></li>
<li class="chapter" data-level="9.2.2" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#filtering-join"><i class="fa fa-check"></i><b>9.2.2</b> Filtering join</a></li>
<li class="chapter" data-level="9.2.3" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#join을-수행하는-다른-방법들"><i class="fa fa-check"></i><b>9.2.3</b> Join을 수행하는 다른 방법들</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#sec:tidyr"><i class="fa fa-check"></i><b>9.3</b> <code>tidyr</code> 패키지를 이용하여 정돈 데이터 형식으로 바꾸기</a><ul>
<li class="chapter" data-level="9.3.1" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#pivot_longer-여러-열에-걸친-한-변수의-데이터를-하나의-열로-길게-모으기"><i class="fa fa-check"></i><b>9.3.1</b> <code>pivot_longer</code>: 여러 열에 걸친 한 변수의 데이터를 하나의 열로 길게 모으기</a></li>
<li class="chapter" data-level="9.3.2" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#subsec:pivot-wider"><i class="fa fa-check"></i><b>9.3.2</b> <code>pivot_wider</code>: 여러 행에 걸쳐진 하나의 관측 데이터를 하나의 행으로 넓게 펼치기</a></li>
<li class="chapter" data-level="9.3.3" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#seperate-한-셀을-여러-셀로-분리하기"><i class="fa fa-check"></i><b>9.3.3</b> <code>seperate</code>: 한 셀을 여러 셀로 분리하기</a></li>
<li class="chapter" data-level="9.3.4" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#unite-여러-셀의-데이터를-하나의-셀로-병합하기"><i class="fa fa-check"></i><b>9.3.4</b> <code>unite</code>: 여러 셀의 데이터를 하나의 셀로 병합하기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html"><i class="fa fa-check"></i><b>10</b> R 프로그래밍 구조</a><ul>
<li class="chapter" data-level="10.1" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#r-조건문"><i class="fa fa-check"></i><b>10.1</b> R 조건문</a><ul>
<li class="chapter" data-level="10.1.1" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#if-조건문"><i class="fa fa-check"></i><b>10.1.1</b> if 조건문</a></li>
<li class="chapter" data-level="10.1.2" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#switch-함수"><i class="fa fa-check"></i><b>10.1.2</b> switch 함수</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#r-반복문"><i class="fa fa-check"></i><b>10.2</b> R 반복문</a><ul>
<li class="chapter" data-level="10.2.1" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#for-반복문"><i class="fa fa-check"></i><b>10.2.1</b> for 반복문</a></li>
<li class="chapter" data-level="10.2.2" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#while-반복문"><i class="fa fa-check"></i><b>10.2.2</b> while 반복문</a></li>
<li class="chapter" data-level="10.2.3" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#repeat-반복문"><i class="fa fa-check"></i><b>10.2.3</b> repeat 반복문</a></li>
<li class="chapter" data-level="10.2.4" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#반복문의-제어-명령"><i class="fa fa-check"></i><b>10.2.4</b> 반복문의 제어 명령</a></li>
<li class="chapter" data-level="10.2.5" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#r에서-반복문-사용의-주의점"><i class="fa fa-check"></i><b>10.2.5</b> R에서 반복문 사용의 주의점</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#r-함수"><i class="fa fa-check"></i><b>10.3</b> R 함수</a><ul>
<li class="chapter" data-level="10.3.1" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#함수의-생성과-호출"><i class="fa fa-check"></i><b>10.3.1</b> 함수의 생성과 호출</a></li>
<li class="chapter" data-level="10.3.2" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#함수-객체를-인수로-사용하기"><i class="fa fa-check"></i><b>10.3.2</b> 함수 객체를 인수로 사용하기</a></li>
<li class="chapter" data-level="10.3.3" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#r-연산자"><i class="fa fa-check"></i><b>10.3.3</b> R 연산자</a></li>
<li class="chapter" data-level="10.3.4" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#변수-범위"><i class="fa fa-check"></i><b>10.3.4</b> 변수 범위</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ch-R-OOP.html"><a href="ch-R-OOP.html"><i class="fa fa-check"></i><b>11</b> R 객체 지향 프로그래밍</a><ul>
<li class="chapter" data-level="11.1" data-path="ch-R-OOP.html"><a href="ch-R-OOP.html#객체-지향-프로그래밍"><i class="fa fa-check"></i><b>11.1</b> 객체 지향 프로그래밍</a></li>
<li class="chapter" data-level="11.2" data-path="ch-R-OOP.html"><a href="ch-R-OOP.html#s3-클래스"><i class="fa fa-check"></i><b>11.2</b> S3 클래스</a><ul>
<li class="chapter" data-level="11.2.1" data-path="ch-R-OOP.html"><a href="ch-R-OOP.html#s3-클래스-객체-만들기"><i class="fa fa-check"></i><b>11.2.1</b> S3 클래스 객체 만들기</a></li>
<li class="chapter" data-level="11.2.2" data-path="ch-R-OOP.html"><a href="ch-R-OOP.html#포괄-함수generic-functions"><i class="fa fa-check"></i><b>11.2.2</b> 포괄 함수(generic functions)</a></li>
<li class="chapter" data-level="11.2.3" data-path="ch-R-OOP.html"><a href="ch-R-OOP.html#s3에서-상속성의-구현"><i class="fa fa-check"></i><b>11.2.3</b> S3에서 상속성의 구현</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="ch-R-OOP.html"><a href="ch-R-OOP.html#s4-클래스"><i class="fa fa-check"></i><b>11.3</b> S4 클래스</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R 프로그래밍 (개정판)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch:R-Advanced-Data-Mgmt" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> R 고급 데이터 변환</h1>
<p>@ref(ch:dataTransformation}장과 <a href="ch-visualization.html#ch:visualization">8</a>장에서 정돈 형식의 데이터를 변환하고 시각화하는 방법을 배웠다. 그러나 실제 데이터 분석에서는 분석하고자 하는 데이터가 하나의 데이터 프레임으로 정돈 형식으로 제공되는 경우가 많지 않다. 대부분의 경우 다음 두 가지 작업 중 하나 또는 두 가지 모두가 필요한 경우가 많다.</p>
<ul>
<li>[Merge] 다양한 원천에서 획득된 데이터를 하나의 정돈 형식의 데이터로 결합하기</li>
<li>[Reshape] 비정돈 형식의 데이터의 모양 및 형식을 정돈 데이터 형식으로 변형하기</li>
</ul>
<p>본 장에서는 이러한 데이터의 전처리에 필요한 다양한 기법을 논의한다.
데이터의 결합을 위해서는 dplyr 패키지를 사용할 것이며, 비정돈 형식의 데이터를 정돈 데이터 형식으로 변형하기 위해서는 tidyr 패키지를 사용할 것이다. 이 두 패키지는 모두 tidyverse 패키지에 속해 있으므로, 이 두 패키지를 사용하기 위해서 tidyverse 패키지를 적재한다.</p>
<div class="sourceCode" id="cb1621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1621-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1621-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<div id="데이터의-단순-결합" class="section level2">
<h2><span class="header-section-number">9.1</span> 데이터의 단순 결합</h2>
<div id="행으로-결합-vs.-열로-결합" class="section level4 unnumbered">
<h4>행으로 결합 vs. 열로 결합</h4>
<p>데이터에 대한 결합이 필요한 다음 두 가지 상황을 고려해 보자.</p>
<ul>
<li><p>데이터가 동일한 열 형식으로 여러 파일로 나뉘어져 있는 경우: 예를 들어 판매 실적 데이터가 2015년 데이터는 2015.csv 파일에 2016년 데이터는 2016.csv 파일에 있다고 가정해 보자. 이 경우 각 파일을 별도의 데이터 프레임으로 읽어들인 후 rbind() 함수를 이용하여 결합시킬 수 있다.</p></li>
<li><p>데이터가 동일한 행으로 되어 있으나, 서로 다른 열을 가지고 있는 경우: 예를 들어 사원 번호 순으로 한 파일에는 입사시점의 개인 정보가, 다른 파일에는 작년 인사 평가 결과 데이터가 있다고 하자. 두 파일에 동일한 사원 번호 순으로 데이터가 기록되어 있다면 두 파일의 정보를 데이터 프레임으로 읽어들인 후 cbind()로 결합할 수 있을 것이다.</p></li>
</ul>
<p>데이터 프레임을 행과 열로 결합은 <a href="ch-R-Data-Frame.html#ch:R-Data-Frame">6</a>장에서 <code>rbind()</code>와 <code>cbind()</code> 함수를 사용하는 것을 보았을 것이다. 다음에 설명하는 데이터의 행과 열로 결합하는 내용은 R의 기본 함수인 <code>rbind()</code>와 <code>cbind()</code>를 사용하여도 수행할 수 있다. 그러나 이 책에서는 dplyr 패키지의 <code>bind_rows()</code>와 <code>bind_cols()</code> 함수를 사용하여 여러 데이터 프레임을 행과 열로 결합할 것이다.<br />
<code>bind_rows()</code>와 <code>bind_cols()</code> 함수를 사용하는 이유는 이 두 함수가 R의 기본 함수보다 처리 속도가 빠를 뿐 아니라, R의 기본 함수는 한번에 두 개의 데이터 프레임만 결합할 수 있는데, dplyr 패키지의 함수는 세 개 이상의 데이터 프레임도 한번에 결합시킬 수 있기 때문이다. 또한 R의 기본 함수보다는 편리한 기능을 가지고 있다.</p>
</div>
<div id="데이터를-행으로-결합하기" class="section level3">
<h3><span class="header-section-number">9.1.1</span> 데이터를 행으로 결합하기</h3>
<div id="열-구조가-다른-데이터를-행으로-결합하기" class="section level4 unnumbered">
<h4>열 구조가 다른 데이터를 행으로 결합하기</h4>
<p>데이터를 행으로 결합하는 작업이 필요한 경우, 데이터가 동일한 열 구조를 가지고 있지 않은 경우가 종종 발생한다. 동일한 열을 가지고 있더라도 열 이름이 서로 다른 경우도 있다. 이런 경우에는 결합하려는 데이터 프레임을 동일한 열 구조로 변형하여 결합하여야 한다.</p>
<p>예를 들어 다음과 같이 class1.csv와 class2.csv 파일에 두 분반의 중간 및 기말 고사 정보 등이 들어 있다고 하자.</p>
<div class="sourceCode" id="cb1622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1622-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1622-1"></a><span class="op">&gt;</span><span class="st"> </span>class1 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/class1.csv&quot;</span>, <span class="dt">fileEncoding=</span><span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb1622-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1622-2"></a><span class="op">&gt;</span><span class="st"> </span>class2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/class2.csv&quot;</span>, <span class="dt">fileEncoding=</span><span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb1622-3"><a href="ch-R-Advanced-Data-Mgmt.html#cb1622-3"></a><span class="op">&gt;</span><span class="st"> </span>class1</span></code></pre></div>
<pre><code>   ID   Name Gender Year Address Midterm Final Team
1  15 김철수      M    1    서울      78    59    A
2  18 김영희      F    3    경기      85    87    A
3  25 이철수      M    3    충남      80    70    B
4  34 이영희      F    2    대전      92    89    B
5 151 홍길동   Male    4    세종      58    66    B</code></pre>
<div class="sourceCode" id="cb1624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1624-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1624-1"></a><span class="op">&gt;</span><span class="st"> </span>class2</span></code></pre></div>
<pre><code>  ID Mid Final   Name Team Gen Year
1 12  75    79 장철수    C   M    2
2 19  75    89 장영희    C   F    2
3 28  87    76 최철수    D   M    1
4 45  82    79 최영희    D   F   30</code></pre>
<p>두 파일 모두 학번(ID), 중간고사(Midterm), 기말고사(Final), 프로젝트 팀(Team), 성별(Gender), 학년(Year)에 대한 정보를 포함하고 있으나, class1에는 학생의 주소(Address) 정보가 포함되어 있고 class2는 그렇지 않다. 또한 두 파일의 열의 위치도 다르고 열의 이름도 조금 다르다.</p>
</div>
<div id="rbind는-열의-개수가-다른-데이터는-행으로-결합하지-못한다." class="section level4 unnumbered">
<h4><code>rbind()</code>는 열의 개수가 다른 데이터는 행으로 결합하지 못한다.</h4>
<p>두 분반 학생의 점수를 통합하여 성적 처리를 하기 위해 두 분반의 데이터를 결합하려고 한다고 하자. 이를 어떻게 수행하여야 할까? <code>rbind()</code>로 먼저 두 데이터 프레임을 통합하려고 시도해 보자.</p>
<div class="sourceCode" id="cb1626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1626-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1626-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">rbind</span>(class1, class2)</span></code></pre></div>
<pre><code>Error in rbind(deparse.level, ...): numbers of columns of arguments do not match</code></pre>
<p>열의 수가 다르기 때문에 결합이 되지 않음을 알 수 있다. 따라서 <code>rbind()</code>로 두 데이터를 결합하려면 class1에만 있는 Address 열을 어떻게 처리할지를 결정해야 한다. 일반적으로 다음 둘 중 하나의 방법을 택해야 문제를 해결한다. 첫번째 방법은 class1의 Address 열을 제외하고 결합하는 것이고, 두번째 방법은 class2에 Address 열을 추가하고 결측치(NA)로 값을 준 후 결합하는 것이다.</p>
</div>
<div id="bind_rows는-열의-개수가-다른-데이터도-행으로-결합을-한다." class="section level4 unnumbered">
<h4><code>bind_rows()</code>는 열의 개수가 다른 데이터도 행으로 결합을 한다.</h4>
<p>두 분반 학생의 데이터를 dplyr 패키지의 <code>bind_rows()</code> 함수를 사용하여 연결해 보자.</p>
<div class="sourceCode" id="cb1628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1628-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1628-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">bind_rows</span>(class1, class2)</span></code></pre></div>
<pre><code>   ID   Name Gender Year Address Midterm Final Team Mid  Gen
1  15 김철수      M    1    서울      78    59    A  NA &lt;NA&gt;
2  18 김영희      F    3    경기      85    87    A  NA &lt;NA&gt;
3  25 이철수      M    3    충남      80    70    B  NA &lt;NA&gt;
4  34 이영희      F    2    대전      92    89    B  NA &lt;NA&gt;
5 151 홍길동   Male    4    세종      58    66    B  NA &lt;NA&gt;
6  12 장철수   &lt;NA&gt;    2    &lt;NA&gt;      NA    79    C  75    M
7  19 장영희   &lt;NA&gt;    2    &lt;NA&gt;      NA    89    C  75    F
8  28 최철수   &lt;NA&gt;    1    &lt;NA&gt;      NA    76    D  87    M
9  45 최영희   &lt;NA&gt;   30    &lt;NA&gt;      NA    79    D  82    F</code></pre>
<p>열의 개수가 달라도 결합이 이루어지는 것을 볼 수 있다. 두 데이터에서 서로 없는 열은 결측치 <code>NA</code>로 처리되어 결합이 이루어지는 것을 볼 수 있다. 그러나 사실 <code>class1</code>의 <code>Midterm</code>과 <code>class2</code>의 <code>Mid</code>는 중간고사 점수 열로 같으나 이름이 다른 것 뿐이다. <code>bind_rows()</code>는 이름이 다르면 서로 다른 열이라고 생각하여 각각의 새로운 열을 만들어 결합을 한다. 그러므로 사실상 같은 열이 서로 다른 이름으로 되어 있는지 살펴보아야 한다.</p>
</div>
<div id="rbind는-두-데이터의-열의-이름이-다른-경우-행으로-결합하지-못한다." class="section level4 unnumbered">
<h4><code>rbind()</code>는 두 데이터의 열의 이름이 다른 경우 행으로 결합하지 못한다.</h4>
<p><code>class1</code> 데이터의 Address 열을 제외하고 두 데이터를 다시 <code>rbind()</code>로 결합해 보자.</p>
<div class="sourceCode" id="cb1630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1630-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1630-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">rbind</span>(<span class="kw">select</span>(class1, <span class="op">-</span>Address), class2)</span></code></pre></div>
<pre><code>Error in match.names(clabs, names(xi)): names do not match previous names</code></pre>
<p>열의 개수가 동일하더라도 두 데이터 프레임의 열의 이름이 서로 다르면 행으로 결합을 해주지 않음을 볼 수 있다. 지금 중간고사 점수 열과 성별 열의 이름이 서로 다르기 때문에 연결이 안되는 것이므로 다음처럼 열의 이름을 변경한 후 두 데이터 프레임을 행으로 연결시킨다.</p>
<div class="sourceCode" id="cb1632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1632-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1632-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">rbind</span>(<span class="kw">select</span>(class1, <span class="op">-</span>Address), <span class="kw">rename</span>(class2, <span class="dt">Midterm =</span> Mid, <span class="dt">Gender =</span> Gen))</span></code></pre></div>
<pre><code>   ID   Name Gender Year Midterm Final Team
1  15 김철수      M    1      78    59    A
2  18 김영희      F    3      85    87    A
3  25 이철수      M    3      80    70    B
4  34 이영희      F    2      92    89    B
5 151 홍길동   Male    4      58    66    B
6  12 장철수      M    2      75    79    C
7  19 장영희      F    2      75    89    C
8  28 최철수      M    1      87    76    D
9  45 최영희      F   30      82    79    D</code></pre>
</div>
<div id="rbind와-bind_rows는-열의-순서를-자동으로-맞춘다." class="section level4 unnumbered">
<h4><code>rbind()</code>와 <code>bind_rows()</code>는 열의 순서를 자동으로 맞춘다.</h4>
<p>이제 두 데이터 프레임의 열의 형태가 같아졌으므로 <code>bind_rows()</code>로 두 데이터를 원하는 방식으로 합칠 수 있다.
두 데이터 프레임의 열의 순서가 다른 경우 <code>rbind()</code>와 <code>bind_rows9)</code>는 첫번째 데이터 프레임의 열 이름을 기준으로 열의 순서를 자동으로 맞추어 준다.</p>
<div class="sourceCode" id="cb1634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1634-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1634-1"></a><span class="op">&gt;</span><span class="st"> </span>class12 &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(class1, <span class="kw">rename</span>(class2, <span class="dt">Midterm =</span> Mid, <span class="dt">Gender =</span> Gen))</span>
<span id="cb1634-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1634-2"></a><span class="op">&gt;</span><span class="st"> </span>class12</span></code></pre></div>
<pre><code>   ID   Name Gender Year Address Midterm Final Team
1  15 김철수      M    1    서울      78    59    A
2  18 김영희      F    3    경기      85    87    A
3  25 이철수      M    3    충남      80    70    B
4  34 이영희      F    2    대전      92    89    B
5 151 홍길동   Male    4    세종      58    66    B
6  12 장철수      M    2    &lt;NA&gt;      75    79    C
7  19 장영희      F    2    &lt;NA&gt;      75    89    C
8  28 최철수      M    1    &lt;NA&gt;      87    76    D
9  45 최영희      F   30    &lt;NA&gt;      82    79    D</code></pre>
<p>실제 데이터를 행으로 결합하는 과정에는 훨씬 더 다양한 문제들이 발생한다. 예를 들어 동일한 키를 나타내는 열이 하나는 cm로 하나는 m 단위로 정보가 주어져 있으면 이를 하나의 단위로 통일해야 한다. 그러나 복잡한 문제들도 서로 다른 열 구조를 가지는 데이터를 행으로 결합하기 위해서 어떤 열을 추가하거나 제외할 것인지를 결정하고, 열의 형식과 이름을 어떻게 통일할 것인가를 고려하는 과정이라는 점에서 본질적으로는 앞의 예와 동일하다 할 수 있다.</p>
</div>
</div>
<div id="데이터를-열로-결합하기" class="section level3">
<h3><span class="header-section-number">9.1.2</span> 데이터를 열로 결합하기</h3>
<div id="행-순서가-다른-데이터를-열로-결합하기" class="section level4 unnumbered">
<h4>행 순서가 다른 데이터를 열로 결합하기</h4>
<p>데이터를 열로 결합하는 경우 실제 데이터가 동일한 행 순서로 정렬되어 있지 않은 경우가 종종 있다.
예를 들어 앞의 예에서 성적 처리를 위해서는 학생의 중간, 기말 고사 점수와 함께 출석 점수를 고려해야 한다고 하자. 그리고 출석점수는 attendance.csv 파일에 다음과 같이 class1과 class2의 모든 학생의 학번(ID) 순으로 정렬되어 분반 정보(Class)와 출석 점수(Attend)가 저장되어 있다고 하자.</p>
<div class="sourceCode" id="cb1636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1636-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1636-1"></a><span class="op">&gt;</span><span class="st"> </span>attendance &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/attendance.csv&quot;</span>, <span class="dt">fileEncoding=</span><span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb1636-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1636-2"></a><span class="op">&gt;</span><span class="st"> </span>attendance</span></code></pre></div>
<pre><code>   ID Class Attend
1  12     2    185
2  15     1     90
3  18     1     95
4  19     2    100
5  25     1    100
6  28     2    100
7  34     1    100
8  45     2    100
9 151     1     95</code></pre>
<p>앞서 두 분반의 중간 및 기말 고사 점수가 합쳐진 class12 데이터 프레임은 학번이 기준이 아니라 분반 별로 먼저 정렬되어 있다. 따라서 이 두 데이터 프레임을 단순하게 cbind() 하면 출석점수가 엉뚱한 학생에게 부여된다.</p>
</div>
<div id="정렬-후-열로-결합하기" class="section level4 unnumbered">
<h4>정렬 후 열로 결합하기</h4>
<p>이를 해결하는 가장 간단한 방법은 두 데이터 프레임을 동일한 기준으로 정렬한 후 <code>cbind()</code>나 <code>bind_cols()</code>를 수행하는 것이다.
먼저 class12를 ID 순으로 정렬한 후 열로 결합해 보자.
그런데 ID 열은 두 데이터 프레임에 모두 있으므로 하나는 불필요하다. 따라서 attendance 데이터 프레임의 ID 정보는 제거한 후 결합한다.</p>
<div class="sourceCode" id="cb1638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1638-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1638-1"></a><span class="op">&gt;</span><span class="st"> </span>class12.a &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(<span class="kw">arrange</span>(class12, ID), <span class="kw">select</span>(attendance, <span class="op">-</span>ID))</span>
<span id="cb1638-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1638-2"></a><span class="op">&gt;</span><span class="st"> </span>class12.a</span></code></pre></div>
<pre><code>   ID   Name Gender Year Address Midterm Final Team Class Attend
1  12 장철수      M    2    &lt;NA&gt;      75    79    C     2    185
2  15 김철수      M    1    서울      78    59    A     1     90
3  18 김영희      F    3    경기      85    87    A     1     95
4  19 장영희      F    2    &lt;NA&gt;      75    89    C     2    100
5  25 이철수      M    3    충남      80    70    B     1    100
6  28 최철수      M    1    &lt;NA&gt;      87    76    D     2    100
7  34 이영희      F    2    대전      92    89    B     1    100
8  45 최영희      F   30    &lt;NA&gt;      82    79    D     2    100
9 151 홍길동   Male    4    세종      58    66    B     1     95</code></pre>
<p>다른 방법으로 attendance 데이터 프레임을 Class와 ID 열로 정렬한 후 class12 데이터 프레임과 결합할 수도 있다.</p>
<div class="sourceCode" id="cb1640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1640-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1640-1"></a><span class="op">&gt;</span><span class="st"> </span>class12.b &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(class12, attendance <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(Class, ID) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>ID))</span>
<span id="cb1640-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1640-2"></a><span class="op">&gt;</span><span class="st"> </span>class12.b</span></code></pre></div>
<pre><code>   ID   Name Gender Year Address Midterm Final Team Class Attend
1  15 김철수      M    1    서울      78    59    A     1     90
2  18 김영희      F    3    경기      85    87    A     1     95
3  25 이철수      M    3    충남      80    70    B     1    100
4  34 이영희      F    2    대전      92    89    B     1    100
5 151 홍길동   Male    4    세종      58    66    B     1     95
6  12 장철수      M    2    &lt;NA&gt;      75    79    C     2    185
7  19 장영희      F    2    &lt;NA&gt;      75    89    C     2    100
8  28 최철수      M    1    &lt;NA&gt;      87    76    D     2    100
9  45 최영희      F   30    &lt;NA&gt;      82    79    D     2    100</code></pre>
<p>실제 데이터는 이보다 더 복잡한 문제를 가지고 있는 경우가 많다. 예를 들어 한 파일에 있는 행이 다른 파일에는 없는 경우도 있다. 이러한 경우엔 그 행의 정보를 모두 제거할 것인지, 아니면 그 행에 대해 없는 정보는 NA로 하여 결합을 할지 결정해야 한다. 결국 <code>cbind()</code>나 <code>bind_rows()</code>를 이용하여 열로 결합하기 위해서는 두 데이터의 행이 동일한 개체에 대한 정보가 되도록 일치시키는 것이 중요하다. 그런데 매번 두 데이터가 동일한 행으로 결합되도록 정렬하여 결합하는 작업을 사용자가 직접 하는 것은 오류 발생 가능성이 많다. 따라서 이 작업은 다음에 소개하는 관계형 데이터베이스처럼 데이터 결합하기 방법을 사용할 것을 권장한다.</p>
</div>
</div>
</div>
<div id="관계형-데이터베이스처럼-데이터-결합하기" class="section level2">
<h2><span class="header-section-number">9.2</span> 관계형 데이터베이스처럼 데이터 결합하기</h2>
<p>관계형 데이터베이스에서는 서로 다른 열 정보를 담고 있는 두 데이터 테이블을 key를 사용하여 join이라는 방식을 이용하여 연결시킨다. 여기서 key란 앞서 성적 데이터와 출석 데이터에서 특정 학생 정보임을 식별할 수 있는 학번(ID) 등을 말한다.</p>
<p>R에서도 두 데이터 프레임을 관계형 데이터베이스의 join과 같은 방식으로 결합시킬 수 있다. 이 작업은 R의 기본 함수인 <code>merge()</code> 함수를 이용하여 수행할 수도 있고, dplyr 패키지의 join 함수들을 사용하여 수행할 수도 있다. 이 책에서는 dplyr의 join 함수들을 이용하여 관계형 데이터 결합을 수행하는 방법을 설명하도록 한다.</p>
<div id="inner-join과-outer-join" class="section level3">
<h3><span class="header-section-number">9.2.1</span> Inner join과 outer join</h3>
<p>앞의 예에서 우리는 중간, 기말 고사 점수를 가지고 있는 <code>class12</code> 데이터 프레임과 출석 점수를 가지고 있는 <code>attendance</code> 데이터 프레임을 합치기 위해 ID 열로 데이터 프레임을 정렬한 후 <code>bind_cols()</code>로 연결하였다. 이 작업은 dplyr의 <code>inner_join()</code> 함수를 이용하면 더 손쉽게 수행할 수 있다.</p>
<div id="inner_join" class="section level4 unnumbered">
<h4><code>inner_join()</code></h4>
<p><code>inner_join()</code> 함수는 결합할 두 데이터 프레임을 인수로 먼저 기술한 다음 <code>by</code> 인수에 어떤 열을 기준으로 결합할 것인지를 열 이름으로 기술한다. <code>inner_join()</code> 함수는 두 데이터 프레임에서 <code>by</code> 인수로 주어진 열의 값이 동일한 행을 연결하여 새로운 데이터 프레임을 만든다. 또한 새로 만들어진 데이터 프레임은 <code>by</code> 열을 기준으로 정렬이 이루어진다.</p>
<div class="sourceCode" id="cb1642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1642-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1642-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">inner_join</span>(class12, attendance, <span class="dt">by=</span><span class="st">&quot;ID&quot;</span>)</span></code></pre></div>
<pre><code>   ID   Name Gender Year Address Midterm Final Team Class Attend
1  15 김철수      M    1    서울      78    59    A     1     90
2  18 김영희      F    3    경기      85    87    A     1     95
3  25 이철수      M    3    충남      80    70    B     1    100
4  34 이영희      F    2    대전      92    89    B     1    100
5 151 홍길동   Male    4    세종      58    66    B     1     95
6  12 장철수      M    2    &lt;NA&gt;      75    79    C     2    185
7  19 장영희      F    2    &lt;NA&gt;      75    89    C     2    100
8  28 최철수      M    1    &lt;NA&gt;      87    76    D     2    100
9  45 최영희      F   30    &lt;NA&gt;      82    79    D     2    100</code></pre>
<ul>
<li>만약 두 데이터 프레임이 결합의 기준이 되는 열의 이름이 다르면 `by = c(“key.x” = “key.y”) 형식으로 두 데이터 프레임의 키 열의 이름을 기술하여 결합하면 된다.</li>
<li>만약 결합의 기준이 되는 열이 두 개 이상이면 `by = c(“key1”, “key2”) 형식으로 기술한다.</li>
<li>만약 결합의 기준이 되는 열이 두 개 이상이고 서로 이름이 다르면 <code>by = c("key1.x" = "key1.y", "key2.x" = "key2.y")</code> 형식으로 두 데이터 프레임의 키 열의 이름을 기술한다. 관련 정보는 <code>inner_join()</code> 함수의 도움말을 참조하라.</li>
</ul>
</div>
<div id="inner-join" class="section level4 unnumbered">
<h4>1:1 inner join</h4>
<p>앞의 예처럼 데이터가 결합되는 방식을 1 대 1 inner join이라고 부른다. 두 데이터 프레임에 ID가 동일한 학생은 오직 한 명만 존재하고, 두 데이터 프레임의 학생의 ID가 일 대 일로 대응된다. 따라서 두 데이터 프레임의 행들이 일 대 일로 결합되어 새로운 데이터 프레임이 생성된다.</p>
<p><code>by</code> 인수가 주어지지 않으면 두 데이터 프레임에서 이름이 같은 열을 찾고 그 열을 기준으로 결합을 한다. 따라서 위의 경우 두 데이터 프레임이 ID라는 동일한 이름의 열이 있으므로 이 열을 기준으로 데이터가 결합되었다.</p>
<div class="sourceCode" id="cb1644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1644-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1644-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">inner_join</span>(class12, attendance)</span></code></pre></div>
<pre><code>Joining, by = &quot;ID&quot;</code></pre>
<pre><code>   ID   Name Gender Year Address Midterm Final Team Class Attend
1  15 김철수      M    1    서울      78    59    A     1     90
2  18 김영희      F    3    경기      85    87    A     1     95
3  25 이철수      M    3    충남      80    70    B     1    100
4  34 이영희      F    2    대전      92    89    B     1    100
5 151 홍길동   Male    4    세종      58    66    B     1     95
6  12 장철수      M    2    &lt;NA&gt;      75    79    C     2    185
7  19 장영희      F    2    &lt;NA&gt;      75    89    C     2    100
8  28 최철수      M    1    &lt;NA&gt;      87    76    D     2    100
9  45 최영희      F   30    &lt;NA&gt;      82    79    D     2    100</code></pre>
</div>
<div id="inner-join-1" class="section level4 unnumbered">
<h4>0:1 inner join</h4>
<p>앞서 <code>inner_join()</code> 함수는 두 데이터 프레임에서 <code>by</code> 인수로 주어진 열의 값이 같은 행을 서로 연결한다고 했다. 그러면 다음의 예처럼 한 데이터 프레임에는 해당 개체의 정보가 있으나 다른 데이터 프레임에는 해당 개체의 정보가 없는 경우에 두 데이터 프레임을 연결하면 어떻게 될까?
다음 예처럼 <code>class1</code>에는 1분반 학생의 데이터만 있고, <code>attendance</code>는 1, 2분반의 학생 데이터가 모두 있는 경우 두 데이터 프레임을 <code>ID</code> 열로 결합하는 경우를 고려해 보자. <code>attendance</code>에는 동일한 <code>ID</code>를 가지고 있는 학생이 오직 한 명만 존재하고, <code>class1</code>에는 <code>attendance</code>에 있는 학생 정보가 0개 또는 1개가 있는 경우이다. 이러한 데이터 결합 방식을 0 대 1 inner join이라고 부른다.
이 경우 두 데이터 프레임에서 <code>by</code> 열이 동일한 행끼리 결합이 이루어지므로 <code>class1</code>에 있는 학생의 행으로만 구성된 데이터 프레임이 생성되었다. 즉, <code>by</code> 인수에 주어진 열이 서로 동일한 값을 가진 행만 결합되어 결과가 나오므로 한 쪽 데이터 프레임에 없는 행은 제거되었음을 알 수 있다.</p>
<div class="sourceCode" id="cb1647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1647-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1647-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">inner_join</span>(class1, attendance, <span class="dt">by=</span><span class="st">&quot;ID&quot;</span>)</span></code></pre></div>
<pre><code>   ID   Name Gender Year Address Midterm Final Team Class Attend
1  15 김철수      M    1    서울      78    59    A     1     90
2  18 김영희      F    3    경기      85    87    A     1     95
3  25 이철수      M    3    충남      80    70    B     1    100
4  34 이영희      F    2    대전      92    89    B     1    100
5 151 홍길동   Male    4    세종      58    66    B     1     95</code></pre>
</div>
<div id="outer-join" class="section level4 unnumbered">
<h4>outer join</h4>
<p>한 쪽 데이터 프레임에 해당 행이 없더라도 어느 한쪽의 데이터 프레임에 행이 있으면 그 행을 포함시킬 필요가 있는 경우가 있다. 예를 들어 앞의 예에서 2분반의 중간 및 기말 고사 정보가 나중에 획득되면 추후 보강하기로 하고 현재 출석 점수가 있는 모든 학생의 정보가 나오도록 중간과 기말 점수와 출석 데이터를 결합한다고 하자.<br />
이러한 경우 outer_join 함수들을 사용한다. Outer join 함수는 다음 세 가지가 있다.</p>
<ul>
<li><code>left_join(x, y)</code>: x에 있는 행을 모두 유지하여 join을 수행한다.</li>
<li><code>right_join(x, y)</code>: y에 있는 행을 모두 유지하여 join을 수행한다.</li>
<li><code>full_join(x, y)</code>: x와 y의 모든 행을 유지하여 join을 수행한다.</li>
</ul>
<p>대신 한 쪽에 없는 정보는 모두 결측치 <code>NA</code>가 입력되어 결합된다.
다음은 <code>inner_join()</code>, <code>left_join()</code>, <code>right_join()</code>, <code>full_join9)</code>의 차이가 무엇인지를 보여주는 예이다.</p>
<div class="sourceCode" id="cb1649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1649-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1649-1"></a><span class="op">&gt;</span><span class="st"> </span>x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">name =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]); x</span></code></pre></div>
<pre><code>  id name
1  1    a
2  2    b
3  3    c</code></pre>
<div class="sourceCode" id="cb1651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1651-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1651-1"></a><span class="op">&gt;</span><span class="st"> </span>y &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">addr =</span> LETTERS[<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>]); y</span></code></pre></div>
<pre><code>  id addr
1  2    B
2  3    C
3  4    D</code></pre>
<div class="sourceCode" id="cb1653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1653-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1653-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">inner_join</span>(x, y)</span></code></pre></div>
<pre><code>Joining, by = &quot;id&quot;</code></pre>
<pre><code>  id name addr
1  2    b    B
2  3    c    C</code></pre>
<div class="sourceCode" id="cb1656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1656-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1656-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">left_join</span>(x, y)</span></code></pre></div>
<pre><code>Joining, by = &quot;id&quot;</code></pre>
<pre><code>  id name addr
1  1    a &lt;NA&gt;
2  2    b    B
3  3    c    C</code></pre>
<div class="sourceCode" id="cb1659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1659-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1659-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">right_join</span>(x, y)</span></code></pre></div>
<pre><code>Joining, by = &quot;id&quot;</code></pre>
<pre><code>  id name addr
1  2    b    B
2  3    c    C
3  4 &lt;NA&gt;    D</code></pre>
<div class="sourceCode" id="cb1662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1662-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1662-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">full_join</span>(x, y)</span></code></pre></div>
<pre><code>Joining, by = &quot;id&quot;</code></pre>
<pre><code>  id name addr
1  1    a &lt;NA&gt;
2  2    b    B
3  3    c    C
4  4 &lt;NA&gt;    D</code></pre>
<p>다음은 <code>class1</code>과 <code>attendance</code> 데이터에서 <code>attendance</code>의 모든 행을 남겨두는 outer join을 수행한 결과이다.</p>
<div class="sourceCode" id="cb1665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1665-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1665-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">right_join</span>(class1, attendance, <span class="dt">by=</span><span class="st">&quot;ID&quot;</span>)</span></code></pre></div>
<pre><code>   ID   Name Gender Year Address Midterm Final Team Class Attend
1  15 김철수      M    1    서울      78    59    A     1     90
2  18 김영희      F    3    경기      85    87    A     1     95
3  25 이철수      M    3    충남      80    70    B     1    100
4  34 이영희      F    2    대전      92    89    B     1    100
5 151 홍길동   Male    4    세종      58    66    B     1     95
6  12   &lt;NA&gt;   &lt;NA&gt;   NA    &lt;NA&gt;      NA    NA &lt;NA&gt;     2    185
7  19   &lt;NA&gt;   &lt;NA&gt;   NA    &lt;NA&gt;      NA    NA &lt;NA&gt;     2    100
8  28   &lt;NA&gt;   &lt;NA&gt;   NA    &lt;NA&gt;      NA    NA &lt;NA&gt;     2    100
9  45   &lt;NA&gt;   &lt;NA&gt;   NA    &lt;NA&gt;      NA    NA &lt;NA&gt;     2    100</code></pre>
</div>
<div id="n-inner-join" class="section level4 unnumbered">
<h4>1:n inner join</h4>
<p>만약에 한 데이터 프레임에서 결합의 기준이 되는 열에 동일한 값이 여러번 나오면 어떻게 될까? 다음의 예를 살펴보면서 그 결과가 어떻게 되는지 확인해 보자.
지금까지 우리는 <code>class12.a</code>라는 데이터 프레임에 중간, 기말, 출석 점수를 통합하였다. 그런데 다음과 같이 프로젝트 팀별로 프로젝트 평가 점수가 있다고 하자.</p>
<div class="sourceCode" id="cb1667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1667-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1667-1"></a><span class="op">&gt;</span><span class="st"> </span>pjt &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/project.csv&quot;</span>, <span class="dt">fileEncoding=</span><span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb1667-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1667-2"></a><span class="op">&gt;</span><span class="st"> </span>pjt</span></code></pre></div>
<pre><code>  Team Project
1    A      80
2    B      90
3    C      85
4    D      75</code></pre>
<p>한 프로젝트 팀에는 2, 3 명의 학생이 포함되고, 프로젝트 점수는 프로젝트 팀별로 주어지고 학생 개별로는 부여되지 않는다 따라서 학생의 성적을 산정하려면 각 학생이 어떤 프로젝트 팀에 속한지를 확인한 후 학생이 속한 프로젝트 팀의 점수를 그 학생의 프로젝트 점수로 부여하는 작업이 필요하다.
이 경우 <code>class12.a</code>와 <code>pjt</code> 데이터 프레임이 결합되어야 하는데, 결합의 기준 열은 프로젝트 팀을 나타내는 <code>Team</code> 열이 되어야 한다. 그런데 <code>pjt</code> 데이터 프레임에는 한 팀에 해당되는 행이 오직 한 개만 존재하지만, <code>class12.a</code> 데이터 프레임에는 한 팀에 속한 학생이 여러 명 있으므로 여러 행이 존재한다. 이러한 경우의 데이터 결합 방식을 1 대 n inner join이라고 한다.<br />
다음은 <code>inner_join()</code>를 사용하여 n 대 1의 관계의 두 데이터 프레임을 inner join 한 결과이다.</p>
<div class="sourceCode" id="cb1669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1669-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1669-1"></a><span class="op">&gt;</span><span class="st"> </span>class12.c &lt;-<span class="st"> </span><span class="kw">inner_join</span>(class12.a, pjt, <span class="dt">by=</span><span class="st">&quot;Team&quot;</span>)</span>
<span id="cb1669-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1669-2"></a><span class="op">&gt;</span><span class="st"> </span>class12.c</span></code></pre></div>
<pre><code>   ID   Name Gender Year Address Midterm Final Team Class Attend Project
1  12 장철수      M    2    &lt;NA&gt;      75    79    C     2    185      85
2  15 김철수      M    1    서울      78    59    A     1     90      80
3  18 김영희      F    3    경기      85    87    A     1     95      80
4  19 장영희      F    2    &lt;NA&gt;      75    89    C     2    100      85
5  25 이철수      M    3    충남      80    70    B     1    100      90
6  28 최철수      M    1    &lt;NA&gt;      87    76    D     2    100      75
7  34 이영희      F    2    대전      92    89    B     1    100      90
8  45 최영희      F   30    &lt;NA&gt;      82    79    D     2    100      75
9 151 홍길동   Male    4    세종      58    66    B     1     95      90</code></pre>
<p>결과에서 보듯이 <code>by</code> 인수로 <code>Team</code>을 주게 되면, <code>pjt</code> 데이터 프레임에서 <code>Team</code>이 A인 행은 하나지만, <code>class12.a</code>에서 <code>Team</code>이 A이고 학번이 15번과 18번인 학생과 관련된 두 행이 존재하므로, <code>pjt</code>의 한 행이 이 두 행에 차례로 결합되어 새로운 행을 만들었음을 알 수 있다. 이처럼 <code>inner_joint()</code>는 <code>by</code> 인수로 주어진 행에 동일한 값이 여러번 있으면 해당 값으로 결합이 여러번 발생한다.</p>
</div>
<div id="두-열-이상을-기준으로-join" class="section level4 unnumbered">
<h4>두 열 이상을 기준으로 join</h4>
<p>Join의 기준이 되는 열은 하나가 아니라 여러 개가 될 수 있다. 다음과 같은 두 개의 데이터 프레임이 있다고 하자. 그리고 이 두 데이터 프레임을 하나의 데이터 프레임으로 결합한다고 하자.</p>
<div class="sourceCode" id="cb1671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1671-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1671-1"></a><span class="op">&gt;</span><span class="st"> </span>a &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">first.name=</span><span class="kw">c</span>(<span class="st">&quot;James&quot;</span>, <span class="st">&quot;James&quot;</span>, <span class="st">&quot;Goerge&quot;</span>), </span>
<span id="cb1671-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1671-2"></a><span class="op">+</span><span class="st">                 </span><span class="dt">last.name=</span><span class="kw">c</span>(<span class="st">&quot;Bolton&quot;</span>, <span class="st">&quot;Tiger&quot;</span>, <span class="st">&quot;Tiger&quot;</span>), </span>
<span id="cb1671-3"><a href="ch-R-Advanced-Data-Mgmt.html#cb1671-3"></a><span class="op">+</span><span class="st">                 </span><span class="dt">age=</span><span class="kw">c</span>(<span class="dv">34</span>, <span class="dv">26</span>, <span class="dv">47</span>))</span>
<span id="cb1671-4"><a href="ch-R-Advanced-Data-Mgmt.html#cb1671-4"></a><span class="op">&gt;</span><span class="st"> </span>a</span></code></pre></div>
<pre><code>  first.name last.name age
1      James    Bolton  34
2      James     Tiger  26
3     Goerge     Tiger  47</code></pre>
<div class="sourceCode" id="cb1673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1673-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1673-1"></a><span class="op">&gt;</span><span class="st"> </span>b &lt;-<span class="st"> </span>a <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(first.name) <span class="op">%&gt;%</span></span>
<span id="cb1673-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1673-2"></a><span class="op">+</span><span class="st">     </span><span class="kw">mutate</span>(<span class="dt">income =</span> <span class="kw">c</span>(<span class="dv">35</span>, <span class="dv">24</span>, <span class="dv">18</span>)) <span class="op">%&gt;%</span></span>
<span id="cb1673-3"><a href="ch-R-Advanced-Data-Mgmt.html#cb1673-3"></a><span class="op">+</span><span class="st">     </span><span class="kw">select</span>(<span class="op">-</span>age)</span>
<span id="cb1673-4"><a href="ch-R-Advanced-Data-Mgmt.html#cb1673-4"></a><span class="op">&gt;</span><span class="st"> </span>b</span></code></pre></div>
<pre><code>  first.name last.name income
1     Goerge     Tiger     35
2      James    Bolton     24
3      James     Tiger     18</code></pre>
<p>두 데이터 프레임 각각에는 한 사람은 여러 행에 걸쳐 정보가 기술되어 있지는 않다. 그러나 두 데이터 프레임에서 <code>first.name</code>이 동일한 사람이 2명, <code>last.name</code>이 동일한 사람이 2명이 있다. 그래서 <code>first.name</code>이나 <code>last.name</code>만으로 데이터를 결합한다면 동일한 이름을 가진 사람이 있어서 원하는 결과를 얻을 수 없다. 다음은 <code>first.name</code>으로 결합한 결과이다.</p>
<div class="sourceCode" id="cb1675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1675-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1675-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">inner_join</span>(a, b, <span class="dt">by=</span><span class="st">&quot;first.name&quot;</span>)</span></code></pre></div>
<pre><code>  first.name last.name.x age last.name.y income
1      James      Bolton  34      Bolton     24
2      James      Bolton  34       Tiger     18
3      James       Tiger  26      Bolton     24
4      James       Tiger  26       Tiger     18
5     Goerge       Tiger  47       Tiger     35</code></pre>
<p>결과에서 보듯이 <code>a</code>의 James Bolton 행은 <code>b</code>의 James Bolton과 James Tiger 행과 <code>first.name</code>이 동일하므로 두 번 결합이 이루어진다. 마찬가지로 <code>a</code>의 James Tiger 행도 <code>b</code>의 James Bolton과 James Tiger 행과 first.name이 동일하므로 역시 두 번 행 결합이 발생한다. 그래서 결합된 결과가 3건이 아니라 총 5건의 데이터 행을 갖는다.
그리고 <code>a</code>와 <code>b</code> 모두 <code>last.name</code> 열이 있어서 어떤 <code>last.name</code>을 남겨두어야 할지 모르므로, 첫번째 데이터 프레임에서 온 열은 .x, 두번째 데이터 프레임에서 온 열은 .y라는 접미사를 붙여서 열을 만들었다.</p>
<p>이러한 경우는 <code>first.name</code>과 <code>last.name</code>이 모두 같은 경우에만 행이 결합되도록 하는 것이 더 바람직하다. 그렇게 하려면 이 두 열의 이름을 모두 by 인수로 전달하면 된다.</p>
<div class="sourceCode" id="cb1677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1677-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1677-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">inner_join</span>(a, b, <span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;last.name&quot;</span>, <span class="st">&quot;first.name&quot;</span>))</span></code></pre></div>
<pre><code>  first.name last.name age income
1      James    Bolton  34     24
2      James     Tiger  26     18
3     Goerge     Tiger  47     35</code></pre>
</div>
</div>
<div id="filtering-join" class="section level3">
<h3><span class="header-section-number">9.2.2</span> Filtering join</h3>
<p>지금까지는 두 데이터 프레임의 키 값이 같은 행을 inner 또는 outer join으로 연결하는 방법을 살펴보았다. 그런데 어떤 경우에는 한 데이터 프레임의 데이터를 다른 데이터 프레임의 정보를 사용하여 필터링해야 하는 경우가 있다. 다음의 두 예를 고려해 보자.</p>
<ul>
<li><p>어떤 도시의 거주자의 자산 데이터와 그 도시의 세금 체납자 데이터가 있다고 하자. 이 때 거주자의 자산 정보에서 세금 체납자의 자산 정보만 뽑아서 분석하려고 한다. 어떻게 이 정보를 뽑아낼 수 있을까?</p></li>
<li><p>어떤 텍스트에서 사용된 단어 데이터와 의마가 없는 단어인 불용어 데이터가 있다고 하자. 이 때 텍스트의 단어 데이터에서 불용어는 제외하고 데이터를 분석하려고 한다. 어떻게 이 정보를 뽑아낼 수 있을까?</p></li>
</ul>
<p>dplyr 패키지에는 이 작업을 위해 다음 두 함수를 제공한다.</p>
<ul>
<li><code>semi_join(x, y)</code>: x 데이터 프레임에서 y에 있는 데이터만 뽑아낸다.</li>
<li><code>anti_join(x, y)</code>: x 데이터 프레임에서 y에 있는 데이터는 제외한다.</li>
</ul>
<div class="sourceCode" id="cb1679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1679-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1679-1"></a><span class="op">&gt;</span><span class="st"> </span>x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">semi_join</span>(y, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</span></code></pre></div>
<pre><code>  id name
1  2    b
2  3    c</code></pre>
<div class="sourceCode" id="cb1681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1681-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1681-1"></a><span class="op">&gt;</span><span class="st"> </span>x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">anti_join</span>(y, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>)</span></code></pre></div>
<pre><code>  id name
1  1    a</code></pre>
</div>
<div id="join을-수행하는-다른-방법들" class="section level3">
<h3><span class="header-section-number">9.2.3</span> Join을 수행하는 다른 방법들</h3>
<div id="merge-함수" class="section level4">
<h4><span class="header-section-number">9.2.3.1</span> <code>merge()</code> 함수</h4>
<p>R의 기본 함수인 <code>merge()</code> 함수는 dplyr 패키지의 inner와 outer join을 수행해 준다.</p>
<div class="sourceCode" id="cb1683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1683-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1683-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">merge</span>(x, y)                 <span class="co"># inner join</span></span></code></pre></div>
<pre><code>  id name addr
1  2    b    B
2  3    c    C</code></pre>
<div class="sourceCode" id="cb1685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1685-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1685-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">merge</span>(x, y, <span class="dt">all.x =</span> <span class="ot">TRUE</span>)   <span class="co"># left join</span></span></code></pre></div>
<pre><code>  id name addr
1  1    a &lt;NA&gt;
2  2    b    B
3  3    c    C</code></pre>
<div class="sourceCode" id="cb1687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1687-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1687-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">merge</span>(x, y, <span class="dt">all.y =</span> <span class="ot">TRUE</span>)   <span class="co"># right join</span></span></code></pre></div>
<pre><code>  id name addr
1  2    b    B
2  3    c    C
3  4 &lt;NA&gt;    D</code></pre>
<div class="sourceCode" id="cb1689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1689-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1689-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">merge</span>(x, y, <span class="dt">all =</span> <span class="ot">TRUE</span>)     <span class="co"># full join</span></span></code></pre></div>
<pre><code>  id name addr
1  1    a &lt;NA&gt;
2  2    b    B
3  3    c    C
4  4 &lt;NA&gt;    D</code></pre>
</div>
<div id="sqldf-패키지" class="section level4 unnumbered">
<h4>sqldf 패키지</h4>
<p>지금까지 dplyr의 join 함수를 이용하여 관계형 데이터베이스의 join과 유사한 데이터 결합을 어떻게 수행하는지 살펴보았다. 그런데 관계형 데이터베이스의 SQL에 익숙한 사람들은 R에서 SQL처럼 좀 더 다양한 방식으로 join을 수행할 수 없을까라는 의문을 가질 수 있다. sqldf 패키지는 SQL 문법을 이용하여 R의 데이터 프레임에서 데이터를 조회하거나 결합할 수 있도록 해 준다. 이러한 기능이 필요한 사람은 이 패키지의 문서를 참조하기 바란다. 그러나 R은 데이터 분석을 위한 도구이지 관계형 데이터베이스와 같은 일을 수행하기 위한 도구가 아님을 명심할 필요가 있다. 대량의 데이터의 결합이 필요하다면 관계형 데이터베이스에서 SQL을 이용하여 이를 먼저 수행한 후 최종 결과를 R로 보내어 분석을 수행하는 것이 일반적으로 더 효율적인 방법이다.</p>
</div>
</div>
</div>
<div id="sec:tidyr" class="section level2">
<h2><span class="header-section-number">9.3</span> <code>tidyr</code> 패키지를 이용하여 정돈 데이터 형식으로 바꾸기</h2>
<p><code>tidyr</code> 패키지는 <code>tidyverse</code> 패키지에 포함된 패키지로 비정돈 형식의 데이터를 정돈 형식으로 바꾸어주는 함수를 가지고 있다.</p>
<div id="pivot_longer-여러-열에-걸친-한-변수의-데이터를-하나의-열로-길게-모으기" class="section level3">
<h3><span class="header-section-number">9.3.1</span> <code>pivot_longer</code>: 여러 열에 걸친 한 변수의 데이터를 하나의 열로 길게 모으기</h3>
<p>정돈 데이터는 한 열이 하나의 변수에 대응을 해야 한다. 그러나 현실의 데이터에서는 동일한 변수의 값이 여러 열에 흩뿌려져 있는 경우가 발생한다. 시계열 데이터들이 대표적인 사례라 할 수 있다. 다음은 <code>tidyr</code>에 포함된 <code>table4a</code> 데이터이다. 세 나라의 1999년도와 2000년도의 어떤 사건의 발생 건수를 보여주고 있다. 발생 건수를 나타내는 데이터 열이 두 개의 열로 나눠져 있음을 볼 수 있다.</p>
<div class="sourceCode" id="cb1691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1691-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1691-1"></a><span class="op">&gt;</span><span class="st"> </span>table4a</span></code></pre></div>
<pre><code># A tibble: 3 x 3
  country     `1999` `2000`
* &lt;chr&gt;        &lt;int&gt;  &lt;int&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258 213766</code></pre>
<p><code>table4a</code>를 정돈 데이터로 바꾸려면 두 열을 한 열로 모아야 한다. <code>tidyr</code>의 <code>povit_longer()</code> 함수는 그러한 역할을 수행한다.</p>
<div class="sourceCode" id="cb1693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1693-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1693-1"></a><span class="op">&gt;</span><span class="st"> </span>table4a <span class="op">%&gt;%</span></span>
<span id="cb1693-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1693-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">pivot_longer</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">1999</span><span class="st">`</span>, <span class="st">`</span><span class="dt">2000</span><span class="st">`</span>), <span class="dt">names_to =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">values_to =</span><span class="st">&quot;cases&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  country     year   cases
  &lt;chr&gt;       &lt;chr&gt;  &lt;int&gt;
1 Afghanistan 1999     745
2 Afghanistan 2000    2666
3 Brazil      1999   37737
4 Brazil      2000   80488
5 China       1999  212258
6 China       2000  213766</code></pre>
<ul>
<li><code>pivot_longer()</code>는 모아야 할 열의 이름을 입력-이 예에서는 1999와 2000이다. 두 열의 이름은 숫자로 시작하고 있어서 표준적인 형태롤 따르지 않아서 <code>` `</code>으로 둘러쌓여 표현되었다-한다.</li>
<li>원 데이터의 열 이름을 표현할 변수를 <code>names_to</code>로 지정한다.</li>
<li>원 데이터의 열의 값을 표현할 변수를 <code>values_to</code>로 지정한다.</li>
</ul>
<p>원 데이터의 열 이름은 변수로서 따옴표 없이 지정되고, 결과 데이터에 만들 열 이름은 아직 만들어진 변수가 아니므로 변수의 이름이 따옴표로 둘러쌓여 문자열로 전달된다.</p>
<p>다음 그림은 앞의 <code>pivot_longer()</code> 함수의 작동 방식을 보여준다. 원 데이터보다 길어진 형식으로 데이터가 변환되므로 longer라는 표현이 사용되었다.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-11"></span>
<img src="img/tidy-gather.png" alt="pivot_longer 작동 방식 (출처: R for Data Science)" width="60%" />
<p class="caption">
Figure 9.1: pivot_longer 작동 방식 (출처: R for Data Science)
</p>
</div>
<div id="결측치가-있는-경우" class="section level4">
<h4><span class="header-section-number">9.3.1.1</span> 결측치가 있는 경우</h4>
<p><code>table4a</code>에서 중국의 2000년도 데이터가 조사되지 않아서 <code>NA</code>로 표시되어 있다면 <code>pivot_longer()</code>는 어떤 결과를 줄까? 다음 결과에서 보듯이 결측치가 있는 셀도 모두 별도의 행으로 표현이 되었다.</p>
<div class="sourceCode" id="cb1695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1695-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1695-1"></a><span class="op">&gt;</span><span class="st"> </span>na_table4a &lt;-<span class="st"> </span>table4a</span>
<span id="cb1695-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1695-2"></a><span class="op">&gt;</span><span class="st"> </span>na_table4a<span class="op">$</span><span class="st">`</span><span class="dt">2000</span><span class="st">`</span>[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb1695-3"><a href="ch-R-Advanced-Data-Mgmt.html#cb1695-3"></a><span class="op">&gt;</span><span class="st"> </span>na_table4a</span></code></pre></div>
<pre><code># A tibble: 3 x 3
  country     `1999` `2000`
  &lt;chr&gt;        &lt;int&gt;  &lt;int&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258     NA</code></pre>
<div class="sourceCode" id="cb1697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1697-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1697-1"></a><span class="op">&gt;</span><span class="st"> </span>na_table4a <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1697-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1697-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">pivot_longer</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">1999</span><span class="st">`</span>, <span class="st">`</span><span class="dt">2000</span><span class="st">`</span>), <span class="dt">names_to =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;cases&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  country     year   cases
  &lt;chr&gt;       &lt;chr&gt;  &lt;int&gt;
1 Afghanistan 1999     745
2 Afghanistan 2000    2666
3 Brazil      1999   37737
4 Brazil      2000   80488
5 China       1999  212258
6 China       2000      NA</code></pre>
<p>만약 긴 형식에서는 결측치어서 불필요한 행을 없애고 싶으면 <code>values_drop_na</code> 인수를 TRUE로 설정한다.</p>
<div class="sourceCode" id="cb1699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1699-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1699-1"></a><span class="op">&gt;</span><span class="st"> </span>na_long_table4a &lt;-<span class="st"> </span>na_table4a <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1699-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1699-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">pivot_longer</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">1999</span><span class="st">`</span>, <span class="st">`</span><span class="dt">2000</span><span class="st">`</span>), <span class="dt">names_to =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb1699-3"><a href="ch-R-Advanced-Data-Mgmt.html#cb1699-3"></a><span class="op">+</span><span class="st">                </span><span class="dt">values_to =</span> <span class="st">&quot;cases&quot;</span>, <span class="dt">values_drop_na =</span> T)</span>
<span id="cb1699-4"><a href="ch-R-Advanced-Data-Mgmt.html#cb1699-4"></a><span class="op">&gt;</span><span class="st"> </span>na_long_table4a</span></code></pre></div>
<pre><code># A tibble: 5 x 3
  country     year   cases
  &lt;chr&gt;       &lt;chr&gt;  &lt;int&gt;
1 Afghanistan 1999     745
2 Afghanistan 2000    2666
3 Brazil      1999   37737
4 Brazil      2000   80488
5 China       1999  212258</code></pre>
</div>
<div id="gather" class="section level4">
<h4><span class="header-section-number">9.3.1.2</span> <code>gather</code></h4>
<p><code>tidyr</code> 패키지는 1.0 버전이 출시되면서 많은 변화가 있었다. 이전 버전의 에서는 <code>gather()</code> 함수가 <code>pivot_longer()</code> 함수의 역할을 수행하였다. 그리고 호환성을 위해 현재의 버전에서도 <code>gather()</code> 함수를 사용할 수 있다. 아직도 많은 R 관련 책에서 이 함수를 사용하고 있어서 사용법을 여기에 기술한다.</p>
<div class="sourceCode" id="cb1701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1701-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1701-1"></a><span class="op">&gt;</span><span class="st"> </span>table4a <span class="op">%&gt;%</span></span>
<span id="cb1701-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1701-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">gather</span>(<span class="st">`</span><span class="dt">1999</span><span class="st">`</span>, <span class="st">`</span><span class="dt">2000</span><span class="st">`</span>, <span class="dt">key =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">value =</span><span class="st">&quot;cases&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  country     year   cases
  &lt;chr&gt;       &lt;chr&gt;  &lt;int&gt;
1 Afghanistan 1999     745
2 Brazil      1999   37737
3 China       1999  212258
4 Afghanistan 2000    2666
5 Brazil      2000   80488
6 China       2000  213766</code></pre>
<ul>
<li><code>pivot_longer</code>와 유사한 형식인데, <code>gather</code>에서는 합칠 열의 이름을 각각의 인수로 전달된다.</li>
<li><code>names_to</code>와 <code>values_to</code>라는 원 데이터 입장에서의 인수 이름이 <code>gather</code>에서는 합쳐진 데이터 입장에서의 인수 이름인 <code>key</code>와 <code>value</code>라고 기술된다.</li>
</ul>
</div>
</div>
<div id="subsec:pivot-wider" class="section level3">
<h3><span class="header-section-number">9.3.2</span> <code>pivot_wider</code>: 여러 행에 걸쳐진 하나의 관측 데이터를 하나의 행으로 넓게 펼치기</h3>
<p>정돈 데이터는 한 행이 하나의 관측 대상에 대응을 해야 한다. 그러나 현실의 데이터에서는 여러 열에 하나의 관측 대상의 값이 표현되어 있는 경우도 있다. 다음 데이터는 세 나라의 어떤 년도의 사건의 발생 건수와 인구수가 두 행에 걸쳐 표현되었다. 그렇기 때문에 <code>count</code> 열은 인구수와 사건 횟수라는 두 변수의 값을 모두 포함한 열이 되었다.</p>
<div class="sourceCode" id="cb1703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1703-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1703-1"></a><span class="op">&gt;</span><span class="st"> </span>table2</span></code></pre></div>
<pre><code># A tibble: 12 x 4
   country      year type            count
   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;           &lt;int&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
<p><code>table2</code>를 정돈 데이터로 바꾸려면 두 행의 데이터를 한 행으로 모아야 한다. <code>tidyr</code>의 <code>pivot_wider()</code> 함수는 그러한 역할을 수행한다.</p>
<div class="sourceCode" id="cb1705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1705-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1705-1"></a><span class="op">&gt;</span><span class="st"> </span>table2 <span class="op">%&gt;%</span></span>
<span id="cb1705-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1705-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> type, <span class="dt">values_from =</span> count)</span></code></pre></div>
<pre><code># A tibble: 6 x 4
  country      year  cases population
  &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
<ul>
<li><code>pivot_wider()</code>는 결과 펼쳐진 결과 데이터에서 열의 이름으로 사용될 변수를 <code>names_from</code> 인수로 지정한다.</li>
<li>펼쳐진 결과 데이터에서 열의 값으로 사용될 변수를 <code>values_from</code> 인수로 지정한다.</li>
</ul>
<p><code>names_from</code>과 <code>values_from</code> 인수를 지정할 때, 원 데이터의 열을 지정하는 것이므로 따옴표 없이 변수로서 지정한다.</p>
<p>다음 그림은 앞의 <code>pivot_wider()</code> 함수의 작동 방식을 보여준다.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-17"></span>
<img src="img/tidy-spread.png" alt="pivot_wider의 작동 방식 (출처: R for Data Science)" width="60%" />
<p class="caption">
Figure 9.2: pivot_wider의 작동 방식 (출처: R for Data Science)
</p>
</div>
<div id="결측치가-있는-경우-1" class="section level4">
<h4><span class="header-section-number">9.3.2.1</span> 결측치가 있는 경우</h4>
<p>앞서 <code>pivot_longer()</code>에서 중국의 2000년도 데이터에 결측값이 있도록 데이터를 만들었다.</p>
<div class="sourceCode" id="cb1707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1707-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1707-1"></a><span class="op">&gt;</span><span class="st"> </span>na_long_table4a</span></code></pre></div>
<pre><code># A tibble: 5 x 3
  country     year   cases
  &lt;chr&gt;       &lt;chr&gt;  &lt;int&gt;
1 Afghanistan 1999     745
2 Afghanistan 2000    2666
3 Brazil      1999   37737
4 Brazil      2000   80488
5 China       1999  212258</code></pre>
<p>만약 이 데이터를 넓은 형식으로 합치면 어떤 결과가 나올까? 결과에서 보듯이 결측이 있는 곳이 NA로 표시되고 데이터가 넓은 형식으로 변환된다.</p>
<div class="sourceCode" id="cb1709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1709-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1709-1"></a><span class="op">&gt;</span><span class="st"> </span>na_long_table4a <span class="op">%&gt;%</span></span>
<span id="cb1709-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1709-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> year, <span class="dt">values_from =</span> cases)</span></code></pre></div>
<pre><code># A tibble: 3 x 3
  country     `1999` `2000`
  &lt;chr&gt;        &lt;int&gt;  &lt;int&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258     NA</code></pre>
</div>
<div id="spread" class="section level4">
<h4><span class="header-section-number">9.3.2.2</span> <code>spread</code></h4>
<p><code>tidyr</code> 패키지는 1.0 버전이 출시되면서 많은 변화가 있었다. 이전 버전의 에서는 <code>spread()</code> 함수가 <code>pivot_wider()</code> 함수의 역할을 수행하였다. 그리고 호환성을 위해 현재의 버전에서도 <code>spread()</code> 함수를 사용할 수 있다. 아직도 많은 R 관련 책에서 이 함수를 사용하고 있어서 사용법을 여기에 기술한다.</p>
<div class="sourceCode" id="cb1711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1711-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1711-1"></a><span class="op">&gt;</span><span class="st"> </span>table2 <span class="op">%&gt;%</span></span>
<span id="cb1711-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1711-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">spread</span>(<span class="dt">key =</span> type, <span class="dt">value =</span> count)</span></code></pre></div>
<pre><code># A tibble: 6 x 4
  country      year  cases population
  &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
<ul>
<li><code>pivot_wider</code>와 유사한 형식인데 <code>names_from</code>와 <code>values_from</code>이라는 인수 이름이 <code>spread</code>에서는 <code>key</code>와 <code>value</code>라고 기술된다.</li>
</ul>
</div>
</div>
<div id="seperate-한-셀을-여러-셀로-분리하기" class="section level3">
<h3><span class="header-section-number">9.3.3</span> <code>seperate</code>: 한 셀을 여러 셀로 분리하기</h3>
<p>한 셀에 여러 값이 기술되어 있으면 정돈 형식의 데이터가 아니다. <code>table3</code>의 <code>rate</code> 열은 사건의 수와 인구수 데이터가 문자열 형식으로 표현된 열이다.</p>
<div class="sourceCode" id="cb1713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1713-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1713-1"></a><span class="op">&gt;</span><span class="st"> </span>table3</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  country      year rate             
* &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
<div id="특정-문자를-기준으로-분리하기" class="section level4">
<h4><span class="header-section-number">9.3.3.1</span> 특정 문자를 기준으로 분리하기</h4>
<p><code>seperate()</code>는 정해진 열을 <code>sep</code>에 지정된 문자를 기준으로 분리하여 분리된 값을 <code>into</code>에 지정된 열 이름으로 분리한다. 앞의 다른 함수와 마찬가지로 원 데이터의 열은 변수로서 따옴표 없이 지정되었고 결과 데이터에 사용될 열 이름은 따옴표를 사용하여 문자열로 전달되었다.</p>
<div class="sourceCode" id="cb1715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1715-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1715-1"></a><span class="op">&gt;</span><span class="st"> </span>table3 <span class="op">%&gt;%</span></span>
<span id="cb1715-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1715-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">separate</span>(rate, <span class="dt">into=</span><span class="kw">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;/&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 6 x 4
  country      year cases  population
  &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;     
1 Afghanistan  1999 745    19987071  
2 Afghanistan  2000 2666   20595360  
3 Brazil       1999 37737  172006362 
4 Brazil       2000 80488  174504898 
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
<p>다음 그림은 앞의 <code>pivot_wider()</code> 함수의 작동 방식을 보여준다.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-23"></span>
<img src="img/tidy-separate.png" alt="separate의 작동 방식 (출처: R for Data Science)" width="60%" />
<p class="caption">
Figure 9.3: separate의 작동 방식 (출처: R for Data Science)
</p>
</div>
<p><code>sep</code>은 구분자로 사용할 일반 문자뿐 아니라 정규 표현식을 사용하여 문자를 분리할 수 있다.</p>
</div>
<div id="분리한-열의-형변환" class="section level4">
<h4><span class="header-section-number">9.3.3.2</span> 분리한 열의 형변환</h4>
<p>앞의 결과를 보면 <code>rate</code> 열의 데이터가 문자열이기 때문에 결과 열도 모두 문자열 형식임을 볼 수 있다. 그런데 <code>cases</code>와 <code>population</code> 열은 모두 숫자로서 의미를 가지고 있으므로 숫자로 변환되는 것이 좋다. 셀의 내용을 분리한 후 숫자나 논리값으로 변형이 가능하면 변형을 하려면 <code>convert</code> 인수를 TRUE로 설정한다.</p>
<div class="sourceCode" id="cb1717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1717-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1717-1"></a><span class="op">&gt;</span><span class="st"> </span>x &lt;-<span class="st"> </span>table3 <span class="op">%&gt;%</span></span>
<span id="cb1717-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1717-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">separate</span>(rate, <span class="dt">into=</span><span class="kw">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;/&quot;</span>, <span class="dt">convert =</span> <span class="ot">TRUE</span>) </span>
<span id="cb1717-3"><a href="ch-R-Advanced-Data-Mgmt.html#cb1717-3"></a><span class="op">&gt;</span><span class="st"> </span>x</span></code></pre></div>
<pre><code># A tibble: 6 x 4
  country      year  cases population
  &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
<div class="sourceCode" id="cb1719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1719-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1719-1"></a><span class="op">&gt;</span><span class="st"> </span>x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">total_cases=</span><span class="kw">sum</span>(cases), <span class="dt">mean_pop=</span><span class="kw">mean</span>(population))</span></code></pre></div>
<pre><code># A tibble: 1 x 2
  total_cases   mean_pop
        &lt;int&gt;      &lt;dbl&gt;
1      547660 490072924.</code></pre>
</div>
<div id="자리를-기준으로-분리하기" class="section level4">
<h4><span class="header-section-number">9.3.3.3</span> 자리를 기준으로 분리하기</h4>
<p><code>sep</code>에 문자 대신 숫자를 입력하면 해당 숫자의 자리를 기준으로 내용을 분리한다. 양수이면 왼쪽에서 시작하여 자릿수를 계산하고 음수이면 오른쪽을 기준으로 자릿수를 계산하여 데이터를 분리한다.</p>
<div class="sourceCode" id="cb1721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1721-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1721-1"></a><span class="op">&gt;</span><span class="st"> </span>table3 <span class="op">%&gt;%</span></span>
<span id="cb1721-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1721-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">separate</span>(rate, <span class="dt">into=</span><span class="kw">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>), <span class="dt">sep=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 6 x 4
  country      year cases population    
  &lt;chr&gt;       &lt;int&gt; &lt;chr&gt; &lt;chr&gt;         
1 Afghanistan  1999 745   /19987071     
2 Afghanistan  2000 266   6/20595360    
3 Brazil       1999 377   37/172006362  
4 Brazil       2000 804   88/174504898  
5 China        1999 212   258/1272915272
6 China        2000 213   766/1280428583</code></pre>
<div class="sourceCode" id="cb1723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1723-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1723-1"></a><span class="op">&gt;</span><span class="st"> </span>table3 <span class="op">%&gt;%</span></span>
<span id="cb1723-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1723-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">separate</span>(rate, <span class="dt">into=</span><span class="kw">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>), <span class="dt">sep=</span><span class="op">-</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 6 x 4
  country      year cases          population
  &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;     
1 Afghanistan  1999 745/19987      071       
2 Afghanistan  2000 2666/20595     360       
3 Brazil       1999 37737/172006   362       
4 Brazil       2000 80488/174504   898       
5 China        1999 212258/1272915 272       
6 China        2000 213766/1280428 583       </code></pre>
<p>앞의 예에서 숫자열인 <code>year</code>에 적용하여 세기와 나머지 년도로 분리해 내보자.</p>
<div class="sourceCode" id="cb1725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1725-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1725-1"></a><span class="op">&gt;</span><span class="st"> </span>table3 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1725-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1725-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">separate</span>(year, <span class="dt">into=</span><span class="kw">c</span>(<span class="st">&quot;century&quot;</span>, <span class="st">&quot;year&quot;</span>), <span class="dt">sep=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code># A tibble: 6 x 4
  country     century year  rate             
  &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19      99    745/19987071     
2 Afghanistan 20      00    2666/20595360    
3 Brazil      19      99    37737/172006362  
4 Brazil      20      00    80488/174504898  
5 China       19      99    212258/1272915272
6 China       20      00    213766/1280428583</code></pre>
<p>만약 세기와 연도를 숫자로 표현하는 것이 필요하다면 앞서 설명한 것처럼 <code>convert</code> 인수를 TRUE로 설정하면 된다. 이 경우 00년도가 모두 숫자 0으로 변환된 것을 볼 수 있다.</p>
<div class="sourceCode" id="cb1727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1727-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1727-1"></a><span class="op">&gt;</span><span class="st"> </span>table3 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1727-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1727-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">separate</span>(year, <span class="dt">into=</span><span class="kw">c</span>(<span class="st">&quot;century&quot;</span>, <span class="st">&quot;year&quot;</span>), <span class="dt">sep=</span><span class="dv">2</span>, <span class="dt">convert =</span> T)</span></code></pre></div>
<pre><code># A tibble: 6 x 4
  country     century  year rate             
  &lt;chr&gt;         &lt;int&gt; &lt;int&gt; &lt;chr&gt;            
1 Afghanistan      19    99 745/19987071     
2 Afghanistan      20     0 2666/20595360    
3 Brazil           19    99 37737/172006362  
4 Brazil           20     0 80488/174504898  
5 China            19    99 212258/1272915272
6 China            20     0 213766/1280428583</code></pre>
</div>
</div>
<div id="unite-여러-셀의-데이터를-하나의-셀로-병합하기" class="section level3">
<h3><span class="header-section-number">9.3.4</span> <code>unite</code>: 여러 셀의 데이터를 하나의 셀로 병합하기</h3>
<p><code>separate()</code> 함수와 반대 작용을 하는 함수가 <code>unite()</code> 함수이다. <code>unite()</code> 함수는 여러 셀의 내용을 하나의 셀로 합친다. <code>table5</code>는 년도 데이터가 세기(<code>century</code>)와 나머지 년도(<code>year</code>)로 나뉘어져 있는 데이터이다. 세기와 무관하게 년도별로 데이터를 분석하려고 하면 이 두 열을 합쳐서 온전한 년도 데이터를 만들어야 한다.</p>
<div class="sourceCode" id="cb1729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1729-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1729-1"></a><span class="op">&gt;</span><span class="st"> </span>table5 <span class="op">%&gt;%</span></span>
<span id="cb1729-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1729-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">unite</span>(<span class="kw">c</span>(century, year), <span class="dt">col =</span> <span class="st">&quot;year&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  country     year  rate             
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 19_99 745/19987071     
2 Afghanistan 20_00 2666/20595360    
3 Brazil      19_99 37737/172006362  
4 Brazil      20_00 80488/174504898  
5 China       19_99 212258/1272915272
6 China       20_00 213766/1280428583</code></pre>
<p><code>unite()</code>의 기본 설정은 <code>_</code>을 구분자로 사용하여 합쳐진 셀의 내용을 연결한다. 이를 조정하려면, <code>sep</code> 인수를 설정하면 된다. 다음처럼 하면 구분자 없인 연결을 한다.</p>
<div class="sourceCode" id="cb1731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1731-1"><a href="ch-R-Advanced-Data-Mgmt.html#cb1731-1"></a><span class="op">&gt;</span><span class="st"> </span>table5 <span class="op">%&gt;%</span></span>
<span id="cb1731-2"><a href="ch-R-Advanced-Data-Mgmt.html#cb1731-2"></a><span class="op">+</span><span class="st">   </span><span class="kw">unite</span>(<span class="kw">c</span>(century, year), <span class="dt">col =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  country     year  rate             
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;            
1 Afghanistan 1999  745/19987071     
2 Afghanistan 2000  2666/20595360    
3 Brazil      1999  37737/172006362  
4 Brazil      2000  80488/174504898  
5 China       1999  212258/1272915272
6 China       2000  213766/1280428583</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch-visualization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-R-Programming-Structure.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R-programming-2nd.pdf", "R-programming-2nd.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
