<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 ggplot2를 이용한 데이터 시각화 | R 프로그래밍 3판 (draft)</title>
  <meta name="description" content="이 책은 경영데이터분석기초의 주교재로 사용되기 위해 개발되었습니다." />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 ggplot2를 이용한 데이터 시각화 | R 프로그래밍 3판 (draft)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="이 책은 경영데이터분석기초의 주교재로 사용되기 위해 개발되었습니다." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 ggplot2를 이용한 데이터 시각화 | R 프로그래밍 3판 (draft)" />
  
  <meta name="twitter:description" content="이 책은 경영데이터분석기초의 주교재로 사용되기 위해 개발되었습니다." />
  

<meta name="author" content="Kilhwan Kim" />


<meta name="date" content="2024-11-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch-dataTransformation.html"/>
<link rel="next" href="ch-R-Advanced-Data-Mgmt.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/threejs-111/three.min.js"></script>
<script src="libs/threejs-111/Detector.js"></script>
<script src="libs/threejs-111/Projector.js"></script>
<script src="libs/threejs-111/CanvasRenderer.js"></script>
<script src="libs/threejs-111/TrackballControls.js"></script>
<script src="libs/threejs-111/StateOrbitControls.js"></script>
<script src="libs/scatterplotThree-binding-0.3.3/scatterplotThree.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-176754989-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176754989-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R 프로그래밍 3판</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#판-서문"><i class="fa fa-check"></i>1판 서문</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#판-서문-1"><i class="fa fa-check"></i>2판 서문</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#판의-주요-개정-2022년-7월-이후부터"><i class="fa fa-check"></i>2판의 주요 개정 (2022년 7월 이후부터)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#판-서문-2"><i class="fa fa-check"></i>3판 서문</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#일러두기"><i class="fa fa-check"></i>일러두기</a></li>
</ul></li>
<li class="part"><span><b>I R 프로그래밍 기초</b></span></li>
<li class="chapter" data-level="1" data-path="ch-intro.html"><a href="ch-intro.html"><i class="fa fa-check"></i><b>1</b> <strong>R</strong> 설치 및 시작</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ch-intro.html"><a href="ch-intro.html#sec-Rintro"><i class="fa fa-check"></i><b>1.1</b> <strong>R</strong> 소개</a></li>
<li class="chapter" data-level="1.2" data-path="ch-intro.html"><a href="ch-intro.html#sec-installation"><i class="fa fa-check"></i><b>1.2</b> <strong>R</strong> 설치하기</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ch-intro.html"><a href="ch-intro.html#r을-윈도우즈에-설치할-때-주의-사항"><i class="fa fa-check"></i><b>1.2.1</b> <strong>R</strong>을 윈도우즈에 설치할 때 주의 사항</a></li>
<li class="chapter" data-level="1.2.2" data-path="ch-intro.html"><a href="ch-intro.html#winget"><i class="fa fa-check"></i><b>1.2.2</b> <code>winget</code> 명령어로 설치하기</a></li>
<li class="chapter" data-level="1.2.3" data-path="ch-intro.html"><a href="ch-intro.html#r-배포판-내려받기"><i class="fa fa-check"></i><b>1.2.3</b> <strong>R</strong> 배포판 내려받기</a></li>
<li class="chapter" data-level="1.2.4" data-path="ch-intro.html"><a href="ch-intro.html#r-설치하기"><i class="fa fa-check"></i><b>1.2.4</b> R 설치하기</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ch-intro.html"><a href="ch-intro.html#sec-RStudio"><i class="fa fa-check"></i><b>1.3</b> RStudio</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="ch-intro.html"><a href="ch-intro.html#winget을-이용한-rstudio-설치"><i class="fa fa-check"></i><b>1.3.1</b> <code>winget</code>을 이용한 RStudio 설치</a></li>
<li class="chapter" data-level="1.3.2" data-path="ch-intro.html"><a href="ch-intro.html#rstudio-설치"><i class="fa fa-check"></i><b>1.3.2</b> RStudio 설치</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ch-intro.html"><a href="ch-intro.html#sec-R-start"><i class="fa fa-check"></i><b>1.4</b> RStudio로 R 시작하기</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="ch-intro.html"><a href="ch-intro.html#r-콘솔과-프롬프트"><i class="fa fa-check"></i><b>1.4.1</b> R 콘솔과 프롬프트</a></li>
<li class="chapter" data-level="1.4.2" data-path="ch-intro.html"><a href="ch-intro.html#r-콘솔-사용과-관련된-몇-가지-팁"><i class="fa fa-check"></i><b>1.4.2</b> R 콘솔 사용과 관련된 몇 가지 팁</a></li>
<li class="chapter" data-level="1.4.3" data-path="ch-intro.html"><a href="ch-intro.html#r-스크립트-파일-만들기"><i class="fa fa-check"></i><b>1.4.3</b> R 스크립트 파일 만들기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html"><i class="fa fa-check"></i><b>2</b> R 데이터 기초</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#단순한-데이터-형식-data-types"><i class="fa fa-check"></i><b>2.1</b> 단순한 데이터 형식 (data types)</a></li>
<li class="chapter" data-level="2.2" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#단순-연산"><i class="fa fa-check"></i><b>2.2</b> 단순 연산</a></li>
<li class="chapter" data-level="2.3" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#변수와-할당"><i class="fa fa-check"></i><b>2.3</b> 변수와 할당</a></li>
<li class="chapter" data-level="2.4" data-path="ch-R-Data-Basic.html"><a href="ch-R-Data-Basic.html#함수를-이용한-연산"><i class="fa fa-check"></i><b>2.4</b> 함수를 이용한 연산</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html"><i class="fa fa-check"></i><b>3</b> <strong>R</strong> 벡터</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#숫자-벡터"><i class="fa fa-check"></i><b>3.1</b> 숫자 벡터</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#c-함수를-이용한-숫자-벡터-만들기"><i class="fa fa-check"></i><b>3.1.1</b> c() 함수를 이용한 숫자 벡터 만들기</a></li>
<li class="chapter" data-level="3.1.2" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#패턴을-이용한-숫자-벡터-만들기"><i class="fa fa-check"></i><b>3.1.2</b> 패턴을 이용한 숫자 벡터 만들기</a></li>
<li class="chapter" data-level="3.1.3" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#숫자-벡터의-연산"><i class="fa fa-check"></i><b>3.1.3</b> 숫자 벡터의 연산</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#논리-벡터"><i class="fa fa-check"></i><b>3.2</b> 논리 벡터</a></li>
<li class="chapter" data-level="3.3" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#문자-벡터"><i class="fa fa-check"></i><b>3.3</b> 문자 벡터</a></li>
<li class="chapter" data-level="3.4" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#결측치-missing-values"><i class="fa fa-check"></i><b>3.4</b> 결측치 (Missing Values)</a></li>
<li class="chapter" data-level="3.5" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#인덱스-벡터와-필터링"><i class="fa fa-check"></i><b>3.5</b> 인덱스 벡터와 필터링</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#자연수-인덱스-벡터"><i class="fa fa-check"></i><b>3.5.1</b> 자연수 인덱스 벡터</a></li>
<li class="chapter" data-level="3.5.2" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#음의-정수-인덱스-벡터"><i class="fa fa-check"></i><b>3.5.2</b> 음의 정수 인덱스 벡터</a></li>
<li class="chapter" data-level="3.5.3" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#논리-인덱스-벡터"><i class="fa fa-check"></i><b>3.5.3</b> 논리 인덱스 벡터</a></li>
<li class="chapter" data-level="3.5.4" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#이름-인덱스-벡터"><i class="fa fa-check"></i><b>3.5.4</b> 이름 인덱스 벡터</a></li>
<li class="chapter" data-level="3.5.5" data-path="ch-R-Vectors.html"><a href="ch-R-Vectors.html#인덱스-벡터를-이용해-벡터-요소에-값-할당하기"><i class="fa fa-check"></i><b>3.5.5</b> 인덱스 벡터를 이용해 벡터 요소에 값 할당하기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html"><i class="fa fa-check"></i><b>4</b> <strong>R</strong> 행렬</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬-만들기"><i class="fa fa-check"></i><b>4.1</b> 행렬 만들기</a></li>
<li class="chapter" data-level="4.2" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#벡터를-결합하여-행렬-만들기"><i class="fa fa-check"></i><b>4.2</b> 벡터를 결합하여 행렬 만들기</a></li>
<li class="chapter" data-level="4.3" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬의-필터링"><i class="fa fa-check"></i><b>4.3</b> 행렬의 필터링</a></li>
<li class="chapter" data-level="4.4" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬의-연산"><i class="fa fa-check"></i><b>4.4</b> 행렬의 연산</a></li>
<li class="chapter" data-level="4.5" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬과-함수"><i class="fa fa-check"></i><b>4.5</b> 행렬과 함수</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬을-인수로-하는-함수들"><i class="fa fa-check"></i><b>4.5.1</b> 행렬을 인수로 하는 함수들</a></li>
<li class="chapter" data-level="4.5.2" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬의-행별-또는-열별로-함수를-적용하는-방법"><i class="fa fa-check"></i><b>4.5.2</b> 행렬의 행별 또는 열별로 함수를 적용하는 방법</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#sec-RMatrix-array"><i class="fa fa-check"></i><b>4.6</b> 배열 *</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#배열의-생성"><i class="fa fa-check"></i><b>4.6.1</b> 배열의 생성</a></li>
<li class="chapter" data-level="4.6.2" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#배열도-결국-벡터"><i class="fa fa-check"></i><b>4.6.2</b> 배열도 결국 벡터</a></li>
<li class="chapter" data-level="4.6.3" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#배열의-연산과-필터링"><i class="fa fa-check"></i><b>4.6.3</b> 배열의 연산과 필터링</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#sec-RMatrix-operation-advanced"><i class="fa fa-check"></i><b>4.7</b> 행렬과 배열의 고급 연산 *</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬의-곱"><i class="fa fa-check"></i><b>4.7.1</b> 행렬의 곱</a></li>
<li class="chapter" data-level="4.7.2" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#행렬의-주대각선-요소와-대각행렬"><i class="fa fa-check"></i><b>4.7.2</b> 행렬의 주대각선 요소와 대각행렬</a></li>
<li class="chapter" data-level="4.7.3" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#연립-일차-방정식과-역행렬"><i class="fa fa-check"></i><b>4.7.3</b> 연립 일차 방정식과 역행렬</a></li>
<li class="chapter" data-level="4.7.4" data-path="ch-R-Matrix.html"><a href="ch-R-Matrix.html#고유치eigenvalues와-고유벡터eigenvectors"><i class="fa fa-check"></i><b>4.7.4</b> 고유치(eigenvalues)와 고유벡터(eigenvectors)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-R-List.html"><a href="ch-R-List.html"><i class="fa fa-check"></i><b>5</b> <strong>R</strong> 리스트</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ch-R-List.html"><a href="ch-R-List.html#객체-객체의-타입-객체의-속성"><i class="fa fa-check"></i><b>5.1</b> 객체, 객체의 타입, 객체의 속성 *</a></li>
<li class="chapter" data-level="5.2" data-path="ch-R-List.html"><a href="ch-R-List.html#리스트의-생성-및-필터링"><i class="fa fa-check"></i><b>5.2</b> 리스트의 생성 및 필터링</a></li>
<li class="chapter" data-level="5.3" data-path="ch-R-List.html"><a href="ch-R-List.html#리스트의-변경-및-연결"><i class="fa fa-check"></i><b>5.3</b> 리스트의 변경 및 연결</a></li>
<li class="chapter" data-level="5.4" data-path="ch-R-List.html"><a href="ch-R-List.html#리스트에-함수-적용하기"><i class="fa fa-check"></i><b>5.4</b> 리스트에 함수 적용하기</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="ch-R-List.html"><a href="ch-R-List.html#lapply-함수"><i class="fa fa-check"></i><b>5.4.1</b> lapply() 함수</a></li>
<li class="chapter" data-level="5.4.2" data-path="ch-R-List.html"><a href="ch-R-List.html#sapply-함수"><i class="fa fa-check"></i><b>5.4.2</b> sapply() 함수</a></li>
<li class="chapter" data-level="5.4.3" data-path="ch-R-List.html"><a href="ch-R-List.html#mapply-함수"><i class="fa fa-check"></i><b>5.4.3</b> mapply() 함수</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="ch-R-List.html"><a href="ch-R-List.html#리스트-활용-분야"><i class="fa fa-check"></i><b>5.5</b> 리스트 활용 분야</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html"><i class="fa fa-check"></i><b>6</b> <strong>R</strong> 데이터 프레임</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#범주형-데이터와-요인-factors"><i class="fa fa-check"></i><b>6.1</b> 범주형 데이터와 요인 (Factors)</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#명목형-변수와-요인"><i class="fa fa-check"></i><b>6.1.1</b> 명목형 변수와 요인</a></li>
<li class="chapter" data-level="6.1.2" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#순서형-변수와-요인"><i class="fa fa-check"></i><b>6.1.2</b> 순서형 변수와 요인</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#데이터-프레임-만들기"><i class="fa fa-check"></i><b>6.2</b> 데이터 프레임 만들기</a></li>
<li class="chapter" data-level="6.3" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#데이터-프레임-각-열의-지정"><i class="fa fa-check"></i><b>6.3</b> 데이터 프레임 각 열의 지정</a></li>
<li class="chapter" data-level="6.4" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#데이터-프레임의-필터링"><i class="fa fa-check"></i><b>6.4</b> 데이터 프레임의 필터링</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#리스트-형식으로-필터링"><i class="fa fa-check"></i><b>6.4.1</b> 리스트 형식으로 필터링</a></li>
<li class="chapter" data-level="6.4.2" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#행렬-형식으로-필터링"><i class="fa fa-check"></i><b>6.4.2</b> 행렬 형식으로 필터링</a></li>
<li class="chapter" data-level="6.4.3" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#subset을-이용한-필터링"><i class="fa fa-check"></i><b>6.4.3</b> subset()을 이용한 필터링</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#데이터-프레임에-함수-적용하기"><i class="fa fa-check"></i><b>6.5</b> 데이터 프레임에 함수 적용하기</a></li>
<li class="chapter" data-level="6.6" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#sec-read-file"><i class="fa fa-check"></i><b>6.6</b> 파일에서 데이터 읽어오기</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#텍스트-파일에서-데이터-읽어오기"><i class="fa fa-check"></i><b>6.6.1</b> 텍스트 파일에서 데이터 읽어오기</a></li>
<li class="chapter" data-level="6.6.2" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#csv-파일에서-데이터-읽어오기"><i class="fa fa-check"></i><b>6.6.2</b> CSV 파일에서 데이터 읽어오기</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#sec-write-file"><i class="fa fa-check"></i><b>6.7</b> 데이터 프레임을 파일로 쓰기</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#바이너리-형식으로-데이터-객체-저장-및-복원"><i class="fa fa-check"></i><b>6.7.1</b> 바이너리 형식으로 데이터 객체 저장 및 복원</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="ch-R-Data-Frame.html"><a href="ch-R-Data-Frame.html#데이터-프레임의-열을-변수처럼-이용하는-방법"><i class="fa fa-check"></i><b>6.8</b> 데이터 프레임의 열을 변수처럼 이용하는 방법 *</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html"><i class="fa fa-check"></i><b>7</b> dplyr을 이용한 데이터 변환</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-tidyData"><i class="fa fa-check"></i><b>7.1</b> 정돈 데이터 (tidy data)</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#정돈-데이터-형식의-조건"><i class="fa fa-check"></i><b>7.1.1</b> 정돈 데이터 형식의 조건</a></li>
<li class="chapter" data-level="7.1.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#비정돈-데이터-형식"><i class="fa fa-check"></i><b>7.1.2</b> 비정돈 데이터 형식</a></li>
<li class="chapter" data-level="7.1.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#정돈-데이터를-사용하는-이유"><i class="fa fa-check"></i><b>7.1.3</b> 정돈 데이터를 사용하는 이유</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#tidyverse-패키지"><i class="fa fa-check"></i><b>7.2</b> <code>tidyverse</code> 패키지</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#tidyverse-패키지-설치"><i class="fa fa-check"></i><b>7.2.1</b> <code>tidyverse</code> 패키지 설치</a></li>
<li class="chapter" data-level="7.2.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#tidyverse-패키지-적재"><i class="fa fa-check"></i><b>7.2.2</b> <code>tidyverse</code> 패키지 적재</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-dplyr"><i class="fa fa-check"></i><b>7.3</b> <code>dplyr</code> 패키지와 정돈 데이터의 변환</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#dplyr-패키지"><i class="fa fa-check"></i><b>7.3.1</b> <code>dplyr</code> 패키지</a></li>
<li class="chapter" data-level="7.3.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#정돈-데이터-변환의-종류"><i class="fa fa-check"></i><b>7.3.2</b> 정돈 데이터 변환의 종류</a></li>
<li class="chapter" data-level="7.3.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#dplyr-패키지-vs.-r의-기본-기능"><i class="fa fa-check"></i><b>7.3.3</b> <code>dplyr</code> 패키지 vs. R의 기본 기능</a></li>
<li class="chapter" data-level="7.3.4" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#mpg-데이터"><i class="fa fa-check"></i><b>7.3.4</b> <code>mpg</code> 데이터</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-filter"><i class="fa fa-check"></i><b>7.4</b> <code>filter()</code>로 행 선택하기</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#선택-조건이-하나인-경우"><i class="fa fa-check"></i><b>7.4.1</b> 선택 조건이 하나인 경우</a></li>
<li class="chapter" data-level="7.4.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#여러-조건을-만족하는-행-추출하기"><i class="fa fa-check"></i><b>7.4.2</b> 여러 조건을 만족하는 행 추출하기</a></li>
<li class="chapter" data-level="7.4.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#논리-연산자로-복합-조건-만들기"><i class="fa fa-check"></i><b>7.4.3</b> 논리 연산자로 복합 조건 만들기</a></li>
<li class="chapter" data-level="7.4.4" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#in-연산자"><i class="fa fa-check"></i><b>7.4.4</b> <code>%in%</code> 연산자</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-slice"><i class="fa fa-check"></i><b>7.5</b> <code>slice()</code>로 행 선택하기</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#slice_sample로-표본-추출하기"><i class="fa fa-check"></i><b>7.5.1</b> <code>slice_sample()</code>로 표본 추출하기</a></li>
<li class="chapter" data-level="7.5.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#slice_head와-slice_tail"><i class="fa fa-check"></i><b>7.5.2</b> <code>slice_head()</code>와 <code>slice_tail()</code></a></li>
<li class="chapter" data-level="7.5.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#slice_min과-slice_max"><i class="fa fa-check"></i><b>7.5.3</b> <code>slice_min()</code>과 <code>slice_max()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-arrange"><i class="fa fa-check"></i><b>7.6</b> <code>arrange()</code>로 행 정렬하기</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#desc를-이용하여-내림차순으로-정렬하기"><i class="fa fa-check"></i><b>7.6.1</b> <code>desc()</code>를 이용하여 내림차순으로 정렬하기</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-select"><i class="fa fa-check"></i><b>7.7</b> <code>select()</code>를 이용하여 변수 이름으로 열 선택하기</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-이름을-나열하여-선택하기"><i class="fa fa-check"></i><b>7.7.1</b> 변수 이름을 나열하여 선택하기</a></li>
<li class="chapter" data-level="7.7.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-이름으로-변수-범위를-선택하기"><i class="fa fa-check"></i><b>7.7.2</b> 변수 이름으로 변수 범위를 선택하기</a></li>
<li class="chapter" data-level="7.7.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-위치로-매칭하여-선택하기"><i class="fa fa-check"></i><b>7.7.3</b> 변수 위치로 매칭하여 선택하기</a></li>
<li class="chapter" data-level="7.7.4" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-select-match"><i class="fa fa-check"></i><b>7.7.4</b> 변수 이름을 매칭하여 선택하기</a></li>
<li class="chapter" data-level="7.7.5" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수의-형식이나-조건으로-매칭하여-선택하기"><i class="fa fa-check"></i><b>7.7.5</b> 변수의 형식이나 조건으로 매칭하여 선택하기*</a></li>
<li class="chapter" data-level="7.7.6" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-이름-바꾸기"><i class="fa fa-check"></i><b>7.7.6</b> 변수 이름 바꾸기</a></li>
<li class="chapter" data-level="7.7.7" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#변수-순서-바꾸기"><i class="fa fa-check"></i><b>7.7.7</b> 변수 순서 바꾸기</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-mutate"><i class="fa fa-check"></i><b>7.8</b> <code>mutate()</code>로 새로운 변수 만들기</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#transmute로-새로운-변수만-남기기"><i class="fa fa-check"></i><b>7.8.1</b> <code>transmute()</code>로 새로운 변수만 남기기</a></li>
<li class="chapter" data-level="7.8.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#새로운-변수를-만들-때-사용할-수-있는-함수들"><i class="fa fa-check"></i><b>7.8.2</b> 새로운 변수를 만들 때 사용할 수 있는 함수들</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-summarize"><i class="fa fa-check"></i><b>7.9</b> <code>summarize()</code>로 변수 요약하기</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#across로-여려-변수를-요약하기"><i class="fa fa-check"></i><b>7.9.1</b> <code>across()</code>로 여려 변수를 요약하기*</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-groupBy"><i class="fa fa-check"></i><b>7.10</b> <code>group_by()</code>로 그룹별로 요약하기</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#group_by로-그룹별로-새-변수-추가하기"><i class="fa fa-check"></i><b>7.10.1</b> <code>group_by()</code>로 그룹별로 새 변수 추가하기</a></li>
<li class="chapter" data-level="7.10.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#count로-개수-세기"><i class="fa fa-check"></i><b>7.10.2</b> <code>count()</code>로 개수 세기</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#sec-pipeOperator"><i class="fa fa-check"></i><b>7.11</b> <code>%&gt;%</code> 파이프 연산자</a>
<ul>
<li class="chapter" data-level="7.11.1" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#여러-단계를-거쳐-데이터를-변환할-때"><i class="fa fa-check"></i><b>7.11.1</b> 여러 단계를 거쳐 데이터를 변환할 때</a></li>
<li class="chapter" data-level="7.11.2" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#파이프-연산자"><i class="fa fa-check"></i><b>7.11.2</b> 파이프 연산자</a></li>
<li class="chapter" data-level="7.11.3" data-path="ch-dataTransformation.html"><a href="ch-dataTransformation.html#ungroup"><i class="fa fa-check"></i><b>7.11.3</b> <code>ungroup()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch-visualization.html"><a href="ch-visualization.html"><i class="fa fa-check"></i><b>8</b> ggplot2를 이용한 데이터 시각화</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ch-visualization.html"><a href="ch-visualization.html#sec-getStarted-ggplot2"><i class="fa fa-check"></i><b>8.1</b> ggplot2 시작하기</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="ch-visualization.html"><a href="ch-visualization.html#subsec-tryGgplot"><i class="fa fa-check"></i><b>8.1.1</b> ggplot2 그래프 그려보기</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="ch-visualization.html"><a href="ch-visualization.html#sec-aesMapping"><i class="fa fa-check"></i><b>8.2</b> 도형의 속성에 데이터 열을 대응시키기 (aesthetic mapping)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="ch-visualization.html"><a href="ch-visualization.html#범주형-변수를-색상color-속성에-매핑하기"><i class="fa fa-check"></i><b>8.2.1</b> 범주형 변수를 색상(<code>color</code>) 속성에 매핑하기</a></li>
<li class="chapter" data-level="8.2.2" data-path="ch-visualization.html"><a href="ch-visualization.html#범주형-변수를-모양shape-속성에-매핑하기"><i class="fa fa-check"></i><b>8.2.2</b> 범주형 변수를 모양(<code>shape</code>) 속성에 매핑하기</a></li>
<li class="chapter" data-level="8.2.3" data-path="ch-visualization.html"><a href="ch-visualization.html#연속형-변수를-크기size-투명도alpha-색상color-속성에-매핑하기"><i class="fa fa-check"></i><b>8.2.3</b> 연속형 변수를 크기(<code>size</code>), 투명도(<code>alpha</code>), 색상(<code>color</code>) 속성에 매핑하기</a></li>
<li class="chapter" data-level="8.2.4" data-path="ch-visualization.html"><a href="ch-visualization.html#도형의-여러-속성에-데이터-열을-매핑시키기"><i class="fa fa-check"></i><b>8.2.4</b> 도형의 여러 속성에 데이터 열을 매핑시키기</a></li>
<li class="chapter" data-level="8.2.5" data-path="ch-visualization.html"><a href="ch-visualization.html#도형-속성에-데이터-열을-매핑하기---예제"><i class="fa fa-check"></i><b>8.2.5</b> 도형 속성에 데이터 열을 매핑하기 - 예제</a></li>
<li class="chapter" data-level="8.2.6" data-path="ch-visualization.html"><a href="ch-visualization.html#도형의-속성에-대응시키기-vs.-도형의-속성-인수를-설정하기"><i class="fa fa-check"></i><b>8.2.6</b> 도형의 속성에 대응시키기 vs. 도형의 속성 인수를 설정하기</a></li>
<li class="chapter" data-level="8.2.7" data-path="ch-visualization.html"><a href="ch-visualization.html#group-속성"><i class="fa fa-check"></i><b>8.2.7</b> <code>group</code> 속성</a></li>
<li class="chapter" data-level="8.2.8" data-path="ch-visualization.html"><a href="ch-visualization.html#그룹으로-나누어-선-그래프-그리기"><i class="fa fa-check"></i><b>8.2.8</b> 그룹으로 나누어 선 그래프 그리기</a></li>
<li class="chapter" data-level="8.2.9" data-path="ch-visualization.html"><a href="ch-visualization.html#이산형-변수는-group-속성으로-자동-매핑된다."><i class="fa fa-check"></i><b>8.2.9</b> 이산형 변수는 <code>group</code> 속성으로 자동 매핑된다.</a></li>
<li class="chapter" data-level="8.2.10" data-path="ch-visualization.html"><a href="ch-visualization.html#geom_smooth-함수에서-group-속성"><i class="fa fa-check"></i><b>8.2.10</b> <code>geom_smooth()</code> 함수에서 <code>group</code> 속성</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="ch-visualization.html"><a href="ch-visualization.html#sec-facets"><i class="fa fa-check"></i><b>8.3</b> 측면(facets)으로 나누어 그리기</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="ch-visualization.html"><a href="ch-visualization.html#facet_wrap로-일차원-측면-그래프-그리기"><i class="fa fa-check"></i><b>8.3.1</b> <code>facet_wrap()</code>로 일차원 측면 그래프 그리기</a></li>
<li class="chapter" data-level="8.3.2" data-path="ch-visualization.html"><a href="ch-visualization.html#facet_grid로-이차원-측면-그래프-그리기"><i class="fa fa-check"></i><b>8.3.2</b> <code>facet_grid()</code>로 이차원 측면 그래프 그리기</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="ch-visualization.html"><a href="ch-visualization.html#sec-layerAndGeom"><i class="fa fa-check"></i><b>8.4</b> 그래프 계층(layers)과 도형(geoms)</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="ch-visualization.html"><a href="ch-visualization.html#geom-함수의-순서와-그래프-계층"><i class="fa fa-check"></i><b>8.4.1</b> geom 함수의 순서와 그래프 계층</a></li>
<li class="chapter" data-level="8.4.2" data-path="ch-visualization.html"><a href="ch-visualization.html#ggplot-함수는-좌표축을-자동-조정한다."><i class="fa fa-check"></i><b>8.4.2</b> <code>ggplot()</code> 함수는 좌표축을 자동 조정한다.</a></li>
<li class="chapter" data-level="8.4.3" data-path="ch-visualization.html"><a href="ch-visualization.html#여러-데이터를-사용하여-그래프-계층-만들기"><i class="fa fa-check"></i><b>8.4.3</b> 여러 데이터를 사용하여 그래프 계층 만들기</a></li>
<li class="chapter" data-level="8.4.4" data-path="ch-visualization.html"><a href="ch-visualization.html#다른-데이터-범위로-그래프-계층-만들기"><i class="fa fa-check"></i><b>8.4.4</b> 다른 데이터 범위로 그래프 계층 만들기</a></li>
<li class="chapter" data-level="8.4.5" data-path="ch-visualization.html"><a href="ch-visualization.html#subsec-commonDataMapping"><i class="fa fa-check"></i><b>8.4.5</b> 공통 <code>data</code>와 <code>mapping</code>의 설정</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="ch-visualization.html"><a href="ch-visualization.html#sec-commonProblems"><i class="fa fa-check"></i><b>8.5</b> ggplot 명령문을 입력할 때 자주 발생하는 문제들</a></li>
<li class="chapter" data-level="8.6" data-path="ch-visualization.html"><a href="ch-visualization.html#sec-ggplotStat"><i class="fa fa-check"></i><b>8.6</b> 통계 변환</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="ch-visualization.html"><a href="ch-visualization.html#subsec-statCategorical"><i class="fa fa-check"></i><b>8.6.1</b> 범주형 변수의 통계 요약</a></li>
<li class="chapter" data-level="8.6.2" data-path="ch-visualization.html"><a href="ch-visualization.html#subsec-statNumerical"><i class="fa fa-check"></i><b>8.6.2</b> 수치형 변수의 통계 요약</a></li>
<li class="chapter" data-level="8.6.3" data-path="ch-visualization.html"><a href="ch-visualization.html#subsec-statNumericalPerCategory"><i class="fa fa-check"></i><b>8.6.3</b> 수치형 변수의 범주별 통계요약</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="ch-visualization.html"><a href="ch-visualization.html#sec-position"><i class="fa fa-check"></i><b>8.7</b> 위치 조정</a></li>
<li class="chapter" data-level="8.8" data-path="ch-visualization.html"><a href="ch-visualization.html#sec-typeofgraph"><i class="fa fa-check"></i><b>8.8</b> ggplot2 그래프의 종류</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="ch-visualization.html"><a href="ch-visualization.html#basic-graph"><i class="fa fa-check"></i><b>8.8.1</b> 직선을 그리는 그래픽 함수</a></li>
<li class="chapter" data-level="8.8.2" data-path="ch-visualization.html"><a href="ch-visualization.html#onecategory"><i class="fa fa-check"></i><b>8.8.2</b> 한 범주형 변수의 그래프</a></li>
<li class="chapter" data-level="8.8.3" data-path="ch-visualization.html"><a href="ch-visualization.html#onenumeric"><i class="fa fa-check"></i><b>8.8.3</b> 한 수치형 변수의 그래프</a></li>
<li class="chapter" data-level="8.8.4" data-path="ch-visualization.html"><a href="ch-visualization.html#twocategories"><i class="fa fa-check"></i><b>8.8.4</b> 두 범주형 변수의 그래프</a></li>
<li class="chapter" data-level="8.8.5" data-path="ch-visualization.html"><a href="ch-visualization.html#category-numeric"><i class="fa fa-check"></i><b>8.8.5</b> 범주형 변수와 수치형 변수의 그래프</a></li>
<li class="chapter" data-level="8.8.6" data-path="ch-visualization.html"><a href="ch-visualization.html#twonumeric"><i class="fa fa-check"></i><b>8.8.6</b> 두 수치형 변수의 그래프</a></li>
<li class="chapter" data-level="8.8.7" data-path="ch-visualization.html"><a href="ch-visualization.html#morethanthree"><i class="fa fa-check"></i><b>8.8.7</b> 세 변수 이상의 그래프</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="ch-visualization.html"><a href="ch-visualization.html#modification"><i class="fa fa-check"></i><b>8.9</b> 그래프의 외양 바꾸기</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="ch-visualization.html"><a href="ch-visualization.html#axes"><i class="fa fa-check"></i><b>8.9.1</b> 좌표축의 조정</a></li>
<li class="chapter" data-level="8.9.2" data-path="ch-visualization.html"><a href="ch-visualization.html#좌표계의-변경"><i class="fa fa-check"></i><b>8.9.2</b> 좌표계의 변경</a></li>
<li class="chapter" data-level="8.9.3" data-path="ch-visualization.html"><a href="ch-visualization.html#색상-척도color-scales의-변경"><i class="fa fa-check"></i><b>8.9.3</b> 색상 척도(color scales)의 변경</a></li>
<li class="chapter" data-level="8.9.4" data-path="ch-visualization.html"><a href="ch-visualization.html#labelsmodification"><i class="fa fa-check"></i><b>8.9.4</b> 레이블 조정</a></li>
<li class="chapter" data-level="8.9.5" data-path="ch-visualization.html"><a href="ch-visualization.html#themes"><i class="fa fa-check"></i><b>8.9.5</b> 테마 변경</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="ch-visualization.html"><a href="ch-visualization.html#misc"><i class="fa fa-check"></i><b>8.10</b> 기타 유용한 팁들</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="ch-visualization.html"><a href="ch-visualization.html#combinegraph"><i class="fa fa-check"></i><b>8.10.1</b> 여러 그래프를 한 도표에 넣기</a></li>
<li class="chapter" data-level="8.10.2" data-path="ch-visualization.html"><a href="ch-visualization.html#savegraph"><i class="fa fa-check"></i><b>8.10.2</b> 그래프 저장하기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html"><i class="fa fa-check"></i><b>9</b> R 고급 데이터 변환</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#sec-bind-data"><i class="fa fa-check"></i><b>9.1</b> 데이터의 단순 결합</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#데이터를-행으로-결합하기"><i class="fa fa-check"></i><b>9.1.1</b> 데이터를 행으로 결합하기</a></li>
<li class="chapter" data-level="9.1.2" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#데이터를-열로-결합하기"><i class="fa fa-check"></i><b>9.1.2</b> 데이터를 열로 결합하기</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#관계형-데이터베이스처럼-데이터-결합하기"><i class="fa fa-check"></i><b>9.2</b> 관계형 데이터베이스처럼 데이터 결합하기</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#inner-join과-outer-join"><i class="fa fa-check"></i><b>9.2.1</b> Inner join과 outer join</a></li>
<li class="chapter" data-level="9.2.2" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#filtering-join"><i class="fa fa-check"></i><b>9.2.2</b> Filtering join</a></li>
<li class="chapter" data-level="9.2.3" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#join을-수행하는-다른-방법들"><i class="fa fa-check"></i><b>9.2.3</b> Join을 수행하는 다른 방법들</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#sec-tidyr"><i class="fa fa-check"></i><b>9.3</b> <code>tidyr</code> 패키지를 이용하여 정돈 데이터 형식으로 바꾸기</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#pivot_longer-여러-열에-걸친-한-변수의-데이터를-하나의-열로-길게-모으기"><i class="fa fa-check"></i><b>9.3.1</b> <code>pivot_longer</code>: 여러 열에 걸친 한 변수의 데이터를 하나의 열로 길게 모으기</a></li>
<li class="chapter" data-level="9.3.2" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#subsec-pivot-wider"><i class="fa fa-check"></i><b>9.3.2</b> <code>pivot_wider</code>: 한 열에 기술된 여러 변수의 데이터를 여러 열로 넓게 펼치기</a></li>
<li class="chapter" data-level="9.3.3" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#seperate-한-셀을-여러-셀로-분리하기"><i class="fa fa-check"></i><b>9.3.3</b> <code>seperate</code>: 한 셀을 여러 셀로 분리하기</a></li>
<li class="chapter" data-level="9.3.4" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#unite-여러-셀의-데이터를-하나의-셀로-병합하기"><i class="fa fa-check"></i><b>9.3.4</b> <code>unite</code>: 여러 셀의 데이터를 하나의 셀로 병합하기</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="ch-R-Advanced-Data-Mgmt.html"><a href="ch-R-Advanced-Data-Mgmt.html#데이터-열의-형식-바꾸기"><i class="fa fa-check"></i><b>9.4</b> 데이터 열의 형식 바꾸기</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html"><i class="fa fa-check"></i><b>10</b> R 프로그래밍 구조</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#r-조건문"><i class="fa fa-check"></i><b>10.1</b> R 조건문</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#if-조건문"><i class="fa fa-check"></i><b>10.1.1</b> if 조건문</a></li>
<li class="chapter" data-level="10.1.2" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#switch-함수"><i class="fa fa-check"></i><b>10.1.2</b> switch 함수</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#r-반복문"><i class="fa fa-check"></i><b>10.2</b> R 반복문</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#for-반복문"><i class="fa fa-check"></i><b>10.2.1</b> for 반복문</a></li>
<li class="chapter" data-level="10.2.2" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#while-반복문"><i class="fa fa-check"></i><b>10.2.2</b> while 반복문</a></li>
<li class="chapter" data-level="10.2.3" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#repeat-반복문"><i class="fa fa-check"></i><b>10.2.3</b> repeat 반복문</a></li>
<li class="chapter" data-level="10.2.4" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#반복문의-제어-명령"><i class="fa fa-check"></i><b>10.2.4</b> 반복문의 제어 명령</a></li>
<li class="chapter" data-level="10.2.5" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#r에서-반복문-사용의-주의점"><i class="fa fa-check"></i><b>10.2.5</b> R에서 반복문 사용의 주의점</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#r-함수"><i class="fa fa-check"></i><b>10.3</b> R 함수</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#함수의-생성과-호출"><i class="fa fa-check"></i><b>10.3.1</b> 함수의 생성과 호출</a></li>
<li class="chapter" data-level="10.3.2" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#함수-객체를-인수로-사용하기"><i class="fa fa-check"></i><b>10.3.2</b> 함수 객체를 인수로 사용하기</a></li>
<li class="chapter" data-level="10.3.3" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#r-연산자"><i class="fa fa-check"></i><b>10.3.3</b> R 연산자</a></li>
<li class="chapter" data-level="10.3.4" data-path="ch-R-Programming-Structure.html"><a href="ch-R-Programming-Structure.html#변수-범위"><i class="fa fa-check"></i><b>10.3.4</b> 변수 범위</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ch-R-OOP.html"><a href="ch-R-OOP.html"><i class="fa fa-check"></i><b>11</b> R 객체 지향 프로그래밍</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ch-R-OOP.html"><a href="ch-R-OOP.html#객체-지향-프로그래밍"><i class="fa fa-check"></i><b>11.1</b> 객체 지향 프로그래밍</a></li>
<li class="chapter" data-level="11.2" data-path="ch-R-OOP.html"><a href="ch-R-OOP.html#s3-클래스"><i class="fa fa-check"></i><b>11.2</b> S3 클래스</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="ch-R-OOP.html"><a href="ch-R-OOP.html#s3-클래스-객체-만들기"><i class="fa fa-check"></i><b>11.2.1</b> S3 클래스 객체 만들기</a></li>
<li class="chapter" data-level="11.2.2" data-path="ch-R-OOP.html"><a href="ch-R-OOP.html#포괄-함수generic-functions"><i class="fa fa-check"></i><b>11.2.2</b> 포괄 함수(generic functions)</a></li>
<li class="chapter" data-level="11.2.3" data-path="ch-R-OOP.html"><a href="ch-R-OOP.html#s3에서-상속성의-구현"><i class="fa fa-check"></i><b>11.2.3</b> S3에서 상속성의 구현</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="ch-R-OOP.html"><a href="ch-R-OOP.html#s4-클래스"><i class="fa fa-check"></i><b>11.3</b> S4 클래스</a></li>
</ul></li>
<li class="part"><span><b>II R 프로그래밍 응용</b></span></li>
<li class="chapter" data-level="12" data-path="ch-R-import.html"><a href="ch-R-import.html"><i class="fa fa-check"></i><b>12</b> <strong>R</strong> 데이터 수집</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ch-R-import.html"><a href="ch-R-import.html#sec-read-csv"><i class="fa fa-check"></i><b>12.1</b> 텍스트 파일에서 데이터 읽기</a></li>
<li class="chapter" data-level="12.2" data-path="ch-R-import.html"><a href="ch-R-import.html#sec-read-spreadsheets"><i class="fa fa-check"></i><b>12.2</b> 스프레드시트 파일에서 데이터 읽기</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="ch-R-import.html"><a href="ch-R-import.html#sec-read-excel"><i class="fa fa-check"></i><b>12.2.1</b> Excel 파일에서 데이터 읽기</a></li>
<li class="chapter" data-level="12.2.2" data-path="ch-R-import.html"><a href="ch-R-import.html#sec-read-google-sheets"><i class="fa fa-check"></i><b>12.2.2</b> Google Sheets에서 데이터 읽기</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="ch-R-import.html"><a href="ch-R-import.html#sec-import-databse"><i class="fa fa-check"></i><b>12.3</b> 데이터베이스에서 데이터 가져오기</a></li>
<li class="chapter" data-level="12.4" data-path="ch-R-import.html"><a href="ch-R-import.html#sec-web-scrapping"><i class="fa fa-check"></i><b>12.4</b> 웹 스크래핑 (web scrapping): 웹 사이트에서 데이터 가져오기</a></li>
<li class="chapter" data-level="12.5" data-path="ch-R-import.html"><a href="ch-R-import.html#sec-public-api"><i class="fa fa-check"></i><b>12.5</b> 공개 API에서 데이터 가져오기</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ch-R-documents.html"><a href="ch-R-documents.html"><i class="fa fa-check"></i><b>13</b> <strong>R</strong> 동적 문서</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ch-R-documents.html"><a href="ch-R-documents.html#quarto-설치"><i class="fa fa-check"></i><b>13.1</b> Quarto 설치</a></li>
<li class="chapter" data-level="13.2" data-path="ch-R-documents.html"><a href="ch-R-documents.html#sec-quarto-creation"><i class="fa fa-check"></i><b>13.2</b> Quarto 문서 만들기</a></li>
<li class="chapter" data-level="13.3" data-path="ch-R-documents.html"><a href="ch-R-documents.html#quarto의-출력-형식"><i class="fa fa-check"></i><b>13.3</b> Quarto의 출력 형식</a>
<ul>
<li class="chapter" data-level="" data-path="ch-R-documents.html"><a href="ch-R-documents.html#출력-형식-바꾸기"><i class="fa fa-check"></i>출력 형식 바꾸기</a></li>
<li class="chapter" data-level="13.3.1" data-path="ch-R-documents.html"><a href="ch-R-documents.html#여러-출력-형식으로-문서-변환하기"><i class="fa fa-check"></i><b>13.3.1</b> 여러 출력 형식으로 문서 변환하기</a></li>
<li class="chapter" data-level="13.3.2" data-path="ch-R-documents.html"><a href="ch-R-documents.html#출력-옵션-조정하기"><i class="fa fa-check"></i><b>13.3.2</b> 출력 옵션 조정하기</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="ch-R-documents.html"><a href="ch-R-documents.html#마크다운-기초"><i class="fa fa-check"></i><b>13.4</b> 마크다운 기초</a>
<ul>
<li class="chapter" data-level="" data-path="ch-R-documents.html"><a href="ch-R-documents.html#텍스트-서식"><i class="fa fa-check"></i>텍스트 서식</a></li>
<li class="chapter" data-level="" data-path="ch-R-documents.html"><a href="ch-R-documents.html#장과-절의-제목"><i class="fa fa-check"></i>장과 절의 제목</a></li>
<li class="chapter" data-level="" data-path="ch-R-documents.html"><a href="ch-R-documents.html#목록"><i class="fa fa-check"></i>목록</a></li>
<li class="chapter" data-level="13.4.1" data-path="ch-R-documents.html"><a href="ch-R-documents.html#url-링크"><i class="fa fa-check"></i><b>13.4.1</b> URL 링크</a></li>
<li class="chapter" data-level="" data-path="ch-R-documents.html"><a href="ch-R-documents.html#그림"><i class="fa fa-check"></i>그림</a></li>
<li class="chapter" data-level="" data-path="ch-R-documents.html"><a href="ch-R-documents.html#표"><i class="fa fa-check"></i>표</a></li>
<li class="chapter" data-level="" data-path="ch-R-documents.html"><a href="ch-R-documents.html#블록"><i class="fa fa-check"></i>블록</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="ch-R-documents.html"><a href="ch-R-documents.html#코드-모듬"><i class="fa fa-check"></i><b>13.5</b> 코드 모듬</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="ch-R-documents.html"><a href="ch-R-documents.html#코드-모듬-옵션"><i class="fa fa-check"></i><b>13.5.1</b> 코드 모듬 옵션</a></li>
<li class="chapter" data-level="13.5.2" data-path="ch-R-documents.html"><a href="ch-R-documents.html#실행-옵션-excution-options"><i class="fa fa-check"></i><b>13.5.2</b> 실행 옵션 (Excution Options)</a></li>
<li class="chapter" data-level="13.5.3" data-path="ch-R-documents.html"><a href="ch-R-documents.html#데이터프레임과-행렬을-표로-출력하기"><i class="fa fa-check"></i><b>13.5.3</b> 데이터프레임과 행렬을 표로 출력하기</a></li>
<li class="chapter" data-level="13.5.4" data-path="ch-R-documents.html"><a href="ch-R-documents.html#인라인-코드"><i class="fa fa-check"></i><b>13.5.4</b> 인라인 코드</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ch-R-dimension-reduction.html"><a href="ch-R-dimension-reduction.html"><i class="fa fa-check"></i><b>14</b> <strong>R</strong> 차원 축소</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ch-R-dimension-reduction.html"><a href="ch-R-dimension-reduction.html#sec-dimension-reduction"><i class="fa fa-check"></i><b>14.1</b> 차원 축소 (Dimension Reduction)</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="ch-R-dimension-reduction.html"><a href="ch-R-dimension-reduction.html#데이터의-차원"><i class="fa fa-check"></i><b>14.1.1</b> 데이터의 차원</a></li>
<li class="chapter" data-level="14.1.2" data-path="ch-R-dimension-reduction.html"><a href="ch-R-dimension-reduction.html#차원-축소-방법"><i class="fa fa-check"></i><b>14.1.2</b> 차원 축소 방법</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="ch-R-dimension-reduction.html"><a href="ch-R-dimension-reduction.html#sec-pca"><i class="fa fa-check"></i><b>14.2</b> 주성분 분석 (Principal Components Analysis)</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="ch-R-dimension-reduction.html"><a href="ch-R-dimension-reduction.html#주성분-분석에-대한-직관적-이해"><i class="fa fa-check"></i><b>14.2.1</b> 주성분 분석에 대한 직관적 이해</a></li>
<li class="chapter" data-level="14.2.2" data-path="ch-R-dimension-reduction.html"><a href="ch-R-dimension-reduction.html#차원-이상의-데이터로의-주성분-분석의-확장"><i class="fa fa-check"></i><b>14.2.2</b> 3차원 이상의 데이터로의 주성분 분석의 확장</a></li>
<li class="chapter" data-level="14.2.3" data-path="ch-R-dimension-reduction.html"><a href="ch-R-dimension-reduction.html#주성분-분석의-간략한-이론"><i class="fa fa-check"></i><b>14.2.3</b> 주성분 분석의 간략한 이론</a></li>
<li class="chapter" data-level="14.2.4" data-path="ch-R-dimension-reduction.html"><a href="ch-R-dimension-reduction.html#r로-주성분-분석하기"><i class="fa fa-check"></i><b>14.2.4</b> <strong>R</strong>로 주성분 분석하기</a></li>
<li class="chapter" data-level="14.2.5" data-path="ch-R-dimension-reduction.html"><a href="ch-R-dimension-reduction.html#데이터-정규화-후-주성분-분석하기"><i class="fa fa-check"></i><b>14.2.5</b> 데이터 정규화 후 주성분 분석하기</a></li>
<li class="chapter" data-level="14.2.6" data-path="ch-R-dimension-reduction.html"><a href="ch-R-dimension-reduction.html#sec-pca-viaulaization"><i class="fa fa-check"></i><b>14.2.6</b> 주성분 분석의 시각화</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ch-R-clustering.html"><a href="ch-R-clustering.html"><i class="fa fa-check"></i><b>15</b> <strong>R</strong> 군집 분석</a>
<ul>
<li class="chapter" data-level="15.1" data-path="ch-R-clustering.html"><a href="ch-R-clustering.html#sec-clustering"><i class="fa fa-check"></i><b>15.1</b> 군집 분석이란?</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="ch-R-clustering.html"><a href="ch-R-clustering.html#군집-분석의-필요성"><i class="fa fa-check"></i><b>15.1.1</b> 군집 분석의 필요성</a></li>
<li class="chapter" data-level="15.1.2" data-path="ch-R-clustering.html"><a href="ch-R-clustering.html#군집-분석의-유형"><i class="fa fa-check"></i><b>15.1.2</b> 군집 분석의 유형</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="ch-R-clustering.html"><a href="ch-R-clustering.html#sec-k-means"><i class="fa fa-check"></i><b>15.2</b> k-평균 군집화</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="ch-R-clustering.html"><a href="ch-R-clustering.html#알고리즘"><i class="fa fa-check"></i><b>15.2.1</b> 알고리즘</a></li>
<li class="chapter" data-level="15.2.2" data-path="ch-R-clustering.html"><a href="ch-R-clustering.html#k-평균-군집화의-장점-및-단점"><i class="fa fa-check"></i><b>15.2.2</b> k-평균 군집화의 장점 및 단점</a></li>
<li class="chapter" data-level="15.2.3" data-path="ch-R-clustering.html"><a href="ch-R-clustering.html#r을-이용한-k-평균-군집-분석"><i class="fa fa-check"></i><b>15.2.3</b> R을 이용한 k-평균 군집 분석</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="ch-R-clustering.html"><a href="ch-R-clustering.html#sec-agglomorative-clustering"><i class="fa fa-check"></i><b>15.3</b> 병합 군집화</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="ch-R-clustering.html"><a href="ch-R-clustering.html#sec-agglomorative-clustering-algorithm"><i class="fa fa-check"></i><b>15.3.1</b> 병합 군집화 알고리즘</a></li>
<li class="chapter" data-level="15.3.2" data-path="ch-R-clustering.html"><a href="ch-R-clustering.html#sec-distance-between-clusters"><i class="fa fa-check"></i><b>15.3.2</b> 군집 사이의 거리 계산</a></li>
<li class="chapter" data-level="15.3.3" data-path="ch-R-clustering.html"><a href="ch-R-clustering.html#sec-hclust"><i class="fa fa-check"></i><b>15.3.3</b> <code>hclust()</code> 함수를 이용한 병합 군집화</a></li>
<li class="chapter" data-level="15.3.4" data-path="ch-R-clustering.html"><a href="ch-R-clustering.html#병합-군집화에-대한-계통도-그리기"><i class="fa fa-check"></i><b>15.3.4</b> 병합 군집화에 대한 계통도 그리기</a></li>
<li class="chapter" data-level="15.3.5" data-path="ch-R-clustering.html"><a href="ch-R-clustering.html#군집-나누기"><i class="fa fa-check"></i><b>15.3.5</b> 군집 나누기</a></li>
<li class="chapter" data-level="15.3.6" data-path="ch-R-clustering.html"><a href="ch-R-clustering.html#최적-군집-수의-결정"><i class="fa fa-check"></i><b>15.3.6</b> 최적 군집 수의 결정</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ch-R-hypothesis-tests.html"><a href="ch-R-hypothesis-tests.html"><i class="fa fa-check"></i><b>16</b> <strong>R</strong> 통계적 가설검정</a>
<ul>
<li class="chapter" data-level="16.1" data-path="ch-R-hypothesis-tests.html"><a href="ch-R-hypothesis-tests.html#sec-hypothesis"><i class="fa fa-check"></i><b>16.1</b> 가설검정이란?</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="ch-R-hypothesis-tests.html"><a href="ch-R-hypothesis-tests.html#가설의-설정"><i class="fa fa-check"></i><b>16.1.1</b> 가설의 설정</a></li>
<li class="chapter" data-level="16.1.2" data-path="ch-R-hypothesis-tests.html"><a href="ch-R-hypothesis-tests.html#검정통계량과-표본-분포"><i class="fa fa-check"></i><b>16.1.2</b> 검정통계량과 표본 분포</a></li>
<li class="chapter" data-level="16.1.3" data-path="ch-R-hypothesis-tests.html"><a href="ch-R-hypothesis-tests.html#기각역과-유의수준"><i class="fa fa-check"></i><b>16.1.3</b> 기각역과 유의수준</a></li>
<li class="chapter" data-level="16.1.4" data-path="ch-R-hypothesis-tests.html"><a href="ch-R-hypothesis-tests.html#유의확률-p-값p-value"><i class="fa fa-check"></i><b>16.1.4</b> 유의확률 p-값(p-value)</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="ch-R-hypothesis-tests.html"><a href="ch-R-hypothesis-tests.html#r을-이용한-범주형-변수의-가설검점"><i class="fa fa-check"></i><b>16.2</b> <strong>R</strong>을 이용한 범주형 변수의 가설검점</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="ch-R-hypothesis-tests.html"><a href="ch-R-hypothesis-tests.html#관절염-치료-임상시험-데이터-분석"><i class="fa fa-check"></i><b>16.2.1</b> 관절염 치료 임상시험 데이터 분석</a></li>
<li class="chapter" data-level="16.2.2" data-path="ch-R-hypothesis-tests.html"><a href="ch-R-hypothesis-tests.html#기술-통계-분석"><i class="fa fa-check"></i><b>16.2.2</b> 기술 통계 분석</a></li>
<li class="chapter" data-level="16.2.3" data-path="ch-R-hypothesis-tests.html"><a href="ch-R-hypothesis-tests.html#독립성-검정"><i class="fa fa-check"></i><b>16.2.3</b> 독립성 검정</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="ch-R-hypothesis-tests.html"><a href="ch-R-hypothesis-tests.html#수치형-변수에-대한-가설검정"><i class="fa fa-check"></i><b>16.3</b> 수치형 변수에 대한 가설검정</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="ch-R-linear-regression.html"><a href="ch-R-linear-regression.html"><i class="fa fa-check"></i><b>17</b> <strong>R</strong> 선형 회귀</a>
<ul>
<li class="chapter" data-level="17.1" data-path="ch-R-linear-regression.html"><a href="ch-R-linear-regression.html#sec-simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> 단순 선형 회귀</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="ch-R-linear-regression.html"><a href="ch-R-linear-regression.html#sec-cars"><i class="fa fa-check"></i><b>17.1.1</b> <code>cars</code> 데이터</a></li>
<li class="chapter" data-level="17.1.2" data-path="ch-R-linear-regression.html"><a href="ch-R-linear-regression.html#sec-simple-linear-regression-theory"><i class="fa fa-check"></i><b>17.1.2</b> 단순 선형 회귀 모형</a></li>
<li class="chapter" data-level="17.1.3" data-path="ch-R-linear-regression.html"><a href="ch-R-linear-regression.html#sec-lm"><i class="fa fa-check"></i><b>17.1.3</b> <code>lm()</code> 함수</a></li>
<li class="chapter" data-level="17.1.4" data-path="ch-R-linear-regression.html"><a href="ch-R-linear-regression.html#sec-linear-regression-evaluation"><i class="fa fa-check"></i><b>17.1.4</b> 선형 회귀 모형의 평가</a></li>
<li class="chapter" data-level="17.1.5" data-path="ch-R-linear-regression.html"><a href="ch-R-linear-regression.html#모형의-개선"><i class="fa fa-check"></i><b>17.1.5</b> 모형의 개선</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="ch-R-linear-regression.html"><a href="ch-R-linear-regression.html#sec-multiple-linear-regression"><i class="fa fa-check"></i><b>17.2</b> 다중 선형 회귀</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="ch-R-linear-regression.html"><a href="ch-R-linear-regression.html#galtonfamilies-데이터"><i class="fa fa-check"></i><b>17.2.1</b> <code>GaltonFamilies</code> 데이터</a></li>
<li class="chapter" data-level="17.2.2" data-path="ch-R-linear-regression.html"><a href="ch-R-linear-regression.html#sec-multiple-linear-regression-theory"><i class="fa fa-check"></i><b>17.2.2</b> 다중 선형 회귀 모형</a></li>
<li class="chapter" data-level="17.2.3" data-path="ch-R-linear-regression.html"><a href="ch-R-linear-regression.html#lm을-이용한-다중-선형-회귀"><i class="fa fa-check"></i><b>17.2.3</b> <code>lm()</code>을 이용한 다중 선형 회귀</a></li>
<li class="chapter" data-level="17.2.4" data-path="ch-R-linear-regression.html"><a href="ch-R-linear-regression.html#sec-interaction-terms"><i class="fa fa-check"></i><b>17.2.4</b> 교차항의 도입</a></li>
<li class="chapter" data-level="17.2.5" data-path="ch-R-linear-regression.html"><a href="ch-R-linear-regression.html#sec-variable-selections"><i class="fa fa-check"></i><b>17.2.5</b> 변수 선택</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="ch-RandPython.html"><a href="ch-RandPython.html"><i class="fa fa-check"></i><b>A</b> <strong>R</strong>과 <strong>Python</strong> 연동하기</a>
<ul>
<li class="chapter" data-level="A.1" data-path="ch-RandPython.html"><a href="ch-RandPython.html#reticulate-설치-및-사용할-파이썬-버전-설정"><i class="fa fa-check"></i><b>A.1</b> <code>reticulate</code> 설치 및 사용할 파이썬 버전 설정</a></li>
<li class="chapter" data-level="A.2" data-path="ch-RandPython.html"><a href="ch-RandPython.html#r과-파이썬-연동하는-방법"><i class="fa fa-check"></i><b>A.2</b> R과 파이썬 연동하는 방법</a></li>
<li class="chapter" data-level="A.3" data-path="ch-RandPython.html"><a href="ch-RandPython.html#파이썬-모듈-연동하기"><i class="fa fa-check"></i><b>A.3</b> 파이썬 모듈 연동하기</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="ch-RandPython.html"><a href="ch-RandPython.html#r과-python의-형식-변환"><i class="fa fa-check"></i><b>A.3.1</b> <strong>R</strong>과 <strong>Python</strong>의 형식 변환</a></li>
<li class="chapter" data-level="A.3.2" data-path="ch-RandPython.html"><a href="ch-RandPython.html#형변환-직접-하기"><i class="fa fa-check"></i><b>A.3.2</b> 형변환 직접 하기</a></li>
<li class="chapter" data-level="A.3.3" data-path="ch-RandPython.html"><a href="ch-RandPython.html#파이썬-모듈의-도움말-확인하기"><i class="fa fa-check"></i><b>A.3.3</b> 파이썬 모듈의 도움말 확인하기</a></li>
<li class="chapter" data-level="A.3.4" data-path="ch-RandPython.html"><a href="ch-RandPython.html#pickle-사용하기"><i class="fa fa-check"></i><b>A.3.4</b> <code>pickle</code> 사용하기</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="ch-RandPython.html"><a href="ch-RandPython.html#r-마크다운-문서에서-파이썬-명령-실행하기"><i class="fa fa-check"></i><b>A.4</b> R 마크다운 문서에서 파이썬 명령 실행하기</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="ch-RTips.html"><a href="ch-RTips.html"><i class="fa fa-check"></i><b>B</b> <strong>R</strong> 관련 여러 주제들</a>
<ul>
<li class="chapter" data-level="B.1" data-path="ch-RTips.html"><a href="ch-RTips.html#r의-파일-및-폴더-관련-명령어등"><i class="fa fa-check"></i><b>B.1</b> <strong>R</strong>의 파일 및 폴더 관련 명령어등</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="ch-RTips.html"><a href="ch-RTips.html#작업-디렉토리"><i class="fa fa-check"></i><b>B.1.1</b> 작업 디렉토리</a></li>
<li class="chapter" data-level="B.1.2" data-path="ch-RTips.html"><a href="ch-RTips.html#폴더-내의-파일-목록-확인하기"><i class="fa fa-check"></i><b>B.1.2</b> 폴더 내의 파일 목록 확인하기</a></li>
<li class="chapter" data-level="B.1.3" data-path="ch-RTips.html"><a href="ch-RTips.html#파일과-폴더-존재-확인"><i class="fa fa-check"></i><b>B.1.3</b> 파일과 폴더 존재 확인</a></li>
<li class="chapter" data-level="B.1.4" data-path="ch-RTips.html"><a href="ch-RTips.html#폴더의-생성과-삭제"><i class="fa fa-check"></i><b>B.1.4</b> 폴더의 생성과 삭제</a></li>
<li class="chapter" data-level="B.1.5" data-path="ch-RTips.html"><a href="ch-RTips.html#파일의-생성-복사-이동-삭제"><i class="fa fa-check"></i><b>B.1.5</b> 파일의 생성, 복사, 이동, 삭제</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="ch-RTips.html"><a href="ch-RTips.html#r에서-계산-정확도를-향상시키기"><i class="fa fa-check"></i><b>B.2</b> <strong>R</strong>에서 계산 정확도를 향상시키기</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R 프로그래밍 3판 (draft)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch-visualization" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> ggplot2를 이용한 데이터 시각화<a href="ch-visualization.html#ch-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>이 장에서는 ggplot2를 이용하여 데이터를 시각화하는 방법을 배운다. ggplot2 패키지는 tidyverse 패키지를 설치하였으면 자동으로 설치된다. 그리고 tidyverse 패키지를 적재하면 ggplot2 패키지도 자동 적재된다.</p>
<div class="sourceCode" id="cb1547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1547-1"><a href="ch-visualization.html#cb1547-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<div id="sec-getStarted-ggplot2" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> ggplot2 시작하기<a href="ch-visualization.html#sec-getStarted-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>이 절에서는 <code>ggplot2</code>에서 제공하는 <code>mpg</code> 데이터를 이용하여 ‘배기량이 커지면 연비가 낮아지는가?’ 라는 물음을 그래프를 이용하여 탐색해 보자.
<code>mpg</code>는 1999년과 2008년에 미국 EPA에서 조사하여 발표한 자동차 주요 모델별 연비 데이터이다.
<code>mpg</code> 데이터에 대한 자세한 설명은 <a href="ch-dataTransformation.html#sec-dplyr">7.3</a> 절의 <code>mpg</code> 데이터에 대한 설명이나 R 도움말을 참조하기 바란다.</p>
<div id="subsec-tryGgplot" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> ggplot2 그래프 그려보기<a href="ch-visualization.html#subsec-tryGgplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>mpg</code> 데이터로부터 배기량(displ)을 x 축으로, 고속도로 연비(hwy)를 y 축으로 하는 산점도를 그려보자.</p>
<div class="sourceCode" id="cb1549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1549-1"><a href="ch-visualization.html#cb1549-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1549-2"><a href="ch-visualization.html#cb1549-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy), <span class="at">data=</span>mpg)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-3-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>산점도에서 배기량이 커짐지면 연비가 줄어드는 경향을 관찰할 수 있다. 이 산점도를 그린 R 명령어는 두 개의 함수가 결합하여 실행되었다.</p>
<ul>
<li><code>ggplot()</code>: <code>ggplot2</code> 그래프의 좌표축과 좌표평면을 만드는 함수이다. 뒤에서 살펴보겠지만 그래프에 공통된 데이터와 매핑을 설정할 수 있다.</li>
<li><code>geom_point()</code>: <code>ggplot()</code> 함수가 만들어 놓은 좌표평면 위에, 점이라는 도형을 이용하여 그래프를 그린다. 각 geom 함수의 그래프는 좌표평면 상에서 별도의 층으로 구성된다.</li>
<li><code>ggplot2</code>의 명령문을 입력할 때 여러 함수를 합쳐서 실행하기 위하여 <code>+</code> 연산자를 이용한다. <code>dplyr</code> 패키지의 파이프 연산자와 유사한 역할을 한다. 그러나 문법이 다르기 때문에 <code>ggplot2</code> 명령어 들 사이에는 <code>+</code> 연산자를 사용하여야 한다.</li>
</ul>
<p>앞의 예에서는 <code>geom_point()</code> 함수의 <code>data</code>와 <code>mapping</code>이라는 인수를 설정하였다.</p>
<ul>
<li><code>data</code>: 도형으로 표현할 데이터 프레임을 지정한다.</li>
<li><code>mapping</code>: 도형의 시각적 속성과 <code>data</code>에 지정된 데이터 프레임의 열을 쌍으로 대응시킨다. <code>aes()</code> 함수 내에 <code>&lt;도형의 속성&gt;=&lt;데이터 열 이름&gt;</code>의 형식으로 기술된다. 앞의 예에서 점의 x-축 위치에 <code>displ</code> 열이, y-축 위치에 <code>hwy</code> 열이 쌍으로 대응되었다.</li>
</ul>
<p>ggplot2에는 점을 그리는 <code>geom_point()</code> 함수뿐 아니라 다양한 도형을 그리는 geom 함수들이 있다. 이 함수들은 모두 <code>data</code>와 <code>mapping</code>이라는 인수를 가지고 있다.</p>
<p>ggplot2는 그래픽 문법(grammar of graphics)를 가지고 있어서 모든 그래프를 동일한 형식으로 생성할 수 있다.
다음은 ggplot2의 그래픽 문법의 개요를 보여준다.
우리는 이 장에서 ggplot2의 여러 문법적 요소를 하나씩 살펴볼 것이다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="img/grammarOfGraphics.png" alt="ggplot2의 그래픽 문법 (출처: Data visualization with ggplot2::cheat sheet (RStudio))" width="70%" />
<p class="caption">
Figure 8.1: ggplot2의 그래픽 문법 (출처: Data visualization with ggplot2::cheat sheet (RStudio))
</p>
</div>
</div>
</div>
<div id="sec-aesMapping" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> 도형의 속성에 데이터 열을 대응시키기 (aesthetic mapping)<a href="ch-visualization.html#sec-aesMapping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>앞의 산점도에서 배기량에 따라 연비가 줄어드는 관계를 조금 벗어나는 관측치들이 있다.</p>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-5-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>이 예외적인 관측치들이 자동차 종류의 차이 때문에 발생했다, 라고 가설을 세웠다 하자. 이 가설을 확인해 보려면 자동차 종류별로 관측치를 시각화할 필요가 있다. 앞서 본 <code>geom_point()</code> 함수는 ’점’이라는 도형을 좌표평면 상에서 그린다. 점이라는 도형은 x-축의 위치(<code>x</code>)와 y-축의 위치(<code>y</code>)뿐 아니라 색상(<code>color</code>), 모양(<code>shape</code>), 크기(<code>size</code>), 투명도(<code>alpha</code>) 등의 다른 시각적 속성을 가지고 있다. 우리는 이러한 속성 중 하나에 <code>mpg</code> 데이터의 <code>class</code> 열을 대응시켜 자동차 종류 별로 좌표평면에서 시각적으로 구분되는 점으로 표현할 수 있다.</p>
<div id="범주형-변수를-색상color-속성에-매핑하기" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> 범주형 변수를 색상(<code>color</code>) 속성에 매핑하기<a href="ch-visualization.html#범주형-변수를-색상color-속성에-매핑하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>다음은 관측치의 종류(<code>class</code>)에 따라 점을 서로 다른 색상(<code>color</code>)으로 표현한 예이다. 자동차의 종류에 따라 점이 다른 색상으로 표현되고, 어떤 색상이 어떤 자동차 종류에 대응되었는지에 대한 범례가 자동 생성된다.</p>
<div class="sourceCode" id="cb1550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1550-1"><a href="ch-visualization.html#cb1550-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1550-2"><a href="ch-visualization.html#cb1550-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy, <span class="at">color=</span>class), <span class="at">data=</span>mpg)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-6-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>앞선 그래프에서 이상치로 표현되었던 점들 중 한 점만 제외하고 모두 2seater 자동차의 관측치였음을 알 수 있다. 이 종류의 차는 스포츠카로 배기량에 비해 가벼운 몸체를 가지고 있어 예외적인 연비가 관측된 것으로 보인다.</p>
<p>다음으로 <code>class</code> 열을 <code>shape</code>, <code>size</code>, <code>alpha</code> 등의 속성에 대응시켜 어떤 결과가 나오는지 살펴보자.</p>
</div>
<div id="범주형-변수를-모양shape-속성에-매핑하기" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> 범주형 변수를 모양(<code>shape</code>) 속성에 매핑하기<a href="ch-visualization.html#범주형-변수를-모양shape-속성에-매핑하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>shape</code> 속성은 점의 모양을 결정한다. 다음은 앞의 산점도를 구동 방식(drv)에 따라 점의 모양이 다르게 표시한 예이다.</p>
<div class="sourceCode" id="cb1551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1551-1"><a href="ch-visualization.html#cb1551-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1551-2"><a href="ch-visualization.html#cb1551-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy, <span class="at">shape=</span>drv), <span class="at">data=</span>mpg)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-7-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>shape</code> 속성에 매핑할 때 주의할 점은 <code>shape</code>은 최대 6개의 모양으로만 점을 구분하기 때문에 <code>class</code> 열처럼 6개보다 많은 종류의 데이터가 있는 열을 매핑하면 데이터가 제대로 표시가 되지 않는다. 다음 예처럼 <code>shape</code> 속성에 <code>class</code> 열을 매핑하니 경고가 나타나고 suv 데이터를 표시하지 못한 것을 확인할 수 있다.</p>
<div class="sourceCode" id="cb1552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1552-1"><a href="ch-visualization.html#cb1552-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1552-2"><a href="ch-visualization.html#cb1552-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy, <span class="at">shape=</span>class), <span class="at">data=</span>mpg)</span></code></pre></div>
<pre><code>Warning: The shape palette can deal with a maximum of 6 discrete values because more
than 6 becomes difficult to discriminate
ℹ you have requested 7 values. Consider specifying shapes manually if you need
  that many have them.</code></pre>
<pre><code>Warning: Removed 62 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-8-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="연속형-변수를-크기size-투명도alpha-색상color-속성에-매핑하기" class="section level3 hasAnchor" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> 연속형 변수를 크기(<code>size</code>), 투명도(<code>alpha</code>), 색상(<code>color</code>) 속성에 매핑하기<a href="ch-visualization.html#연속형-변수를-크기size-투명도alpha-색상color-속성에-매핑하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>모양(<code>shape</code>) 속성은 몇 가지 값으로 표현되는 범주형 변수를 표현하기 좋다. 데이터의 열이 연속형 변수이면 연속적인 값을 표현하기 좋은 가로축(<code>x</code>), 세로축(<code>y</code>), 크기(<code>size</code>), 투명도(<code>alpha</code>) 등을 이용하는 것이 좋다. 색상(<code>color</code>)은 범주형 변수와 연속형 변수에 모두 매핑될 수 있다. 범주형 변수로 매핑되면 구분되는 색상으로, 연속형 변수로 매핑되면 색상의 그라데이션으로 값을 표시한다.</p>
<p>다음은 도심 연비와 고속도로 연비를 가로축과 세로축으로 하는 그래프에서 점의 크기 속성을 배기량 열에 매핑한 결과이다. 도심 연비와 고속도로 연비가 좋은 차들은 배기량이 작은 차임을 알 수 있다.</p>
<div class="sourceCode" id="cb1555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1555-1"><a href="ch-visualization.html#cb1555-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1555-2"><a href="ch-visualization.html#cb1555-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>cty, <span class="at">y=</span>hwy, <span class="at">size=</span>displ), <span class="at">data=</span>mpg)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-9-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>다음은 동일한 도심 연비와 고속도로 연비 산점도에서 그래프에서 점의 색상을 배기량 열에 매핑한 결과이다. 범주형 변수가 매핑될 때와는 달리 색상의 연속적인 변화인 그라데이션을 사용하여 배기량을 표현하고 있음을 볼 수 있다.</p>
<div class="sourceCode" id="cb1556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1556-1"><a href="ch-visualization.html#cb1556-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1556-2"><a href="ch-visualization.html#cb1556-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>cty, <span class="at">y=</span>hwy, <span class="at">color=</span>displ), <span class="at">data=</span>mpg)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-10-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>다음은 동일한 도심 연비와 고속도로 연비 산점도에서 그래프에서 점의 투명도를 실린더 수 열에 매핑한 결과이다.</p>
<div class="sourceCode" id="cb1557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1557-1"><a href="ch-visualization.html#cb1557-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1557-2"><a href="ch-visualization.html#cb1557-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>cty, <span class="at">y=</span>hwy, <span class="at">alpha=</span>cyl), <span class="at">data=</span>mpg)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-11-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그럼 <code>size</code>와 <code>alpha</code> 등의 속성에 연속형 변수가 아니라 범주형 변수를 매핑하면 어떻게 될까?
범주의 순서를 기준으로 각 범주를 1부터 1씩 증가하는 수치로 간주하여 그래프를 그려준다.
다음 예는 <code>size</code>와 <code>alpha</code> 속성에 자동차 종류(<code>class</code>)를 매핑한 결과이다. <code>size</code>와 <code>alpha</code> 속성은 범산형 데이터를 표시하기에는 적절하지 않아서 관련된 경고 메시지를 표시한다. 왜냐하면 점의 크기와 투명도는 연속적인 값을 가지는 속성이기 때문에 연속형 변수를 매핑하는 것이 자연스럽기 때문이다.</p>
<div class="sourceCode" id="cb1558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1558-1"><a href="ch-visualization.html#cb1558-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1558-2"><a href="ch-visualization.html#cb1558-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy, <span class="at">size=</span>class), <span class="at">data=</span>mpg)</span></code></pre></div>
<pre><code>Warning: Using size for a discrete variable is not advised.</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1560-1"><a href="ch-visualization.html#cb1560-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1560-2"><a href="ch-visualization.html#cb1560-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy, <span class="at">alpha=</span>class), <span class="at">data=</span>mpg)</span></code></pre></div>
<pre><code>Warning: Using alpha for a discrete variable is not advised.</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-13-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="도형의-여러-속성에-데이터-열을-매핑시키기" class="section level3 hasAnchor" number="8.2.4">
<h3><span class="header-section-number">8.2.4</span> 도형의 여러 속성에 데이터 열을 매핑시키기<a href="ch-visualization.html#도형의-여러-속성에-데이터-열을-매핑시키기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>도형의 여러 속성에 데이터의 한 열을 매핑시킬 수도 있다. 다음 예에서는 구동방식(<code>drv</code>)에 따라 점의 모양과 색상을 다르게 표시하였다. 아울러 어떤 구동방식이 어떤 색상과 모양의 점으로 표현되었는지에 대한 범례도 자동 생성되었다.</p>
<div class="sourceCode" id="cb1562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1562-1"><a href="ch-visualization.html#cb1562-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1562-2"><a href="ch-visualization.html#cb1562-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy, <span class="at">color=</span>drv, <span class="at">shape=</span>drv), <span class="at">data=</span>mpg)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그래프에서 보듯이 예외적인 관측치를 구동방식의 차이로 설명하기는 어려워 보인다. 예외적인 관측치의 대부분이 후륜구동(r)이긴 하지만 주류적인 연비 경향 안에 포함되어 있는 후륜구동 관측치들도 많기 때문이다.</p>
<p>위의 예에서 <code>color</code>와 <code>shape</code> 속성에 각각 다른 데이터 열을 매핑할 수도 있다.</p>
<div class="sourceCode" id="cb1563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1563-1"><a href="ch-visualization.html#cb1563-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1563-2"><a href="ch-visualization.html#cb1563-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy, <span class="at">color=</span>class, <span class="at">shape=</span>drv), <span class="at">data=</span>mpg)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-15-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="도형-속성에-데이터-열을-매핑하기---예제" class="section level3 hasAnchor" number="8.2.5">
<h3><span class="header-section-number">8.2.5</span> 도형 속성에 데이터 열을 매핑하기 - 예제<a href="ch-visualization.html#도형-속성에-데이터-열을-매핑하기---예제" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>지금까지 x-축과 y-축을 배기량(<code>displ</code>)과 고속도로 연비(<code>hwy</code>) 열로만 매핑하였다. 다음처럼 도심 연비(<code>cty</code>)와 고속도로 연비(<code>hwy</code>)의 관계를 보기 위하여 x-축과 y-축에 이 두 데이터 열을 매핑하여 그래프를 그릴 수도 있다.</p>
<div class="sourceCode" id="cb1564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1564-1"><a href="ch-visualization.html#cb1564-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1564-2"><a href="ch-visualization.html#cb1564-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>cty, <span class="at">y=</span>hwy, <span class="at">color=</span>drv, <span class="at">shape=</span>drv), <span class="at">data=</span>mpg)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>iris</code> 데이터는 <strong>R</strong>의 기본 기능에서 제공하는 붓꽃에 대한 데이터이다.</p>
<div class="sourceCode" id="cb1565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1565-1"><a href="ch-visualization.html#cb1565-1" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code></pre></div>
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
<p>다음은 <code>iris</code> 데이터의 <code>Sepal.Length</code>와 <code>Sepal.Width</code>를 점의 x-축과 y-축 속성에 매핑하고, 색상과 모양 속성에 <code>Species</code> 열을 매핑한 예이다.</p>
<div class="sourceCode" id="cb1567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1567-1"><a href="ch-visualization.html#cb1567-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1567-2"><a href="ch-visualization.html#cb1567-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Sepal.Width, <span class="at">color=</span>Species, <span class="at">shape=</span>Species), <span class="at">data=</span>iris)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-18-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="도형의-속성에-대응시키기-vs.-도형의-속성-인수를-설정하기" class="section level3 hasAnchor" number="8.2.6">
<h3><span class="header-section-number">8.2.6</span> 도형의 속성에 대응시키기 vs. 도형의 속성 인수를 설정하기<a href="ch-visualization.html#도형의-속성에-대응시키기-vs.-도형의-속성-인수를-설정하기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>마지막으로 데이터를 도형의 속성으로 대응시키기와 도형의 속성 인수를 설정하기의 차이를 살펴보자.</p>
<div id="도형의-속성-인수-설정하기" class="section level4 hasAnchor" number="8.2.6.1">
<h4><span class="header-section-number">8.2.6.1</span> 도형의 속성 인수 설정하기<a href="ch-visualization.html#도형의-속성-인수-설정하기" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>지금까지는 점의 속성에 데이터의 열을 대응시켜 관측치의 값에 따라 점이 시각적으로 다르게 표현되도록 하였다. 그런데 데이터와 무관하게 점의 속성을 특정한 값으로 설정할 수도 있다. 다음은 산점도 점을 모두 파란색으로 지정한 예이다.</p>
<div class="sourceCode" id="cb1568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1568-1"><a href="ch-visualization.html#cb1568-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1568-2"><a href="ch-visualization.html#cb1568-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy), <span class="at">data=</span>mpg, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-19-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>이처럼 도형의 어떤 속성을 특정한 값으로 지정하는 것을 도형의 속성 인수를 설정한다고 한다. 이 경우 도형의 시각적 속성의 변화는 데이터와는 무관하며, 그렇기 때문에 <code>mapping</code> 인수의 <code>aes()</code> 함수 내에 정의되지 않는다. 대신 <code>aes()</code> 바깥에 별도의 geom 함수의 인수로서 설정된다.</p>
<p>도형의 속성 인수를 설정할 때, 설정되는 값은 인수에 따라 다르다.</p>
<ul>
<li><code>color</code> 인수: 색상의 이름이 문자열로 부여된다. 부여할 수 있는 생상의 이름을 확인하려면 <code>colors()</code> 함수를 실행해 본다.</li>
<li><code>size</code> 인수: 점의 크기가 mm 단위로 설정된다.</li>
<li><code>shape</code> 인수: 표시할 문자를 직접 설정할 수도 있고, 0에서 24까지의 숫자로도 지정할 수 있다. 다음은 <code>color="red"</code>와 <code>fill="blue"</code>로 인수가 설정되었을 때 <code>shape</code> 인수의 값에 따라 점의 모양을 보여준다.</li>
</ul>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-20-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="도형의-속성-인수를-속성-대응시키기에-잘못-설정하는-경우" class="section level4 hasAnchor" number="8.2.6.2">
<h4><span class="header-section-number">8.2.6.2</span> 도형의 속성 인수를 속성 대응시키기에 잘못 설정하는 경우<a href="ch-visualization.html#도형의-속성-인수를-속성-대응시키기에-잘못-설정하는-경우" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>ggplot2</code>의 초보자가 가끔 도형의 속성을 데이터의 열에 대응시키기와 도형의 속성 인수를 설정하는 것을 혼동할 때가 있다. 다음처럼 <code>color="blue"</code>의 인수 설정을 <code>aes()</code> 안에 기술하면 어떻게 될까? 실제 이를 실행해 보면 점들이 파란색이 아니라 빨간색으로 표시되는 것을 볼 수 있다.</p>
<div class="sourceCode" id="cb1569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1569-1"><a href="ch-visualization.html#cb1569-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1569-2"><a href="ch-visualization.html#cb1569-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>), <span class="at">data=</span>mpg)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-21-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>aes()</code> 함수 안에 설정되었기 때문에 ggplot은 <code>color="blue"</code>를 <code>color</code> 속성에 “blue”라는 하나의 값을 가진 열이 대응된 것으로 간주한다. 그러므로 이 값에 적절한 색-이 예에서는 빨간색-을 대응시켜 점을 표시한 후, 범례에 blue라는 값이 빨간색으로 대응되었음을 표시하였다. 따라서 도형 속성을 데이터 열에 대응시키기와 도형의 속성 인수를 설정하는 것을 구분하여 사용하지 않으면 이렇듯 엉뚱한 결과를 얻을 수 있으므로 주의가 필요하다.</p>
</div>
</div>
<div id="group-속성" class="section level3 hasAnchor" number="8.2.7">
<h3><span class="header-section-number">8.2.7</span> <code>group</code> 속성<a href="ch-visualization.html#group-속성" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>geom 도형의 대부분의 속성은 도형의 시각적 표현을 직접적으로 변화시키는 속성들이다. 대표적인 예가 <code>x</code>, <code>y</code>, <code>color</code>, <code>shape</code>, <code>size</code>, <code>fill</code> 등의 속성이다. 이러한 속성은 시각적으로 효과가 직접적으로 들어나므로 이해하기 쉽다.</p>
<p>반면 <code>group</code> 속성은 도형의 시각적 속성을 직접 변형하는 것이 아니라, 도형을 그릴 때 데이터를 어떤 식으로 그룹으로 묶어 사용할지만 지정한다. 이를 통해 그래프의 전체 모양에 영향을 준다.</p>
<p><code>geom_point()</code> 함수는 관측치 하나에 점 하나를 대응시켜 그래프를 그린다. 그러나 어떤 geom 함수는 여러 관측치를 그룹으로 묶어서 하나의 도형을 그린다. 대표적인 예가 <code>geom_line()</code>과 <code>geom_smooth()</code> 함수이다. 이 함수들은 여러 관측치를 사용하여 하나의 선을 완성한다. 만약 <code>group</code> 속성이 매핑되어 있지 않으면 모든 데이터를 하나의 그룹으로 하여 선 하나를 그린다. 반면 <code>group</code> 속성이 매핑되면, <code>group</code>속성에 매핑된 값을 기준으로 데이터를 그룹화하여 각각 도형 하나(<code>geom_line()</code>과 <code>geom_smooth()</code> 함수에서는 선 하나)를 그린다. 지금 설명한 내용을 예를 들어 살펴보자.</p>
</div>
<div id="그룹으로-나누어-선-그래프-그리기" class="section level3 hasAnchor" number="8.2.8">
<h3><span class="header-section-number">8.2.8</span> 그룹으로 나누어 선 그래프 그리기<a href="ch-visualization.html#그룹으로-나누어-선-그래프-그리기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Orange 데이터는 5 그루의 나무에서 <code>age</code>(나이: 일)와 <code>circumference</code>(둘레: mm)을 측정한 결과이다. <code>Tree</code> 변수는 5그루 나무에 붙인 일련번호이다.</p>
<div class="sourceCode" id="cb1570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1570-1"><a href="ch-visualization.html#cb1570-1" tabindex="-1"></a>Orange</span></code></pre></div>
<pre><code>   Tree  age circumference
1     1  118            30
2     1  484            58
3     1  664            87
4     1 1004           115
5     1 1231           120
6     1 1372           142
7     1 1582           145
8     2  118            33
9     2  484            69
10    2  664           111
11    2 1004           156
......</code></pre>
<p>다음은 <code>age</code>와 <code>circumference</code>를 <code>x</code>와 <code>y</code> aesthetics에 매핑한 그래프이다.</p>
<div class="sourceCode" id="cb1572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1572-1"><a href="ch-visualization.html#cb1572-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>circumference), <span class="at">data=</span>Orange)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-23-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>이번에는 위와 동일한 매핑으로 <code>geom_line()</code>을 그려보자. <code>geom_line()</code>은 <code>x</code>좌표가 작은 것에서 큰 것 순으로 점을 연결하여 하나의 선을 완성한다.</p>
<div class="sourceCode" id="cb1573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1573-1"><a href="ch-visualization.html#cb1573-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>circumference), <span class="at">data=</span>Orange)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-24-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>동일한 나이 대의 데이터가 많아서 하나의 선으로 연결한 그래프가 의미를 갖기 어려워 보인다. 이번에는 <code>group</code> 속성에 <code>Tree</code> 변수를 매핑해 보자. 데이터가 <code>Tree</code>의 값에 따라 그룹으로 묶여 선이 각각 그려졌음을 확인할 수 있다.</p>
<div class="sourceCode" id="cb1574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1574-1"><a href="ch-visualization.html#cb1574-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1574-2"><a href="ch-visualization.html#cb1574-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>circumference, <span class="at">group=</span>Tree), <span class="at">data=</span>Orange)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-25-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="이산형-변수는-group-속성으로-자동-매핑된다." class="section level3 hasAnchor" number="8.2.9">
<h3><span class="header-section-number">8.2.9</span> 이산형 변수는 <code>group</code> 속성으로 자동 매핑된다.<a href="ch-visualization.html#이산형-변수는-group-속성으로-자동-매핑된다." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>각 나무의 데이터를 구분해 보기 위하여 다음처럼 <code>color</code> 속성을 추가해 보자. <code>Tree</code> 변수는 순서형 범주 데이터로 이산형 데이터이므로, <code>color</code>가 뚜렷이 구분되는 색으로 매핑되었다. 그리고 수준의 순서에 따라 범례도 정렬되었다.</p>
<div class="sourceCode" id="cb1575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1575-1"><a href="ch-visualization.html#cb1575-1" tabindex="-1"></a>Orange<span class="sc">$</span>Tree</span></code></pre></div>
<pre><code> [1] 1 1 1 1 1 1 1 2 2 2 2 2 2 2 3 3 3 3 3 3 3 4 4 4 4 4 4 4 5 5 5 5 5 5 5
Levels: 3 &lt; 1 &lt; 5 &lt; 2 &lt; 4</code></pre>
<div class="sourceCode" id="cb1577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1577-1"><a href="ch-visualization.html#cb1577-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1577-2"><a href="ch-visualization.html#cb1577-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>circumference, <span class="at">group=</span>Tree, <span class="at">color=</span>Tree), <span class="at">data=</span>Orange )</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-26-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그런데 이를 좀 더 간편히 할 수 있는 방법이 있다. <code>ggplot2</code>는 속성에 매핑된 변수 중에 이산형 변수가 있으면 이를 <code>group</code> 속성에 자동으로 매핑시킨다. 다음처럼 <code>color</code> 속성에 <code>Tree</code>를 매핑만 하면, 자동으로 이를 <code>group</code> 속성에 반영하여 선을 구분하여 그려준다.</p>
<div class="sourceCode" id="cb1578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1578-1"><a href="ch-visualization.html#cb1578-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1578-2"><a href="ch-visualization.html#cb1578-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>circumference, <span class="at">color=</span>Tree), <span class="at">data=</span>Orange)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-27-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>다음 예는 <code>linetype</code> 속성으로 각 나무를 구분한 예이다.</p>
<div class="sourceCode" id="cb1579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1579-1"><a href="ch-visualization.html#cb1579-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1579-2"><a href="ch-visualization.html#cb1579-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>circumference, <span class="at">linetype=</span>Tree), <span class="at">data=</span>Orange)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-28-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_smooth-함수에서-group-속성" class="section level3 hasAnchor" number="8.2.10">
<h3><span class="header-section-number">8.2.10</span> <code>geom_smooth()</code> 함수에서 <code>group</code> 속성<a href="ch-visualization.html#geom_smooth-함수에서-group-속성" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>group</code> 속성이 이용되는 또 다른 예가 <code>geom_smmooth()</code> 함수이다. 이 함수는 <code>group</code>에 매핑된 정보에 따라 데이터를 그룹화하여 추세선을 그린다.</p>
<div class="sourceCode" id="cb1580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1580-1"><a href="ch-visualization.html#cb1580-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1580-2"><a href="ch-visualization.html#cb1580-2" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>circumference), <span class="at">data=</span>Orange )</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-29-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1582-1"><a href="ch-visualization.html#cb1582-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1582-2"><a href="ch-visualization.html#cb1582-2" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>circumference, <span class="at">color=</span>Tree), </span>
<span id="cb1582-3"><a href="ch-visualization.html#cb1582-3" tabindex="-1"></a>              <span class="at">data=</span>Orange )</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-30-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1584-1"><a href="ch-visualization.html#cb1584-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1584-2"><a href="ch-visualization.html#cb1584-2" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>circumference, <span class="at">color=</span>Tree), </span>
<span id="cb1584-3"><a href="ch-visualization.html#cb1584-3" tabindex="-1"></a>              <span class="at">data=</span>Orange, <span class="at">se=</span>F)</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-31-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>마지막 예에서는 <code>geom_smooth()</code> 함수의 <code>se</code> 인수를 <code>FALSE</code>로 설정하여 신뢰구간이 표시되지 않도록 하였다.</p>
</div>
</div>
<div id="sec-facets" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> 측면(facets)으로 나누어 그리기<a href="ch-visualization.html#sec-facets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="ch-visualization.html#sec-aesMapping">8.2</a> 장에서 배기량과 고속도로 연비의 산점도를 자동차 종류에 따라 분리하여 살펴보기 위해 점의 시각적 속성 중 하나에 자동차 종류를 대응시켰다. 원래의 그래프를 또 다른 변수의 측면에서 세분화하여 살펴보는 방법으로는 도형의 다른 속성에 해당 변수를 대응시키는 것 말고도 해당 변수값에 따라 데이터를 나누어 각각에 대한 그래프를 그려볼 수도 있다. <code>ggplot2</code>에서는 이러한 방식으로 그래프를 그리는 것을 측면(facets)으로 나누어 그래프를 그린다고 한다.</p>
<div id="facet_wrap로-일차원-측면-그래프-그리기" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> <code>facet_wrap()</code>로 일차원 측면 그래프 그리기<a href="ch-visualization.html#facet_wrap로-일차원-측면-그래프-그리기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>다음은 <code>facet_wrap()</code> 함수의 사용법을 보여준다. <code>~</code> 은 R에서 수식을 표현할 때 사용되는데, <code>facet_wrap()</code> 함수는 수식을 인수로 입력받는다. <code>facet_wrap()</code> 함수는 <code>~</code> 우변에 기술된 변수를 측면(facets)으로 하여 데이터를 나누어 그래프를 그린다. 이 때 측면(facets)으로 사용되는 변수는 범주형 데이터이어야 한다. <code>facet_wrap()</code>은 부분 그래프가 많아지면 줄바꿈하여 그래프를 표시한다. <code>ncol</code>이나 <code>ncol</code>을 설정하면 그래프의 행과 열의 수를 지정하여 줄바꿈 처리를 제어할 수 있다.</p>
<div class="sourceCode" id="cb1586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1586-1"><a href="ch-visualization.html#cb1586-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy), <span class="at">data=</span>mpg) <span class="sc">+</span></span>
<span id="cb1586-2"><a href="ch-visualization.html#cb1586-2" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>class, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-32-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>두 개 이상의 변수를 조합하여 측면을 만드려면 다음처럼 수식의 우변에 두 개의 변수를 <code>+</code>로 연결하여 기술하면 된다.</p>
<div class="sourceCode" id="cb1587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1587-1"><a href="ch-visualization.html#cb1587-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy), <span class="at">data=</span>mpg) <span class="sc">+</span></span>
<span id="cb1587-2"><a href="ch-visualization.html#cb1587-2" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>drv <span class="sc">+</span> year, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-33-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="facet_grid로-이차원-측면-그래프-그리기" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> <code>facet_grid()</code>로 이차원 측면 그래프 그리기<a href="ch-visualization.html#facet_grid로-이차원-측면-그래프-그리기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>원래 그래프를 두 변수의 측면에서 나누어 그리기를 하려면 <code>facet_grid()</code>를 사용하는 것이 좋다.
<code>facet_grid()</code>도 수식은 인수로 입력 받는데, 수식의 좌변과 우변에 데이터의 변수를 지정할 수 있다.
그러면 수식의 좌변에 기술된 변수를 그래프의 행으로, 우변에 기술된 변수를 그래프의 열로 하여 측면 그래프를 그린다.</p>
<div class="sourceCode" id="cb1588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1588-1"><a href="ch-visualization.html#cb1588-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy), <span class="at">data=</span>mpg) <span class="sc">+</span></span>
<span id="cb1588-2"><a href="ch-visualization.html#cb1588-2" tabindex="-1"></a>  <span class="fu">facet_grid</span>(drv<span class="sc">~</span>cyl)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-34-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>facet_wrap()</code> 함수와 마찬가지로 수식의 좌변과 우변에 <code>+</code>로 하나 이상의 변수를 지정할 수 있다.</p>
<div class="sourceCode" id="cb1589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1589-1"><a href="ch-visualization.html#cb1589-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy), <span class="at">data=</span>mpg) <span class="sc">+</span></span>
<span id="cb1589-2"><a href="ch-visualization.html#cb1589-2" tabindex="-1"></a>  <span class="fu">facet_grid</span>(drv<span class="sc">+</span>year<span class="sc">~</span>cyl)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-35-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="sec-layerAndGeom" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> 그래프 계층(layers)과 도형(geoms)<a href="ch-visualization.html#sec-layerAndGeom" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>ggplot2</code>의 장점은 필요에 따라 다양한 형식의 그래프를 쉽게 만들 수 있고, 만들 수 있는 형식도 무궁무진하다는데 있다. <code>ggplot2</code> 그래프의 계층적 구조와 데이터 열과 속성을 자유롭게 매핑할 수 있다는 점이 이러한 무궁무진한 그래프 형식을 만들어 내는 핵심 요소라 할 수 있다.</p>
<div id="geom-함수의-순서와-그래프-계층" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> geom 함수의 순서와 그래프 계층<a href="ch-visualization.html#geom-함수의-순서와-그래프-계층" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ggplot2</code>는 좌표평면 위에 여러 계층으로 그래프를 그려서 하나의 좌표평명에 나타냄으로써 복잡한 형식의 그래프를 만들어 낼 수 있다.</p>
<p>다음 두 그래프에서는 배기량과 고속도로 연비의 산점도와 추세선을 각각 그렸다.</p>
<div class="sourceCode" id="cb1590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1590-1"><a href="ch-visualization.html#cb1590-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy), <span class="at">data=</span>mpg)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-36-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1591-1"><a href="ch-visualization.html#cb1591-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy), <span class="at">data=</span>mpg)</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-36-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p>위의 두 그래프는 다음처럼 한 좌표평면 위에 겹쳐서 그릴 수 있다. <code>ggplot2</code>에서 서로 다른 geom 함수는 서로 다른 도형-앞의 예는 점과 추세선-을 그래프에 표시한다.</p>
<p><code>ggplot()</code> 함수가 여러 개의 geom 함수와 연결되면, 하나의 좌표평면에 각각의 geom() 함수의 결과를 층층이 그린다. 이 때, 명령문에 나타나는 순서에 따라 첫번째 나온 geom 함수의 도형이 가장 아래 계층에, 다음에 나오는 geom 함수의 도형이 차례로 그 윗 계층에 그려진다.</p>
<div class="sourceCode" id="cb1593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1593-1"><a href="ch-visualization.html#cb1593-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1593-2"><a href="ch-visualization.html#cb1593-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy), <span class="at">data=</span>mpg) <span class="sc">+</span></span>
<span id="cb1593-3"><a href="ch-visualization.html#cb1593-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy), <span class="at">data=</span>mpg)</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-37-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="ggplot-함수는-좌표축을-자동-조정한다." class="section level3 hasAnchor" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> <code>ggplot()</code> 함수는 좌표축을 자동 조정한다.<a href="ch-visualization.html#ggplot-함수는-좌표축을-자동-조정한다." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>만약 위의 그래프에 배기량과 도심연비의 산점도와 추세선을 겹쳐서 표시하려면 다음처럼 네 계층으로 이루어진 그래프를 그린다. <code>ggplot()</code> 함수가 데이터에 따라 좌표평면의 범위를 자동적으로 조정하는 것을 볼 수 있다.</p>
<div class="sourceCode" id="cb1595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1595-1"><a href="ch-visualization.html#cb1595-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1595-2"><a href="ch-visualization.html#cb1595-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy), <span class="at">data=</span>mpg) <span class="sc">+</span></span>
<span id="cb1595-3"><a href="ch-visualization.html#cb1595-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy), <span class="at">data=</span>mpg) <span class="sc">+</span> </span>
<span id="cb1595-4"><a href="ch-visualization.html#cb1595-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>cty), <span class="at">data=</span>mpg, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">shape=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1595-5"><a href="ch-visualization.html#cb1595-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>cty), <span class="at">data=</span>mpg, <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;
`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-38-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="여러-데이터를-사용하여-그래프-계층-만들기" class="section level3 hasAnchor" number="8.4.3">
<h3><span class="header-section-number">8.4.3</span> 여러 데이터를 사용하여 그래프 계층 만들기<a href="ch-visualization.html#여러-데이터를-사용하여-그래프-계층-만들기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>지금까지는 동일한 데이터(<code>data</code>)에 대해서 geom 함수들이 그래프를 그렸다. 그러나 사실 각 계층의 geom 함수가 이용할 <code>data</code>와 <code>mapping</code>을 독립적으로 설정할 수 있다.</p>
<p>다음 예는 <code>mpg</code> 데이터와 함께 R의 기본 패키지에서 제공하는 <code>iris</code> 데이터를 사용하여 그래프를 그려보자.</p>
<div class="sourceCode" id="cb1597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1597-1"><a href="ch-visualization.html#cb1597-1" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code></pre></div>
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
<p><code>iris</code> 데이터는 꽃받침의 길이(‘Sepal.Length’)와 폭(‘Sepal.Width’) 열을 가지고 있는데, 이 두 열의 산점도를 앞의 그래프에 겹쳐서 그려보았다.</p>
<div class="sourceCode" id="cb1599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1599-1"><a href="ch-visualization.html#cb1599-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1599-2"><a href="ch-visualization.html#cb1599-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy), <span class="at">data=</span>mpg) <span class="sc">+</span></span>
<span id="cb1599-3"><a href="ch-visualization.html#cb1599-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy), <span class="at">data=</span>mpg) <span class="sc">+</span> </span>
<span id="cb1599-4"><a href="ch-visualization.html#cb1599-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>cty), <span class="at">data=</span>mpg, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">shape=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1599-5"><a href="ch-visualization.html#cb1599-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>cty), <span class="at">data=</span>mpg, <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb1599-6"><a href="ch-visualization.html#cb1599-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Sepal.Width), <span class="at">data=</span>iris, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>) </span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;
`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-40-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>물론 이 그래프는 배기량과 꽃받침의 길이를 같은 x-축으로, 고속도로 연비와 꽃받침의 폭을 같은 y-축으로 그래프를 그렸으므로 억지스러운 측면이 있다. 단지 아주 별개의 데이터를 동시에 사용해서 하나의 그래프를 그릴 수 있다는 것을 보여주기 위해 그린 그래프일 뿐이다.</p>
<p>그러나 이 예에서 다음 사실을 확인할 수 있다.
첫째, 서로 다른 데이터를 사용해도 좌표평면이 자동으로 조정되어 모든 계층의 도형이 모두 적절히 표시된다.
둘째, 아울러 축의 이름은 첫 계층의 geom 함수의 x와 y로 대응된 변수가 자동으로 선택된다. 뒤에서 보겠지만 <code>labs()</code> 함수 등을 사용하면 축의 이름을 자유롭게 변경할 수 있다.</p>
</div>
<div id="다른-데이터-범위로-그래프-계층-만들기" class="section level3 hasAnchor" number="8.4.4">
<h3><span class="header-section-number">8.4.4</span> 다른 데이터 범위로 그래프 계층 만들기<a href="ch-visualization.html#다른-데이터-범위로-그래프-계층-만들기" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="ch-visualization.html#sec-aesMapping">8.2</a> 절을 시작할 때, 주경향에서 벗어난 점들을 더 큰 빨간색 점으로 표현한 그래프를 보았을 것이다. 이 그래프는 어떻게 그렸을까? 답은 <a href="ch-dataTransformation.html#sec-filter">7.4</a> 절에서 설명한 <code>filter()</code> 함수를 이용하여 예외적인 경향의 데이터만 뽑아낸 후, 이 데이터를 가지고 별도의 산점도를 그리는 것이다. 이 데이터를 이용해서 그린 산점도가 마지막 그래프 계층에 그려졌으므로 빨간 점이 원래의 검은 점 위에 그려진다.</p>
<div class="sourceCode" id="cb1601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1601-1"><a href="ch-visualization.html#cb1601-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1601-2"><a href="ch-visualization.html#cb1601-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(displ, hwy), <span class="at">data=</span>mpg) <span class="sc">+</span></span>
<span id="cb1601-3"><a href="ch-visualization.html#cb1601-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(displ, hwy), </span>
<span id="cb1601-4"><a href="ch-visualization.html#cb1601-4" tabindex="-1"></a>             <span class="at">data=</span><span class="fu">filter</span>(mpg, displ <span class="sc">&gt;</span> <span class="dv">5</span>, hwy <span class="sc">&gt;</span> <span class="dv">20</span>), </span>
<span id="cb1601-5"><a href="ch-visualization.html#cb1601-5" tabindex="-1"></a>             <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-41-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="subsec-commonDataMapping" class="section level3 hasAnchor" number="8.4.5">
<h3><span class="header-section-number">8.4.5</span> 공통 <code>data</code>와 <code>mapping</code>의 설정<a href="ch-visualization.html#subsec-commonDataMapping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>지금까지 geom 함수에 <code>data</code>와 <code>mapping</code> 인수를 각각 설정하였다. 그런데 공통된 <code>data</code>와 <code>mapping</code>을 사용하여 여러 층으로 그래프를 겹쳐 그리는 경우, 이러한 방식으로 <code>data</code>와 <code>mapping</code>을 일일이 설정하는 것은 귀찮을 뿐 아니라 명령문의 오류 가능성을 증가시키고 변경을 어렵게 만든다.</p>
<div id="ggplot-함수에-공통-데이터와-매핑-설정하기" class="section level4 hasAnchor" number="8.4.5.1">
<h4><span class="header-section-number">8.4.5.1</span> <code>ggplot()</code> 함수에 공통 데이터와 매핑 설정하기<a href="ch-visualization.html#ggplot-함수에-공통-데이터와-매핑-설정하기" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>ggplot()</code> 함수는 좌표평면을 생성하는 기능뿐 아니라, 그래프 계층에 공통된 <code>data</code>와 <code>mapping</code>을 설정하는 기능도 가지고 있다. 다음 예에서는 배기량과 고속도로 연비의 산점도와 추세선을 공통된 <code>data</code>와 <code>mapping</code> 설정을 이용하여 그렸다. 주의할 점은 <code>data</code>와 <code>mapping</code> 인수의 위치가 geom 함수와 <code>ggplot()</code> 함수에서 반대라는 것이다.</p>
<div class="sourceCode" id="cb1602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1602-1"><a href="ch-visualization.html#cb1602-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy)) <span class="sc">+</span></span>
<span id="cb1602-2"><a href="ch-visualization.html#cb1602-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-42-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>위와 같은 형식으로 명령문을 구성하면, 다음처럼 한 군데만 변경하면 고속도로 연비가 아니라 도심 연비로 산점도와 추세선을 그릴 수 있어 편리하다.</p>
<div class="sourceCode" id="cb1604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1604-1"><a href="ch-visualization.html#cb1604-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>cty)) <span class="sc">+</span></span>
<span id="cb1604-2"><a href="ch-visualization.html#cb1604-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-43-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom-함수에서-데이터와-매핑의-재정의" class="section level4 hasAnchor" number="8.4.5.2">
<h4><span class="header-section-number">8.4.5.2</span> geom 함수에서 데이터와 매핑의 재정의<a href="ch-visualization.html#geom-함수에서-데이터와-매핑의-재정의" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>ggplot()</code> 함수에 <code>data</code>와 <code>mapping</code> 인수가 정의되어 있어도, geom 함수에 이를 재지정할 수 있다. 이 경우 각 geom 함수에서 사용하는 <code>data</code>와 <code>mapping</code>은 다음 규칙에 의해 결정된다.</p>
<ul>
<li>geom 함수는 <code>ggplot()</code> 함수에 설정된 <code>data</code>와 <code>mapping</code>을 상속받아 그래프를 그린다.</li>
<li>만약 geom 함수에 <code>data</code> 인수가 설정되면 <code>ggplot()</code> 함수에 설정된 <code>data</code>는 무시된다.</li>
<li>만약 geom 함수에 <code>mapping</code> 인수가 설정되면 <code>ggplot()</code> 함수에 설정된 <code>mapping</code>에 geom 함수에 설정된 <code>mapping</code>이 추가된다. 만약 동일한 도형 속성에 대한 정의가 두 군데 나타나면 geom 함수의 설정이 사용된다.</li>
</ul>
<p>도형 속성과 데이터 열의 매핑이 어디에 나타나는지에 따라 그래프가 어떻게 변화하는지 살펴보자.
다음은 <code>ggplot()</code> 함수에서 <code>color</code> 속성을 <code>drv</code> 열에 매핑하여 점과 추세선 모두 <code>drv</code> 값에 따라 구분되는 다른 색으로 표현하였다.</p>
<div class="sourceCode" id="cb1606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1606-1"><a href="ch-visualization.html#cb1606-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy, <span class="at">color=</span>drv)) <span class="sc">+</span></span>
<span id="cb1606-2"><a href="ch-visualization.html#cb1606-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-44-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>만약 <code>color</code> 속성의 <code>drv</code> 열 매핑을 <code>geom_point()</code>로 옮기면 어떻게 될까?
다음 결과에서 보듯이 <code>color</code> 속성이 점에만 매핑되었으므로, 점만 <code>drv</code>에 따라 구분되어 색상이 표시되고, 추세선은 모든 데이터에 대하여 하나만 그려지는 것을 볼 수 있다.
왜냐하면 <code>geom_smooth()</code>는 <code>ggplot()</code>에 매핑된 <code>x</code>와 <code>y</code> 속성에 대한 매핑만 상속 받고, 다른 계층에 있는 매핑은 상속받지 않기 때문이다.</p>
<div class="sourceCode" id="cb1608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1608-1"><a href="ch-visualization.html#cb1608-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy)) <span class="sc">+</span></span>
<span id="cb1608-2"><a href="ch-visualization.html#cb1608-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">color=</span>drv)) <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-45-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>마찬가지로 <code>color</code> 속성의 <code>drv</code> 열 매핑을 <code>geom_smooth()</code>로 옮기면 추세선만 <code>drv</code>에 따라 구분된 색상으로 각각 표시되고, 점은 모든 데이터에 대하여 하나의 색상으로 구별없이 표현되는 것을 볼 수 있다.</p>
<div class="sourceCode" id="cb1610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1610-1"><a href="ch-visualization.html#cb1610-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy)) <span class="sc">+</span></span>
<span id="cb1610-2"><a href="ch-visualization.html#cb1610-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">color=</span>drv))</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-46-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>geom</code> 함수들은 <code>ggplot()</code> 함수에서 상속한 매핑에다 새로운 매핑을 추가할 수도 있다.
앞의 배기량과 고속도로 연비의 산점도와 추세선을 그린 그래프에서 추세선을 선 종류(<code>linttype</code>)가 구동 방식(<code>drv</code>)에 따라 다르게 표현하고 싶다. 그런데 산점도는 점이라는 도형으로 그래프를 그리므로 선 종류라는 속성을 가지고 있지 않다. 그리고 산점도도 점의 모양(<code>shape</code>)이 구동 방식에 따라 다르게 표현하고 싶다고 하자. 마찬가지로 추세선은 선이라는 도형으로 그래프를 그리므로 점의 모양이라는 속성을 가지고 있지 않다.<br />
이렇듯 여러 geom 함수를 연결하여 그래프를 그릴 때, 특정 geom 함수에만 해당하는 속성은 해당 geom 함수에서 속성과 데이터 열을 매핑하는 것이 좋다. geom 함수도 <code>ggplot()</code> 함수처럼 <code>aes()</code> 함수를 이용하여 그래프 속성과 데이터 열을 매핑하는데, 이 매핑이 geom 함수의 첫 번째 인수로 기술된다는 점만 다르다.</p>
<div class="sourceCode" id="cb1612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1612-1"><a href="ch-visualization.html#cb1612-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy, <span class="at">color=</span>drv)) <span class="sc">+</span> </span>
<span id="cb1612-2"><a href="ch-visualization.html#cb1612-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">shape=</span>drv)) <span class="sc">+</span> </span>
<span id="cb1612-3"><a href="ch-visualization.html#cb1612-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">linetype=</span>drv))</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-47-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>또한 <code>ggplot()</code> 함수에 이미 설정된 매핑 중 일부 매핑판을 <code>geom</code> 함수에서 다시 설정할 수도 있다.
다음은 배기량과 고속도로 연비의 산점도와 추세선에 배기량과 도심 연비의 추세선을 더한 그래프는 다음 명령으로도 그릴 수 있다.
두 번째로 나타나는 <code>geom_point()</code>와 <code>geom_smooth()</code>에서 <code>y</code>의 매핑을 <code>hwy</code>가 아니라 <code>cty</code>로 변경한 것을 볼 수 있다.</p>
<div class="sourceCode" id="cb1614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1614-1"><a href="ch-visualization.html#cb1614-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy)) <span class="sc">+</span> </span>
<span id="cb1614-2"><a href="ch-visualization.html#cb1614-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>() <span class="sc">+</span> </span>
<span id="cb1614-3"><a href="ch-visualization.html#cb1614-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>cty), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">shape=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb1614-4"><a href="ch-visualization.html#cb1614-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>cty), <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;
`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-48-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>아울러 <code>geom</code> 함수에서 <code>ggplot()</code> 함수에 정의된 데이터도 재설정할 수 있다. 다음 그래프에서는 추세선을 자동차 종류가 suv인 데이터에 대해서만 그려지도록 하였다. 이를 위해 <code>filter</code> 함수를 이용하여 <code>mpg</code> 데이터에서 <code>class</code> 변수가 suv인 관측치만 선택하여 새로운 데이터를 만들어 <code>geom_smooth()</code> 함수의 <code>data</code> 인수에 설정하였다.
그리고 <code>geom_smooth()</code>에 설정된 데이터는 해당 계층에서만 유효한 것이고, <code>geom_point()</code>는 <code>ggplot()</code> 함수에 정의된 전체 <code>mpg</code> 데이터를 사용하여 점을 그리고 있음을 확인하라.</p>
<div class="sourceCode" id="cb1616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1616-1"><a href="ch-visualization.html#cb1616-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy)) <span class="sc">+</span> </span>
<span id="cb1616-2"><a href="ch-visualization.html#cb1616-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>class)) <span class="sc">+</span> </span>
<span id="cb1616-3"><a href="ch-visualization.html#cb1616-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data=</span><span class="fu">filter</span>(mpg, class<span class="sc">==</span><span class="st">&quot;suv&quot;</span>))</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-49-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="ggplot과-geom-함수에서-대표-인수의-이름을-생략하기" class="section level4 hasAnchor" number="8.4.5.3">
<h4><span class="header-section-number">8.4.5.3</span> <code>ggplot()</code>과 geom 함수에서 대표 인수의 이름을 생략하기<a href="ch-visualization.html#ggplot과-geom-함수에서-대표-인수의-이름을-생략하기" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>지금까지 공통 데이터와 매핑을 <code>ggplot()</code> 함수에 기술하여 명령문을 단순화하였다. 그런데 이 명령문들은 더 단순화할 수 있다.</p>
<p>R 함수에서 인수를 인수의 순서대로 입력하는 경우에는 인수의 이름을 굳이 표시하지 않아도 된다. <code>ggplot()</code> 함수의 처음 두 인수는 차례로 <code>data</code>와 <code>mapping</code>이고 모든 geom 함수의 처음 두 인수는 차레로 <code>mapping</code>과 <code>data</code>이다. 또한 <code>aes()</code> 함수의 처음 두 인수는 <code>x</code>와 <code>y</code>이다. 따라서 이 정보를 사용하면 위 명령어는 다음처럼 단순해 진다. 주의할 점은 마지막 점과 추세선 geom 함수의 <code>aes()</code> 함수에서는 <code>y</code>만 나오므로 인수 이름을 사용하였다.</p>
<div class="sourceCode" id="cb1618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1618-1"><a href="ch-visualization.html#cb1618-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span> </span>
<span id="cb1618-2"><a href="ch-visualization.html#cb1618-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>() <span class="sc">+</span> </span>
<span id="cb1618-3"><a href="ch-visualization.html#cb1618-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>cty), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">shape=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1618-4"><a href="ch-visualization.html#cb1618-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y=</span>cty), <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="sec-commonProblems" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> ggplot 명령문을 입력할 때 자주 발생하는 문제들<a href="ch-visualization.html#sec-commonProblems" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>ggplot은 매우 강력한 기능을 가지고 있지만 Excel 등의 GUI 프로그램에만 익숙한 사람은 문자 기반 명령어를 입력하는 것에 어려움을 느낄 수 있다. 컴퓨터는 사람만큼의 유연성을 발휘하지 못하므로 컴퓨터는 자신이 실행해야 할 명령문의 문법에 매우 까다롭게 반응한다. ggplot 명령어 입력시 흔히 발생하는 문제들은 다음과 같다.</p>
<ul>
<li>R 명령문은 대소문자를 구분한다. 따라서 <code>Color</code>와 <code>color</code>는 ggplot에서 서로 다른 인수로 인식되어 오류가 발생한다.</li>
<li>ggplot 명령문의 키워드의 철자가 틀리면 다른 키워드로 간주하기 때문에 오류가 발생할 수 있다. 이를 방지하려면 키워드의 일부만 입력한 후 <code>Tab</code> 키를 눌러 자동완성 기능을 사용하여 입력하는 것을 권장한다.</li>
<li>R 명령문이 조금 길어지면 가장 흔하게 발생하는 실수가 <code>( )</code>와 <code>"  "</code>을 짝을 맞추어 제대로 입력하지 못하는 것이다. <code>ggplot2</code>의 명령문도 많은 함수를 사용하다 보니 이를 주의하여야 한다. R 콘솔은 명령이 계속 입력 중이라고 생각하여 <code>&gt;</code>가 아니라 <code>+</code>를 콘솔의 프롬프트로 표시한다. 이 경우 가장 간단한 해결책은 <code>Esc</code> 키를 눌러 명령 입력에서 빠져나와 다시 명령문을 입력하는 것이다.</li>
<li><code>ggplot2</code>의 명령문을 입력할 때 여러 함수를 합쳐서 실행하기 위하여 <code>+</code> 연산자를 이용한다.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a> <code>ggplot2</code>의 명령문이 길어지면 명령문을 여러 줄로 쓰는 것이 필요한데, 보통 <code>+</code>로 연결되는 곳에서 줄바꿈하는 것이 읽기에 좋다. 이 때 주의할 점이, 줄바꿈을 <code>+</code> 앞이 아니라 뒤에서 해야 한다는 것이다. <code>+</code> 앞에서 하면 R은 명령문의 입력이 완성된 것으로 간주하기 때문이다.</li>
</ul>
<p>다음은 산점도와 추세선을 한 그래프에 그린 예이다.</p>
<div class="sourceCode" id="cb1619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1619-1"><a href="ch-visualization.html#cb1619-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy, <span class="at">color=</span>drv)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-51-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그런데 위의 명령어는 길기 때문에 스크립트 파일을 작성할 때 보기에 불편하다. 이러한 경우에 위의 명령은 다음처럼 세 줄로 나누어 기술될 수 있다. 세 함수를 연결하는 <code>+</code> 위치가 어디에 있는지 살펴보라. (다음 예에서 왼쪽의 <code>&gt;</code> 프롬프트 아래 있는 <code>+</code>는 R 콘솔에서 명령문이 계속되고 있음을 나타내는 표시이다. 이 표시와 사용자가 입력한 <code>+</code>를 혼동하면 안 된다.)</p>
<div class="sourceCode" id="cb1621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1621-1"><a href="ch-visualization.html#cb1621-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy, <span class="at">color=</span>drv)) <span class="sc">+</span> </span>
<span id="cb1621-2"><a href="ch-visualization.html#cb1621-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb1621-3"><a href="ch-visualization.html#cb1621-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code></pre></div>
<p>만약 다음처럼 <code>+</code> 위치가 잘못되면 오류가 발생한다. 왜 이런 결과가 나왔고 오류 메시지의 의미는 무엇일까? <strong>R</strong>은 <strong>Enter</strong>로 명령문을 구분한다. 그러므로 첫번째 줄은 <code>+</code>가 없으므로 완벽한 명령문이기 입력된 것으로 간주하고 실행이되어 좌표평면만 그린 것이다. 그러고 나서 두번째 줄을 새로운 명령문으로 실행을 한다. 그런데 갑자기 명령문이 <code>+</code>로 시작하니 <strong>R</strong>은 명령문에 오류가 있다고 판단한다. 왜냐하면 <code>+</code> 연산은 왼편과 오른편에 더할 요소가 있어야 하는데, 왼편의 요소가 기술되지 않았기 때문이다.</p>
<div class="sourceCode" id="cb1622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1622-1"><a href="ch-visualization.html#cb1622-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy, <span class="at">color=</span>drv))  </span>
<span id="cb1622-2"><a href="ch-visualization.html#cb1622-2" tabindex="-1"></a>  <span class="sc">+</span> <span class="fu">geom_point</span>()  </span></code></pre></div>
<pre><code>Error:
! Cannot use `+` with a single argument.
ℹ Did you accidentally put `+` on a new line?</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-53-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="sec-ggplotStat" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> 통계 변환<a href="ch-visualization.html#sec-ggplotStat" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="subsec-statCategorical" class="section level3 hasAnchor" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> 범주형 변수의 통계 요약<a href="ch-visualization.html#subsec-statCategorical" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ggplot2</code> 패키지의 <code>diamonds</code>는 약 54,000개의 다이아몬드에 대한 다음 정보를 측정한 데이터이다.</p>
<ul>
<li><code>caret</code>: 다이아 몬드 무게</li>
<li><code>cut</code>: 가공의 품질. Fair, Good, Very Good, Premium, Ideal</li>
<li><code>color</code>: 색상. D(최상)에서 F(최하)까지</li>
<li><code>clarity</code>: 투명도. I1(최하), SI2, SI1, VS2, VS1, VVS2, VVS1, IF(최상)</li>
<li><code>x</code>, <code>y</code>, <code>z</code>: 길이, 폭, 깊이</li>
<li><code>depth</code>: 깊이 비율 = <code>z / mean(x, y)</code></li>
<li><code>table</code>: 최대폭 대비 윗면의 폭의 길이 비율</li>
</ul>
<div class="sourceCode" id="cb1624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1624-1"><a href="ch-visualization.html#cb1624-1" tabindex="-1"></a>diamonds</span></code></pre></div>
<pre><code># A tibble: 53,940 × 10
   carat cut       color clarity depth table price     x     y     z
   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  0.23 Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43
 2  0.21 Premium   E     SI1      59.8    61   326  3.89  3.84  2.31
 3  0.23 Good      E     VS1      56.9    65   327  4.05  4.07  2.31
 4  0.29 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63
 5  0.31 Good      J     SI2      63.3    58   335  4.34  4.35  2.75
 6  0.24 Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48
 7  0.24 Very Good I     VVS1     62.3    57   336  3.95  3.98  2.47
 8  0.26 Very Good H     SI1      61.9    55   337  4.07  4.11  2.53
 9  0.22 Fair      E     VS2      65.1    61   337  3.87  3.78  2.49
10  0.23 Very Good H     VS1      59.4    61   338  4     4.05  2.39
# ℹ 53,930 more rows</code></pre>
<p>다이아몬드의 가공의 품질(<code>cut</code>) 수준에 따른 빈도를 시각화해 보자. 현재 <code>cut</code>의 수준별 빈도수에 대한 데이터가 없기 때문에 먼저 이 데이터를 구하기 위한 통계적 변환을 수행해야 한다. 이를 위해 뒤에 설명할 <code>dplyr</code> 패키지의 <code>summarize()</code> 함수를 이용하였다.</p>
<div class="sourceCode" id="cb1626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1626-1"><a href="ch-visualization.html#cb1626-1" tabindex="-1"></a>cut_table <span class="ot">&lt;-</span> diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb1626-2"><a href="ch-visualization.html#cb1626-2" tabindex="-1"></a>  <span class="fu">group_by</span>(cut) <span class="sc">%&gt;%</span></span>
<span id="cb1626-3"><a href="ch-visualization.html#cb1626-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>())</span>
<span id="cb1626-4"><a href="ch-visualization.html#cb1626-4" tabindex="-1"></a>cut_table</span></code></pre></div>
<pre><code># A tibble: 5 × 2
  cut           n
  &lt;ord&gt;     &lt;int&gt;
1 Fair       1610
2 Good       4906
3 Very Good 12082
4 Premium   13791
5 Ideal     21551</code></pre>
<p>그리고 <code>geom_col()</code> 함수를 이용하여 막대 그래프를 그린다. <code>geom_col()</code> 함수는 막대라는 도형을 그리는 geom 함수로 <code>x</code> 값의 위치에 <code>y</code>에 매핑된 값을 높이로 가지는 막대를 그린다.</p>
<div class="sourceCode" id="cb1628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1628-1"><a href="ch-visualization.html#cb1628-1" tabindex="-1"></a><span class="fu">ggplot</span>(cut_table) <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>cut, <span class="at">y=</span>n))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-56-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그런데 geom 함수의 <code>stat</code> 인수를 이용하면 원래 데이터를 통계 요약하여 그래프를 그리는 과정을 사용자의 개입없이 쉽게 수행할 수 있다.</p>
<div class="sourceCode" id="cb1629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1629-1"><a href="ch-visualization.html#cb1629-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>cut), <span class="at">stat=</span><span class="st">&quot;count&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-57-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그림 <a href="ch-visualization.html#fig:stat-bar">8.2</a>는 <code>geom_bar()</code> 함수에서 <code>stat</code> 인수가 어떻게 작동하는지를 보여준다. <code>geom_bar()</code> 함수는 <code>stat</code> 인수에 <code>"count"</code>가 설정되면 <code>stat_count()</code> 함수를 사용하여 원래 데이터를 통계 요약한다. <code>stat_count()</code>는 <code>x</code>에 맵핑된 열을 수준(level; 구분되는 값) 별로 절대적 빈도와 상대적 빈도를 계산하여 <code>count</code>와 <code>prop</code>라는 열을 가지는 요약 데이터를 만든다.
그리고 이 요약 데이터를 이용하여 x-축에 원래 변수의 수준을, y-축에 <code>count</code> 변수를 맵핑하여 막대 그래프를 그린다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:stat-bar"></span>
<img src="img/visualization-stat-bar.png" alt="stat의 작동 방식 (출처: R for Data Science)" width="90%" />
<p class="caption">
Figure 8.2: stat의 작동 방식 (출처: R for Data Science)
</p>
</div>
<p>사실 <code>geom_bar()</code> 함수의 디폴트 <code>stat</code>는 <code>"count"</code>이기 때문에, <code>stat</code>를 생략하여도 같은 결과를 얻을 수 있다.</p>
<div class="sourceCode" id="cb1630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1630-1"><a href="ch-visualization.html#cb1630-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>color))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-58-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>stat_count()</code>가 요약한 데이터에서 절대 빈도수 count가 아니라 상대 빈도수 prop을 사용하여 그래프를 그리려면 <code>y=after_stat(prop)</code>을 <code>mapping</code>에 추가하여야 한다. <code>stat</code>가 생성한 요약 데이터의 열을 지정할 때는 <code>after_stat(요약변수)</code> 형식으로 지정을 한다. 그래야 원래 데이터가 아니라 요약 데이터에서 해당 열을 찾아 매핑을 한다. 상대 빈도는 <code>group</code> 속성에 따라 계산을 하는데, 전체 데이터를 대상으로 상대 빈도를 구하기 위해 모든 데이터가 동일한 그룹이 되도록 <code>group=1</code>로 설정을 하였다.<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a></p>
<div class="sourceCode" id="cb1631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1631-1"><a href="ch-visualization.html#cb1631-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(clarity, <span class="fu">after_stat</span>(prop), <span class="at">group=</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-59-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="subsec-statNumerical" class="section level3 hasAnchor" number="8.6.2">
<h3><span class="header-section-number">8.6.2</span> 수치형 변수의 통계 요약<a href="ch-visualization.html#subsec-statNumerical" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>carat</code> 같은 연속형 변수에 <code>geom_bar()</code>를 적용하면 구별되는 모든 수치에 대해 빈도를 계산하여 막대를 그린다. 그러나 연속형 변수는 구별되는 값이 매우 많으므로 이렇게 만들어진 그래프로 데이터의 경향을 파악하긴 어렵다.</p>
<div class="sourceCode" id="cb1632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1632-1"><a href="ch-visualization.html#cb1632-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(carat))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-60-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div id="stat_bin을-이용한-히스토그램" class="section level4 hasAnchor" number="8.6.2.1">
<h4><span class="header-section-number">8.6.2.1</span> <code>stat_bin()</code>을 이용한 히스토그램<a href="ch-visualization.html#stat_bin을-이용한-히스토그램" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>연속형 변수는 구분되는 값이 아니라 일정한 구간 별로 빈도를 계산하여 막대 그래프를 그리는 것이 더 적절하다. (이러한 그래프를 히스토그램이라고 한다.) <code>stat</code> 인수에 <code>stat_bin()</code>을 사용하면 <code>x</code>에 맵핑된 연속형 변수의 값을 구간으로 나누어 이러한 작업을 한다.</p>
<div class="sourceCode" id="cb1633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1633-1"><a href="ch-visualization.html#cb1633-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(carat), <span class="at">stat=</span><span class="st">&quot;bin&quot;</span>)</span></code></pre></div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-61-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_histogram" class="section level4 hasAnchor" number="8.6.2.2">
<h4><span class="header-section-number">8.6.2.2</span> <code>geom_histogram()</code><a href="ch-visualization.html#geom_histogram" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>사실 <code>stat_bin()</code>을 디폴트 <code>stat</code>로 사용하는 geom 함수가 있다. <code>geom_histogram()</code>이 그 함수이다. <code>geom_histogram()</code>를 이용하면 다음처럼 연속형 변수에 대한 히스토그램을 그릴 수 있다.</p>
<div class="sourceCode" id="cb1635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1635-1"><a href="ch-visualization.html#cb1635-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(carat))</span></code></pre></div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-62-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그리고 <code>bins</code> 또는 <code>binwidth</code> 인수를 사용하면 구간의 수 또는 구간의 길이를 직접 지정하여 히스토그램을 그릴 수 있다.</p>
<div class="sourceCode" id="cb1637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1637-1"><a href="ch-visualization.html#cb1637-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(table), <span class="at">bins=</span><span class="dv">50</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-63-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1638-1"><a href="ch-visualization.html#cb1638-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(price), <span class="at">binwidth=</span><span class="dv">500</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-63-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>stat_bin()</code>은 구간 별 절대 빈도수(count)뿐 아니라 구간의 밀도(density)와 빈도수와 밀도의 최대 값이 1이 되도록 규모를 변환한 ncount와 ndensity 변수도 생성한다. 그러므로 필요에 따라 이 값을 이용하여 히스토그램을 그림 수 있다.</p>
<div class="sourceCode" id="cb1639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1639-1"><a href="ch-visualization.html#cb1639-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span><span class="fu">after_stat</span>(density)))</span></code></pre></div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-64-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1641-1"><a href="ch-visualization.html#cb1641-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>y, <span class="at">y=</span><span class="fu">after_stat</span>(ncount)))</span></code></pre></div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-64-2.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1643-1"><a href="ch-visualization.html#cb1643-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>z, <span class="at">y=</span><span class="fu">after_stat</span>(ndensity)))</span></code></pre></div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-64-3.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_boxplot" class="section level4 hasAnchor" number="8.6.2.3">
<h4><span class="header-section-number">8.6.2.3</span> <code>geom_boxplot()</code><a href="ch-visualization.html#geom_boxplot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>geom_boxplot()</code> 함수는 수치 변수를 4분위수와 이상치로 요약하여 그래프를 그려준다.
다음은 다이아몬드의 중량(carat) 변수에 대한 4분위수와 이상치를 상자 그래프로 표시한 예이다.</p>
<div class="sourceCode" id="cb1645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1645-1"><a href="ch-visualization.html#cb1645-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> carat))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-65-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>상자 그래프에 대한 해석은 다음처럼 한다.</p>
<ul>
<li>상자의 상단의 3분위수를 표현한다.</li>
<li>상자의 하단은 1분위수를 표현한다.</li>
<li>상자의 가운데 선분은 중위수(2분위수)를 표현한다.</li>
<li>상자의 상단과 하단의 길이를 inter-quartile range라고 하고 IQR이라고 표현한다.</li>
<li>일반적으로 3분위 수에서 1.5 IQR보다 큰 수치나, 1분위수에서 1.5 IQR보다 작은 수치는 이상치(outliers)라고 판단한다.</li>
<li>상자의 하단과 상단에 나타나는 선분은 1.5 IQR 내의 최소치와 최대치를 나타낸다.</li>
<li>상자의 상하단에서 1.5 IQR 바깥에 있는 데이터는 이상치로 보고 점으로 표시한다.</li>
</ul>
<p>상자 그래프는 위와 같이 세로축을 기준으로 그리기도 하지만 다음처럼 가로축을 기준으로 표시하기도 한다.
가로축으로 그래프를 표시하려면 수치 변수를 <code>y</code>가 아니라 <code>x</code>에 매핑을 하여야 한다.</p>
<div class="sourceCode" id="cb1646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1646-1"><a href="ch-visualization.html#cb1646-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carat))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-66-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>상자 그래프는 앞의 예처럼 한 수치형 변수를 요약할 때는 잘 사용되지 않는다.
왜냐하면 히스토그램이 수치형 변수를 더 자세히 요약할 수 있기 때문이다.
상자 그래프는 주로 다음 절에서 보듯이 범주형 변수와 수치형 변수의 관계를 탐색할 때 주로 이용한다.</p>
</div>
</div>
<div id="subsec-statNumericalPerCategory" class="section level3 hasAnchor" number="8.6.3">
<h3><span class="header-section-number">8.6.3</span> 수치형 변수의 범주별 통계요약<a href="ch-visualization.html#subsec-statNumericalPerCategory" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>다이아몬드의 가격이 가공 품질에 따라 어떤 범위로 움지이는지 살펴보자. 이 때 유용한 geom 함수가 <code>geom_boxplot()</code>이다. <code>geom_boxplot()</code> 함수는 상자그림으로 수치 데이터를 표현한다. 이 함수는 <code>stat</code>로 <code>stat_boxplot()</code>을 디폴트로 사용한다. <code>stat_boxplot()</code>은 <code>x</code>에 매핑된 열의 수준 별로 <code>y</code>에 매핑된 데이터를 모아서 상자그림에 필요한 통계량을 계산한다.</p>
<div class="sourceCode" id="cb1647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1647-1"><a href="ch-visualization.html#cb1647-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(cut, price))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-67-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1648-1"><a href="ch-visualization.html#cb1648-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(cut, carat), <span class="at">notch=</span>T)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-68-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>이 외에도 <code>stat_summary()</code>를 이용하면 연속형 변수 데이터를 범주별로 나누어 함수를 적용한 결과를 출력할 수 있다.
<code>fun</code>, <code>fun.max</code>, <code>fun.min</code>에 각각 수치 변수를 요약할 함수를 지정하면 해당 함수로 수치의 값을 <code>y</code>, <code>ymax</code>, <code>ymin</code>이라는 변수로 요약한다.
다음은 가공품질(<code>cut</code>) 별로 다이아몬드의 깊이(<code>depth</code>)의 중위수, 최대값, 최소값을 점과 구간으로 나타낸 결과이다.</p>
<div class="sourceCode" id="cb1649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1649-1"><a href="ch-visualization.html#cb1649-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(cut, depth)) <span class="sc">+</span></span>
<span id="cb1649-2"><a href="ch-visualization.html#cb1649-2" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>median, <span class="at">fun.max=</span>max, <span class="at">fun.min=</span>min)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-69-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>위의 예에서 geom 함수를 사용하지 않고 stat 함수를 <code>ggplot()</code> 함수에 연결한 것을 볼 수 있다.
geom 함수마다 디폴트 stat 함수가 정의되어 있는 것처럼, stat 함수에는 디폴트 geom 함수가 정의되어 있다.
그래서 위와 같이 stat 함수가 그래프의 계층(layer)로 사용되면 stat 함수의 디폴트 geom 함수에 의해 요약 결과가 그려진다.
<code>stat_summary()</code> 함수의 디폴트 geom 함수는 <code>geom_pointrange()</code>로 점과 구간으로 그래프를 표현해 준다.</p>
</div>
</div>
<div id="sec-position" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> 위치 조정<a href="ch-visualization.html#sec-position" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>geom_bar()</code>는 막대의 색상과 관련된 <code>fill</code>, <code>color</code>, <code>alpha</code>라는 속성이 있는데, 각각 막대의 색, 막대 테두리 색, 막대 색의 투명도를 조정한다.<br />
다음은 <code>mpg</code> 데이터에서 <code>class</code>별 빈도를 막대 그래프로 그린 예이다. <code>fill</code> 속성 인수에 남색을 부여하였다.</p>
<div class="sourceCode" id="cb1650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1650-1"><a href="ch-visualization.html#cb1650-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(class), <span class="at">fill=</span><span class="st">&quot;dark blue&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-70-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1651-1"><a href="ch-visualization.html#cb1651-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(class), <span class="at">color=</span><span class="st">&quot;dark blue&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-70-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p>앞의 막대 그래프는 <code>class</code>별로 데이터의 빈도를 구해 한 색상으로 막대를 그렸다. 이번에는 <code>class</code> 별 빈도에 대한 막대 그래프를 그리는데 <code>fill</code> 속성에 <code>drv</code> 열을 매핑하여 어떤 차이가 있는지 살펴보자.</p>
<div class="sourceCode" id="cb1652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1652-1"><a href="ch-visualization.html#cb1652-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(class, <span class="at">fill=</span>drv))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-71-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>fill</code> 속성에 <code>drv</code>라는 이산 변수가 매핑되자, 동일한 <code>class</code> 값이지만 서로 다른 <code>drv</code>의 값을 가지는 경우를 구분하여 다른 색상으로 막대를 그렸다. 그리고 동일한 <code>class</code>인데 <code>drv</code> 값이 다른 막대를 동일한 가록축에 층(stack)으로 쌓아 올렸다. 예를 들어 subcompact 클래스의 경우 <code>drv</code>가 4, f, r이 모두 있으므로 총 3개의 막대가 그려져야 한다. 그러나 이 3 막대는 모두 동일한 <code>x</code> 값을 가지므로 서로 겹치는 것을 피하기 위하여 쌓아 표현하였다.</p>
<p>geom 함수에서 <code>position</code> 인수는 동일한 위치의 도형 객체를 어떻게 조화롭게 표현할지를 결정한다. 앞의 예에서는 <code>geom_bar()</code>의 <code>position</code> 인수의 디폴트 값은 <code>"stack"</code>이므로 같은 <code>x</code> 위치의 막대를 쌓아 표현하였다. 만약 같은 위치의 막대를 쌓아 표현하지 않고 옆으로 나란히 세워 표현하고 싶으면 <code>postion</code> 인수를 <code>"dodge"</code>로 설정한다.</p>
<div class="sourceCode" id="cb1653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1653-1"><a href="ch-visualization.html#cb1653-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(class, <span class="at">fill=</span>drv), <span class="at">position=</span><span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-72-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>geom 함수에 따라 취할 수 있는 <code>position</code> 인수의 값은 다를 수 있다. <code>geom_bar()</code>의 경우 <code>"stack"</code>, <code>"dodge"</code>, <code>"fill"</code> 그리고 <code>"identity"</code> 값을 가질 수 있다. (여기서 <code>"fill"</code>과 <code>"identity"</code>는 막대의 <code>fill</code> 속성이나 통계 요약 함수인 <code>stat_identity()</code>와는 상관없는 동일 위치의 도형의 위치 조정에 관한 값이다.) <code>position</code>인수가 <code>"fill"</code>이면, 막대의 전체 길이가 1이 되도록 조정하여 동일한 <code>x</code>의 값에서의 상대적 비율을 파악할 수 있게 해준다.</p>
<div class="sourceCode" id="cb1654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1654-1"><a href="ch-visualization.html#cb1654-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(class, <span class="at">fill=</span>drv), <span class="at">position=</span><span class="st">&quot;fill&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-73-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>position</code>이 <code>"identity"</code>로 설정되면 동일한 위치에 겹쳐지는 geom 객체에 아무 조정도 하지 않는다. 앞과 동일한 예에서 <code>position="identity"</code>로 설정해 보자. 모두 동일한 자리에 그려지므로 아래 그려진 막대가 가려지므로 막대의 윤곽선만 그리고 투명도를 조정하여 겹쳐진 막대를 확인할 수 있도록 하자.</p>
<div class="sourceCode" id="cb1655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1655-1"><a href="ch-visualization.html#cb1655-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(class, <span class="at">col=</span>drv), <span class="at">position=</span><span class="st">&quot;identity&quot;</span>, <span class="at">alpha=</span><span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-74-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>사실 <code>"identity"</code> position은 막대 그래프에서 별로 유용한 조정 방법이 아니다. 그러나 <code>geom_frepoly()</code> 등 빈도를 선으로 표현하는 geom 객체에는 매우 유용하다.</p>
<div class="sourceCode" id="cb1656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1656-1"><a href="ch-visualization.html#cb1656-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> <span class="fu">geom_freqpoly</span>(<span class="fu">aes</span>(hwy, <span class="at">color=</span>drv), <span class="at">position=</span><span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-75-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>사실 <code>geom_freqpoly()</code>는 <code>"identity"</code>를 <code>position</code>의 디폴트 값으로 가지므로 다음 명령어도 동일한 결과를 준다.</p>
<div class="sourceCode" id="cb1658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1658-1"><a href="ch-visualization.html#cb1658-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> <span class="fu">geom_freqpoly</span>(<span class="fu">aes</span>(hwy, <span class="at">color=</span>drv))</span></code></pre></div>
</div>
<div id="sec-typeofgraph" class="section level2 hasAnchor" number="8.8">
<h2><span class="header-section-number">8.8</span> ggplot2 그래프의 종류<a href="ch-visualization.html#sec-typeofgraph" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>이 절에서는 <code>ggplot2</code>에서 그릴 수 있는 대표적인 그래프 종류를 하나씩 살펴본다.
그래프는 결국 데이터를 시각적 객체로 변환한 것이므로 그래프의 종류는 그래프가 어떤 geom 객체를 이용하는가에 따라 나눠 볼 수 있다. Table <a href="ch-visualization.html#tab:geomTypes">8.1</a>에는 그래프에서 자주 사용되는 geom 함수들이 제시되어 있다.</p>
<table>
<caption><span id="tab:geomTypes">Table 8.1: </span>geom 함수</caption>
<colgroup>
<col width="21%" />
<col width="21%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">함수</th>
<th align="left">도형</th>
<th align="left">도형의.속성</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">geom_bar()</td>
<td align="left">Bar chart</td>
<td align="left">color, fill, alpha</td>
</tr>
<tr class="even">
<td align="left">geom_boxplot()</td>
<td align="left">Box plot</td>
<td align="left">color, fill, alpha, notch, width</td>
</tr>
<tr class="odd">
<td align="left">geom_density()</td>
<td align="left">Density plot</td>
<td align="left">color, fill, alpha, linetype</td>
</tr>
<tr class="even">
<td align="left">geom_histogram()</td>
<td align="left">Histogram</td>
<td align="left">color, fill, alpha, linetype, binwidth</td>
</tr>
<tr class="odd">
<td align="left">geom_hline()</td>
<td align="left">Horizontal lines</td>
<td align="left">color, alpha, linetype, size</td>
</tr>
<tr class="even">
<td align="left">geom_jitter()</td>
<td align="left">Jittered points</td>
<td align="left">color, size, alpha, shape</td>
</tr>
<tr class="odd">
<td align="left">geom_line()</td>
<td align="left">Line graph</td>
<td align="left">color, alpha, linetype, size</td>
</tr>
<tr class="even">
<td align="left">geom_point()</td>
<td align="left">Scatterplot</td>
<td align="left">color, alpha, shape, size</td>
</tr>
<tr class="odd">
<td align="left">geom_rug()</td>
<td align="left">Rug plot</td>
<td align="left">color, side</td>
</tr>
<tr class="even">
<td align="left">geom_smooth()</td>
<td align="left">Fitted line</td>
<td align="left">method, formula, color, fill, linetype, size</td>
</tr>
<tr class="odd">
<td align="left">geom_text()</td>
<td align="left">Text annotations</td>
<td align="left">많은 옵션이 있으므로 도움말 참조</td>
</tr>
<tr class="even">
<td align="left">geom_violin()</td>
<td align="left">Violin plot</td>
<td align="left">color, fill, alpha, linetype</td>
</tr>
<tr class="odd">
<td align="left">geom_vline()</td>
<td align="left">Vertical lines</td>
<td align="left">color, alpha, linetype, size</td>
</tr>
</tbody>
</table>
<p>한편 그래프는 데이터에 대한 시각적 표현이므로 표현하려는 데이터의 형식에 따라 그래프를 구분해 볼 수도 있다. 데이터의 각 변수는 크게 수치형 변수와 범주형 변수로 나누어 볼 수 있다. 앞으로 우리는 그래프에서 표현하려는 데이터가 무엇인지에 따라 다음처럼 그래프를 분류하여 살펴보고자 한다.</p>
<ul>
<li>하나의 범주형 변수를 나타내는 그래프</li>
<li>하나의 수치형 변수를 나타내는 그래프</li>
<li>두 개의 범주형 변수의 관계를 나타내는 그래프</li>
<li>하나의 범주형 변수와 하나의 수치형 변수의 관계를 나타내는 그래프</li>
<li>두 개의 수치형 변수의 관계를 나타내는 그래프</li>
<li>세 개 이상의 변수의 관계를 나타내는 그래프</li>
</ul>
<p>이를 각각 살펴보기에 앞서 그래프에 단순한 선과 도형을 표현하는 기본 함수를 먼저 살펴보자.</p>
<div id="basic-graph" class="section level3 hasAnchor" number="8.8.1">
<h3><span class="header-section-number">8.8.1</span> 직선을 그리는 그래픽 함수<a href="ch-visualization.html#basic-graph" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>직선을 그리는 그래픽 함수를 살펴보기 위해 <code>mpg</code> 데이터에 대한 도심 연비와 고속도로 연비를 나타내는 산점도 그래프를 고려해 보자.</p>
<div class="sourceCode" id="cb1659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1659-1"><a href="ch-visualization.html#cb1659-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb1659-2"><a href="ch-visualization.html#cb1659-2" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-77-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>앞의 산점도에 도심 연비와 고속도로 연비의 평균을 나타내보자.
<code>ggplot2</code>에서는 수평선은 <code>geom_hline()</code>, 수직선은 <code>geom_vline()</code> 함수로 그릴 수 있다. 다음은 <code>geom_vline()</code>으로 도심연비의 평균선을 나타낸 예이다. <code>xintercept</code>는 수직선이 지나가는 x축의 절편의 값이다. <code>linetype</code> 인수는 선의 종류를 결정하는 인수인데, 1은 실선, 2는 파선을 나타낸다. 이 외에도 다양한 linetype을 설정할 수 있으니 자세한 내용은 <code>??linetype</code>을 이용하여 관련된 설명을 확인해 보길 바란다.</p>
<div class="sourceCode" id="cb1660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1660-1"><a href="ch-visualization.html#cb1660-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(mpg<span class="sc">$</span>cty), <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-78-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>다음으로 <code>geom_hline()</code>으로 고속도로 연비의 평균선을 그려보자. <code>yintercept</code>는 수평선이 지나가는 y 절편의 값이다.</p>
<div class="sourceCode" id="cb1661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1661-1"><a href="ch-visualization.html#cb1661-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(mpg<span class="sc">$</span>cty), <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb1661-2"><a href="ch-visualization.html#cb1661-2" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(mpg<span class="sc">$</span>hwy), <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb1661-3"><a href="ch-visualization.html#cb1661-3" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-79-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>이렇게 그려 놓고 보면, 도심 및 고속도로 연비가 모두 평균 이상인 그룹과 어느 하나만 평균 이상인 그룹, 둘 다 평균 이하인 그룹을 구분해 볼 수 있다.
도심 연비와 고속도로 연비의 비율을 알기 위하여 기울기가 1이고 절편이 0인 직선을 그려보자. <code>geom_abline()</code>은 절편이 <code>a</code>, 기울기가 <code>b</code>인 직선을 그래프에 그려준다. 결과에서 확인하듯이 모든 차들이 도심 연비에 비해 고속도로 연비가 좋음을 확인할 수 있다. 아울러 두 연비의 비를 알아볼 수 있도록 scale 함수를 이용하여 좌표축의 범위를 동일하게 설정하였다(<a href="ch-visualization.html#modification">8.9</a> 장 참조).</p>
<div class="sourceCode" id="cb1662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1662-1"><a href="ch-visualization.html#cb1662-1" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1662-2"><a href="ch-visualization.html#cb1662-2" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">45</span>)) <span class="sc">+</span></span>
<span id="cb1662-3"><a href="ch-visualization.html#cb1662-3" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">45</span>))</span></code></pre></div>
<pre><code>Warning in geom_abline(a = 0, b = 1, linetype = 3, color = &quot;blue&quot;): Ignoring
unknown parameters: `a` and `b`</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-80-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="onecategory" class="section level3 hasAnchor" number="8.8.2">
<h3><span class="header-section-number">8.8.2</span> 한 범주형 변수의 그래프<a href="ch-visualization.html#onecategory" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>우리는 이미 <code>geom_bar()</code>를 이용하여 하나의 범주형 변수의 빈도에 대한 막대 그래프를 그리는 법을 보았다. 여기서는 범주형 변수의 막대 그래프 표현에 대하여 좀 더 자세히 살펴본다.</p>
<p>먼저 범주형 변수가 무엇인지 살펴보자. 범주형 변수란 변수의 값이 몇 개의 정해진 범주로 한정되는 변수라고 할 수 있다. 예를 들어 gender라는 변수가 어떤 수업의 수강생의 성별 정보를 표현하고 있다면, 남자 또는 여자라는 두 가지 범주에 의해서 데이터가 표현될 것이다. <code>mpg</code>의 <code>class</code> 열은 연비가 조사된 자동차의 종류를 compact, midsize, suv, 2seater, minivan, pickup, subcompact라는 7 가지 값으로 표현하는 변수이다. 다음 명령을 실행해 데이터를 확인해 보자.</p>
<div class="sourceCode" id="cb1664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1664-1"><a href="ch-visualization.html#cb1664-1" tabindex="-1"></a><span class="fu">unique</span>(mpg<span class="sc">$</span>class)</span></code></pre></div>
<pre><code>[1] &quot;compact&quot;    &quot;midsize&quot;    &quot;suv&quot;        &quot;2seater&quot;    &quot;minivan&quot;   
[6] &quot;pickup&quot;     &quot;subcompact&quot;</code></pre>
<p><code>ggplot2</code>에서는 <code>geom_bar()</code> 함수를 이용하여 다음 형식 중 하나를 선택하여 막대 그래프를 그린다.</p>
<div class="sourceCode" id="cb1666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1666-1"><a href="ch-visualization.html#cb1666-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>데이터, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>범주형.변수.이름)) <span class="sc">+</span> <span class="fu">geom_bar</span>()</span>
<span id="cb1666-2"><a href="ch-visualization.html#cb1666-2" tabindex="-1"></a><span class="fu">ggplot</span>(데이터, <span class="fu">aes</span>(범주형.변수.이름)) <span class="sc">+</span> <span class="fu">geom_bar</span>()</span>
<span id="cb1666-3"><a href="ch-visualization.html#cb1666-3" tabindex="-1"></a><span class="fu">ggplot</span>(데이터) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(범주형.변수.이름))</span>
<span id="cb1666-4"><a href="ch-visualization.html#cb1666-4" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(범주형.변수.이름), 데이터)</span></code></pre></div>
<p><code>geom_bar()</code> 함수는 x에 매핑된 변수를 범주형 변수로 간주하고, 해당 변수에서 구분되는 값을 범주로 뽑아낸 후, 범주 별로 빈도수 계산한 후 이를 막대 그래프로 그려준다. (빈도수를 계산하는 과정은 사실 <code>stat_count()</code> 함수가 수행한다.) <code>class</code> 변수는 7가지의 구분되는 값으로 구성되어 있다. 문자열로 표현되는 범주는 알파벳 순으로 정렬되어 그래프의 가록축에 표현된다. 다음은 <code>mpg</code> 데이터의 <code>class</code> 열에 대한 막대 그래프를 그린 예이다.</p>
<div class="sourceCode" id="cb1667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1667-1"><a href="ch-visualization.html#cb1667-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class)) <span class="sc">+</span> <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-83-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>mpg</code> 데이터이 <code>cyl</code> 열은 수치로 표현되어 있지만 사실은 실린더 개수이므로 4, 6, 8, 5라는 4 개의 범주를 가진 범주형 변수이다. <code>geom_bar()</code>를 이용하면 이 범주로 이용하여 빈도수를 계산한 후 막대 그래프로 그릴 수 있다. 범주가 수치인 경우에는 수의 크기로 정렬하여 가로축을 생성한다.</p>
<div class="sourceCode" id="cb1668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1668-1"><a href="ch-visualization.html#cb1668-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cyl)) <span class="sc">+</span> <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-84-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>수치형 변수도 구별되는 값의 개수가 많지 않으면 <code>geom_bar()</code>를 이용할 수 있다. 예를 들어 도심 연비를 나타내는 <code>cty</code>는 다음처럼 총 21 개의 값을 가지고 있다. 그러므로 <code>geom_bar()</code>를 이용하여 각 값 별로 데이터의 빈도를 세어 막대 그래프를 그릴 수 있다.</p>
<div class="sourceCode" id="cb1669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1669-1"><a href="ch-visualization.html#cb1669-1" tabindex="-1"></a><span class="fu">unique</span>(mpg<span class="sc">$</span>cty)</span></code></pre></div>
<pre><code> [1] 18 21 20 16 19 15 17 14 11 13 12 22  9 28 24 25 23 26 33 35 29</code></pre>
<div class="sourceCode" id="cb1671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1671-1"><a href="ch-visualization.html#cb1671-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty)) <span class="sc">+</span> <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-85-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>이 경우는 <code>cty</code> 변수에 구별되는 값이 많지 않아 막대 그래프로 표현해도 크게 어색하지 않다. 그러나 대부분의 수치형 변수는 연속적인 값을 가지므로 이런 식으로 막대 그래프를 그리기가 어렵다. 따라서 수치형 변수의 경우 <code>geom_histogram()</code>을 이용하여 구간으로 나누어 구간별 빈도에 대한 막대 그래프를 그리는 것이 좋다.</p>
<p>막대 그래프를 그릴 때 그래프의 x-축에 표현되는 범주의 순서를 바꾸고 싶을 때가 있다. 예를 들어 다음같은 <code>drv</code>에 대한 막대 그래프를 f, r, 4 순으로 막대를 표현하고 싶다고 하자.</p>
<div class="sourceCode" id="cb1672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1672-1"><a href="ch-visualization.html#cb1672-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(drv)) <span class="sc">+</span> <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-86-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>geom_bar()</code>는 기본적으로 문자는 알파벳 순으로 숫자는 숫자의 크기 순으로 정렬하여 막대를 그리므로 이를 바꾸고 싶으면 요인(<code>factor</code>)로 바꾸어야 한다. 요인의 경우는 수준(<code>levels</code>)에 정의된 순서에 따라 막대 그래프를 그리기 때문이다. 마지막의 <code>labs()</code> 함수는 x-축의 레이블을 <code>"drv"</code>로 표시하기 위해 사용되었다. 이 함구가 없으면 x-축 레이블이 어떻게 변하는지 확인해 보라.</p>
<div class="sourceCode" id="cb1673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1673-1"><a href="ch-visualization.html#cb1673-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(drv, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;r&quot;</span>, <span class="st">&quot;4&quot;</span>)))) <span class="sc">+</span> </span>
<span id="cb1673-2"><a href="ch-visualization.html#cb1673-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb1673-3"><a href="ch-visualization.html#cb1673-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;drv&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-87-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>다음 예는 <code>mpg</code>의 <code>class</code> 데이터에서 빈도가 작은 범주부터 차례로 막대가 나오도록 하는 예이다. <code>reorder()</code> 함수는 첫 번째 인수인 factor를 두 번째 인수로 주어진 벡터를 factor의 범주 별로 나누어 세 번째 인수로 주어진 함수를 적용한 결과의 순서로 factor의 levels를 정렬한다.
아래 예에서 세 번째 인수로 <code>length()</code> 함수가 설정되었으므로, <code>class</code> 열의 범주 별 개수에 의해 <code>class</code> 열의 범주가 정렬된다.</p>
<div class="sourceCode" id="cb1674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1674-1"><a href="ch-visualization.html#cb1674-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb1674-2"><a href="ch-visualization.html#cb1674-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="fu">reorder</span>(class, class, length))) <span class="sc">+</span></span>
<span id="cb1674-3"><a href="ch-visualization.html#cb1674-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;class&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-88-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>위의 예에서 <code>reorder()</code> 함수는 결과가 작은 범주부터 큰 범주로 levels를 정렬하는 것을 알 수 있다.
만약 결과가 큰 범주부터 작은 범주로 levels를 정렬하려면 어떻게 해야 할까?
다음처럼 <code>length()</code> 함수의 결과를 음수로 바꾸면 가장 빈도가 큰 범주가 가장 작은 수가 되므로 원하는 결과를 얻을 수 있다.</p>
<div class="sourceCode" id="cb1675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1675-1"><a href="ch-visualization.html#cb1675-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb1675-2"><a href="ch-visualization.html#cb1675-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="fu">reorder</span>(class, class, <span class="cf">function</span>(x) <span class="sc">-</span><span class="fu">length</span>(x))))<span class="sc">+</span></span>
<span id="cb1675-3"><a href="ch-visualization.html#cb1675-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;class&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-89-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>reorder()</code> 함수로 범주의 순서를 결정할 때, 다른 변수의 값으로도 정렬이 가능하다.
다음은 class의 범주를 hwy의 평균이 작은 것에서 큰 것 순으로 정렬한 예이다.</p>
<div class="sourceCode" id="cb1676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1676-1"><a href="ch-visualization.html#cb1676-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb1676-2"><a href="ch-visualization.html#cb1676-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="fu">reorder</span>(class, hwy, mean))) <span class="sc">+</span></span>
<span id="cb1676-3"><a href="ch-visualization.html#cb1676-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;class&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-90-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>정말로 hwy 평균에 따라 class의 범주가 정렬되었는지 확인해 보자.
다음 결과에서 정말 그렇게 되었음을 확인할 수 있다.</p>
<div class="sourceCode" id="cb1677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1677-1"><a href="ch-visualization.html#cb1677-1" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span></span>
<span id="cb1677-2"><a href="ch-visualization.html#cb1677-2" tabindex="-1"></a>  <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb1677-3"><a href="ch-visualization.html#cb1677-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">hwy_mean =</span> <span class="fu">mean</span>(hwy)) <span class="sc">%&gt;%</span></span>
<span id="cb1677-4"><a href="ch-visualization.html#cb1677-4" tabindex="-1"></a>  <span class="fu">arrange</span>(hwy_mean)</span></code></pre></div>
<pre><code># A tibble: 7 × 2
  class      hwy_mean
  &lt;chr&gt;         &lt;dbl&gt;
1 pickup         16.9
2 suv            18.1
3 minivan        22.4
4 2seater        24.8
5 midsize        27.3
6 subcompact     28.1
7 compact        28.3</code></pre>
<p>범주형 데이터를 막대로 그릴 때, 각 범주별 데이터를 다른 변수로 좀 더 세분화하여 살펴보고 싶을 때가 있다. 이 경우 흔히 한 범주를 표현하는 막대를 다른 변수의 범주에 따라 색상으로 구분하여 세분화하여 표현한다. <code>geom_bar()</code>의 <code>fill</code> aesthetics에 범주형 변수를 매핑하면 각 범주별로 색상을 달리 표시한다. 다음은 <code>class</code>별 막대 그래프를 년도(<code>year</code>)로 더 세분화하여 표현한 경우이다. <code>mpg</code> 데이터의 <code>year</code> 변수는 수치형 데이터로 표현되어 있으므로 <code>factor()</code> 함수를 이용하여 이산형으로 변형하여 <code>fill</code> aesthetics에 매핑하였다.</p>
<div class="sourceCode" id="cb1679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1679-1"><a href="ch-visualization.html#cb1679-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, <span class="at">fill=</span><span class="fu">factor</span>(year))) <span class="sc">+</span> <span class="fu">geom_bar</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">&quot;year&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-92-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>만약 각 <code>class</code> 값에 따라 1999년도와 2008년도의 상대적 빈도를 비교해 보고 싶다면, 다음처럼 <code>position</code> 인수를 <code>"fill"</code>로 설정하면 된다. <code>postion</code> 인수에 대한 자세한 설명은 <a href="ch-visualization.html#sec-position">8.7</a> 절을 참조하기 바란다. 이렇게 하면 막대 그래프를 이용하여 두 범주형 변수의 관계를 살펴볼 수 있다.</p>
<div class="sourceCode" id="cb1680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1680-1"><a href="ch-visualization.html#cb1680-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, <span class="at">fill=</span><span class="fu">factor</span>(year))) <span class="sc">+</span></span>
<span id="cb1680-2"><a href="ch-visualization.html#cb1680-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;fill&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">&quot;year&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-93-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="onenumeric" class="section level3 hasAnchor" number="8.8.3">
<h3><span class="header-section-number">8.8.3</span> 한 수치형 변수의 그래프<a href="ch-visualization.html#onenumeric" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>한 수치형 변수에서 일차적으로 확인해야 할 내용은 그 변수의 분포이다. 분포를 확인하는 가장 단순한 방법은 수치를 구간으로 나누어 빈도를 나타내는 히스토그램을 그려보는 것이다. <code>geom_histogram()</code> 함수는 x로 매핑된 변수를 구간으로 나누어 빈도수를 구한 후 - 이 작업은 <code>stat_bin()</code> 함수가 수행한다 - 막대 형태의 히스토그램 그래프를 그려준다. 다음은 고속도로 연비 데이터를 구간 크기를 2로하여 나눈 후 히스토그램을 그린 예이다. 구간의 길이는 <code>bandwidth</code> 인수를 이용하여 설정한다.</p>
<div class="sourceCode" id="cb1681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1681-1"><a href="ch-visualization.html#cb1681-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-94-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>히그토그램은 구간의 크기에 따라 다른 모양의 그래프가 나오므로, 구간의 크기를 변화시키면서 분포를 가장 적절하게 나타내는 구간크기를 찾아 보아야 한다.</p>
<div class="sourceCode" id="cb1682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1682-1"><a href="ch-visualization.html#cb1682-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-95-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그런데 앞의 고속도로 연비 히스토그램을 보면 두 개의 봉우리를 가지는 분포를 보인다. 이처럼 분포에 여러 봉우리가 나타날 때는 서로 다른 특성을 가지는 데이터 그룹이 하나로 섞여 있기 때문인 경우가 많다. 예를 들어 성인의 키의 분포를 그리면 남자와 여자라는 서로 다른 특성의 그룹 때문에 쌍봉 형태의 그래프가 나온다.</p>
<p>고속도로 연비가 쌍봉 형태를 보이는 것이 자동차의 구동 방식 때문인지를 한번 살펴보자. 다음처럼 <code>fill</code> aesthetics에 <code>drv</code> 변수를 매핑하면 빈도를 <code>drv</code> 요소로 분해하여 살펴볼 수 있다. 결과에서 보듯이 왼쪽 봉우리는 주로 4륜 구동(4) 차가, 오른쪽 봉우리는 전륜 구동(f) 차가 분포의 대부분을 차지하고 있음을 볼 수 있다.</p>
<div class="sourceCode" id="cb1683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1683-1"><a href="ch-visualization.html#cb1683-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy, <span class="at">fill=</span>drv)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-96-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그런데 앞의 예에서 <code>geom_histogram()</code>은 디폴트 <code>position</code>이 <code>"stack"</code>으로 설정되어 있어서 쌓인 형태로 막대 그래프가 나타났다. 쌓인 그래프 형태로 표현되다 보니 각 구동방식에 따른 고속도로 연비의 분포를 파악하기는 어렵다. 이런 경우 <code>geom_freqpoly()</code>를 이용하여 각 범주별 분포를 분리하여 그려보면 좋다. <code>geom_freqpoly()</code>는 <code>geom_histogram()</code>과 마찬가지로 연속형 수치 변수를 구간으로 나누어 빈도를 보여주는데, 막대가 아니라 선을 이용하여 빈도를 보여준다.</p>
<div class="sourceCode" id="cb1684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1684-1"><a href="ch-visualization.html#cb1684-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy)) <span class="sc">+</span> <span class="fu">geom_freqpoly</span>(<span class="at">binwidth=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-97-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>따라서 여러 그룹으로 나누어 구간으로 나누어 빈도를 보일 때도 서로 구분이 용이하다. <code>geom_freqpoly()</code>의 디폴트 <code>position</code>은 <code>"identity"</code>이다. 아래 그래프를 보면 4륜 구동과 전륜 구동의 분포에 의해 전체 분포에서 쌍봉이 나타났음을 뚜렷하게 확인할 수 있다.</p>
<div class="sourceCode" id="cb1685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1685-1"><a href="ch-visualization.html#cb1685-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy, <span class="at">color=</span>drv)) <span class="sc">+</span> <span class="fu">geom_freqpoly</span>(<span class="at">binwidth=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-98-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그런데 위의 그래프는 구동방식에 따라 구간별 고속도로 연비의 절대빈도를 보여준다. 따라서 데이터 수가 적은 후륜 구동(r)의 경우 매우 작게 표시되어 상대적인 분포를 확인하기 어렵다. 이런 경우 전체 면적을 1로하는 상대빈도를 이용하여 그래프를 나타내는 것이 더 좋다. <code>geom_histogram()</code>과 <code>geom_freqpoly()</code> 모두 디필트 <code>stat</code>로 <code>stat_bin()</code>을 이용하는데, 이 함수는 x로 매핑된 변수를 구간으로 나누어 구간별 빈도(<code>count</code>), 밀도(<code>density</code>), 최대값이 1로 조정된 빈도(<code>ncount</code>), 최대값이 1로 조정된 밀도(<code>ndensity</code>) 등을 산출한다. 특별한 지시가 없으면 <code>stat_bin()</code>은 <code>count</code> 변수를 y로 매핑하여 준다. 그리고 이 y 값을 <code>geom_histogram()</code>에서는 막대의 높이로, <code>geom_freqpoly()</code>에서는 선의 y 값으로 이용한다. <code>count</code> 대신 <code>density</code>를 이용하여 그래프를 그리고 싶으면, <code>aes()</code> 매핑에서 <code>y</code>가 <code>density</code>가 되도록 매핑하면 된다. 단, 이 때 stat 함수에 의해 계산된 변수는 <code>after_stat(요약변수)</code> 형태로 표시한다.</p>
<div class="sourceCode" id="cb1686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1686-1"><a href="ch-visualization.html#cb1686-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy, <span class="fu">after_stat</span>(density), <span class="at">color=</span>drv)) <span class="sc">+</span> <span class="fu">geom_freqpoly</span>(<span class="at">binwidth=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-99-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>4륜 구동 차는 15에서 20사이의 구간에서 가장 많은 빈도를 보였고, 후륜구동 차는 15에서 30 사이로 펴져서 분포를 하고 있고, 전륜구동 차는 25에서 30에서 가장 많은 빈도를 보이는 것을 확인할 수 있다.</p>
<p>그런데 <code>geom_histogram()</code>과 <code>geom_freqpoly()</code>는 구간을 어떻게 나누는가에 따라 그래프의 형태가 크게 달라지는 단점이 있다. <code>geom_density()</code> 함수는 수치형 변수의 값을 사용하여 확률밀도를 추정한 후 추정된 확률밀도에 대한 그래프를 보여주므로 구간 나누기의 임의성을 피할 수 있다.</p>
<div class="sourceCode" id="cb1687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1687-1"><a href="ch-visualization.html#cb1687-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy)) <span class="sc">+</span> <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-100-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1688-1"><a href="ch-visualization.html#cb1688-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy, <span class="at">color=</span>drv)) <span class="sc">+</span> <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-100-2.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="twocategories" class="section level3 hasAnchor" number="8.8.4">
<h3><span class="header-section-number">8.8.4</span> 두 범주형 변수의 그래프<a href="ch-visualization.html#twocategories" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>두 범주형 변수의 관계는 <a href="ch-visualization.html#onecategory">8.8.2</a> 절에서 본 것과 같이 한 범주형 변수의 막대 그래프에 <code>fill</code> aesthetics에 다른 범주형 변수를 매핑하여 두 변수의 관계를 살펴보거나, 아니면 다음처럼 facet을 이용하여 한 범주형 변수의 값을 고정시켜 놓고 다른 범주형 변수에 대해 막대 그래프를 그려 두 변수의 관계를 살펴본다.</p>
<div class="sourceCode" id="cb1689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1689-1"><a href="ch-visualization.html#cb1689-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class)) <span class="sc">+</span> <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb1689-2"><a href="ch-visualization.html#cb1689-2" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>drv)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-101-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>이 경우 절대빈도로 막대 그래프가 표시되어 facet에 지정된 변수의 값에 따라 분포가 다른지 비교하기가 어렵다. <code>geom_bar()</code>의 디폴트 stat인 <code>stat_count()</code>는 x로 매핑된 변수에 대해 범주별로 빈도수를 세어 <code>count</code> 변수에 저장하고, 상대빈도를 <code>prop</code> 변수에 저장한다. <code>stat_count()</code>는 디폴트로 <code>count</code> 변수의 값을 <code>y</code>에 매핑한다. 만약 <code>prop</code> 변수를 막대 그래프의 <code>y</code>의 값으로 매핑하려면, <code>y</code>를 <code>after_stat(prop)</code>으로 지정한다. (<a href="ch-visualization.html#onenumeric">8.8.3</a> 절에서 설명한 바와 같이 stat 함수가 생성한 변수의 지정은 <code>after_stat(요약변수)</code>의 형식을 사용한다.) 그러면 각 범주별 상대 빈도가 나타나 facet으로 지정된 변수의 값에 따라 상대적 비율이 달라지는지 비교해 볼 수 있다.</p>
<div class="sourceCode" id="cb1690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1690-1"><a href="ch-visualization.html#cb1690-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, <span class="fu">after_stat</span>(prop), <span class="at">group=</span>drv)) <span class="sc">+</span> <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb1690-2"><a href="ch-visualization.html#cb1690-2" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>drv)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-102-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>두 범주형 변수의 관계를 살펴보는 또 다른 방법은 두 범주형 변수의 데이터를 산점도로 표시해 보는 것이다.</p>
<div class="sourceCode" id="cb1691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1691-1"><a href="ch-visualization.html#cb1691-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, drv)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-103-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그런데, 문제는 같은 값을 갖는 데이터가 너무 많으므로 여러 데이터가 한 점으로 표시되어 빈도를 알 수 없다. 이 경우 geom_jitter()를 사용하면 각 점의 x, y 좌표에 임의의 변동을 주어 겹치는 점이 다른 곳에 표시되도록 할 수 있다. <code>width</code>와 <code>height</code> 인수는 임의의 변동의 최대값이다. 범주형 변수의 범주 사이의 길이는 1이므로 다음의 예는 붙어 있는 두 범주 사이의 거리의 약 <span class="math inline">\(\pm\)</span> 20% 정도의 변동이 일어나도록 조정한 예라 할 수 있다.</p>
<div class="sourceCode" id="cb1692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1692-1"><a href="ch-visualization.html#cb1692-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, drv)) <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.2</span>, <span class="at">height=</span><span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-104-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그러나 산저도의 점의 수가 많으면 두 변수의 관계를 명확하게 알기는 힘들다. 이 경우 <code>geom_count()</code>를 이용하면 빈도에 따라 더 큰 원이 그려지는 그래프를 그릴 수 있다.</p>
<div class="sourceCode" id="cb1693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1693-1"><a href="ch-visualization.html#cb1693-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, drv)) <span class="sc">+</span> <span class="fu">geom_count</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-105-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="category-numeric" class="section level3 hasAnchor" number="8.8.5">
<h3><span class="header-section-number">8.8.5</span> 범주형 변수와 수치형 변수의 그래프<a href="ch-visualization.html#category-numeric" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>범주형 변수와 수치형 변수의 관계를 살펴보는 가장 쉬운 방법은 범주형 변수에 따른 수치형 변수의 분포를 산점도로 나타내 보는 것이다. 다음은 클래스별 도심 연비의 산점도를 보여준다. 비슷한 데이터와 매핑으로 그래프를 여러번 그릴 것이므로 <code>ggplot2</code> 그래프를 변수에 할당하여 사용해 보자.</p>
<div class="sourceCode" id="cb1694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1694-1"><a href="ch-visualization.html#cb1694-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, cty))</span>
<span id="cb1694-2"><a href="ch-visualization.html#cb1694-2" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-106-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그런데 실제 데이터보다 점이 더 적게 찍힌 것을 볼 수 있다. 이는 동일한 지점에 여러 데이터가 표현되었기 때문이다.<code>geom_jitter()</code> 함수는 앞서 설명하였드시 동일한 지점의 점을 임의로 조금씩 변동시켜 점을 표시한다. <code>width</code>와 <code>height</code> 인수를 설정하면 임의의 변동의 폭과 높이의 범위를 설정할 수 있다. 다음은 폭을 <span class="math inline">\(\pm 0.2\)</span>로 제한한 경우이다. 이산시간 변수는 한 칸이 1로 계산되므로 총 공간의 40% 정도에 임의로 변동된 점이 놓이게 된다.</p>
<div class="sourceCode" id="cb1695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1695-1"><a href="ch-visualization.html#cb1695-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-107-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>geom_jitter()</code>로 범주별로 수치 변수의 대락적 분포를 확인할 수는 있으나 전체적인 분포를 요약하여 비교하긴 어렵다. <code>geom_boxplot()</code>를 이용하면 각 범주에서의 수치형 변수의 분포를 상자 그림으로 요약하여 보여준다. 상자의 상한은 3분위수, 상자의 하한은 1분위수, 상자 안의 가로선은 중위수를 나타낸다. 상자 밖의 위와 아래에 그려진 선은 상자 높이(IQR)의 1.5배 내의 데이터 중 최대값과 최소값을 보여준다. 그 범위 밖의 데이터는 이상치로 간주하여 별도의 점으로 나타낸다.</p>
<div class="sourceCode" id="cb1696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1696-1"><a href="ch-visualization.html#cb1696-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-108-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>앞의 그래프는 자동차 종류 별로 도심 연비의 중위수가 차이가 나는지를 살펴볼 수 있게 해준다. 그런데, 그래프에 나타난 중위수는 조사된 데이터, 즉 표본의 중위수이므로 모집단의 중위수와 다를 수 있다. 모집단 중위수에 대한 신뢰구간을 같이 표시하고 싶으면 <code>notch=TRUE</code>로 하여 상자그림을 그린다. 만약 두 종류의 차의 V자 모양의 notch가 서로 겹치지 않는다면 두 종류의 차의 도심 연비의 중위수가 통계적으로 유의미하게 다르다는 것을 의미한다. 데이터가 적은 클래스의 경우에 notch의 크기가 너무 커져서 상자 바깥까지 그려지는 경우도 있다. 이 경우 경고 메시지가 출력된다.</p>
<div class="sourceCode" id="cb1697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1697-1"><a href="ch-visualization.html#cb1697-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">notch =</span> T)</span></code></pre></div>
<pre><code>Notch went outside hinges
ℹ Do you want `notch = FALSE`?
Notch went outside hinges
ℹ Do you want `notch = FALSE`?
Notch went outside hinges
ℹ Do you want `notch = FALSE`?</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-109-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>상자 그래프 자주 같이 표시되는 정보가 수치 데이터의 평균에 대한 정보이다. <code>stat_summary()</code>를 이용하면 범주별 평균을 구할 수 있고, geom 함수로는 <code>geom_point()</code>를 설정하여 범주별 평균을 상자 그림 위에 점으로 덧붙일 수 있다.</p>
<div class="sourceCode" id="cb1699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1699-1"><a href="ch-visualization.html#cb1699-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">notch =</span> T) <span class="sc">+</span></span>
<span id="cb1699-2"><a href="ch-visualization.html#cb1699-2" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">shape=</span><span class="st">&quot;*&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>)</span></code></pre></div>
<pre><code>Notch went outside hinges
ℹ Do you want `notch = FALSE`?
Notch went outside hinges
ℹ Do you want `notch = FALSE`?
Notch went outside hinges
ℹ Do you want `notch = FALSE`?</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-110-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>상자 그래프는 수치형 데이터를 분위수와 이상치로 요약된 정보를 주는 장점이 있지만 실제 분포를 파악하기 어렵다. 바이올린 차트는 상자 그래프의 이러한 단점을 보완해 준다. 바이롤린 차트는 수치 변수의 확률밀도를 추정하여 확률밀도가 높은 곳은 폭이 넓게, 확률밀도가 낮은 곳은 폭이 좁게 그래프를 그려주는데, 이 모향이 바이올린 모양을 닯아서 바이올린 차트라 한다.</p>
<div class="sourceCode" id="cb1701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1701-1"><a href="ch-visualization.html#cb1701-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_violin</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-111-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그런데 바이올린 차트는 확률밀도를 계산할 때 확률밀도가 연속적이고 유한한 값을 가지는 함수라는 가정하에 각 지점에 작은 정규분포를 적합하여 이를 연결하여 확률밀도를 추정한다. 그런데 이런 가정이 적합하지 않을 때도 있으니 이 경우 바이올린 차트를 사용하지 않는 것이 좋다.<br />
다음은 바이올린 차트와 상자그림을 겹쳐 그린 그래프이다.</p>
<div class="sourceCode" id="cb1702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1702-1"><a href="ch-visualization.html#cb1702-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb1702-2"><a href="ch-visualization.html#cb1702-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha=</span><span class="fl">0.3</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-112-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="twonumeric" class="section level3 hasAnchor" number="8.8.6">
<h3><span class="header-section-number">8.8.6</span> 두 수치형 변수의 그래프<a href="ch-visualization.html#twonumeric" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>우리는 앞선 여러 예제에서 <code>geom_point()</code>를 이용하여 두 수치형 변수의 산점도와 <code>geom_smooth()</code>를 이용하여 평균 적합선을 그려보았다. 여기서는 다른 방식으로 두 수치형 변수의 관계를 그래프로 나나태 보자.</p>
<div id="geom_text" class="section level4 unnumbered hasAnchor">
<h4>geom_text()<a href="ch-visualization.html#geom_text" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>두 수치형 변수의 데이터를 나타낼 때, 점 대신 텍스트로 표현하고 싶을 때가 있다. 다음 예는 <code>geom_text()</code>로 midsize 차의 2008년도의 도심 및 고속도로 연비 데이터를 모델명으로 보여주는 그래프이다.</p>
<div class="sourceCode" id="cb1703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1703-1"><a href="ch-visualization.html#cb1703-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">filter</span>(mpg, class <span class="sc">==</span> <span class="st">&quot;midsize&quot;</span>, year <span class="sc">==</span> <span class="dv">2008</span>) </span>
<span id="cb1703-2"><a href="ch-visualization.html#cb1703-2" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>model))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-113-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>앞의 예는 동일한 데이터를 가지는 차의 이름이 겹쳐서 표현되어 구분이 어렵다. 이를 개선하기 위하여 글자의 크기(<code>size</code> 인수)를 줄이고 다음처럼 <code>position</code> 인수에 <code>position_jitter()</code> 함수를 이용하여 텍스트 위치에 임의적인 변동을 주어 같은 자리의 데이터가 겹치지 않도록 해 본다.</p>
<div class="sourceCode" id="cb1704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1704-1"><a href="ch-visualization.html#cb1704-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> </span>
<span id="cb1704-2"><a href="ch-visualization.html#cb1704-2" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>model), <span class="at">size=</span><span class="dv">3</span>, </span>
<span id="cb1704-3"><a href="ch-visualization.html#cb1704-3" tabindex="-1"></a>            <span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">width=</span><span class="fl">0.3</span>, <span class="at">height=</span><span class="fl">0.3</span>))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-114-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>텍스트를 겹치지 않게 만드는 또다른 방법은 <code>check_overlap=TRUE</code>로 설정하여 이미 한 자리에 텍스트가 놓이면 같은 위치에 텍스트가 더 이상 쓰이지 않도록 하는 것이다. 이 경우 뒤에 나타나는 동일한 위치의 데이터는 그래프에 표시되지 못할 것이다.</p>
<div class="sourceCode" id="cb1705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1705-1"><a href="ch-visualization.html#cb1705-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>model), <span class="at">check_overlap =</span> T)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-115-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>텍스트로 관측치의 위치를 표현하면, 텍스트의 길이가 가변적이라 관측치의 정확한 위치를 파악하기 어렵다. 따라서 관측치의 위치는 점으로 표현한 후, 점의 옆이나 위, 아래에 텍스트를 같이 표현하기도 한다. <code>geom_text()</code> 함수의 <code>nudge_x</code>와 <code>nudge_y</code>는 원래 관측치의 위치에서 정해진 크기만큼 표시할 텍스트의 위치를 이동시킨다. 다음은 텍스트를 점 위로 0.3 정도 이동시켜 표시한 예이다.</p>
<div class="sourceCode" id="cb1706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1706-1"><a href="ch-visualization.html#cb1706-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb1706-2"><a href="ch-visualization.html#cb1706-2" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>model), <span class="at">nudge_y=</span><span class="fl">0.3</span>, <span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-116-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>위의 경우에는 동일한 위치에 여러 텍스트가 겹치므로 <code>position_jitter()</code>를 이용하여 임의로 위치로 텍스트를 조정할 수도 있다. 참고로 <code>position_jitter()</code>와 <code>nudge_x</code>/<code>nudge_y</code>는 함께 사용될 수 없다.</p>
<div class="sourceCode" id="cb1707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1707-1"><a href="ch-visualization.html#cb1707-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> </span>
<span id="cb1707-2"><a href="ch-visualization.html#cb1707-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb1707-3"><a href="ch-visualization.html#cb1707-3" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>model),  <span class="at">size=</span><span class="dv">3</span>,</span>
<span id="cb1707-4"><a href="ch-visualization.html#cb1707-4" tabindex="-1"></a>            <span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">width=</span><span class="fl">0.3</span>, <span class="at">height=</span><span class="fl">0.3</span>))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-117-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_label" class="section level4 unnumbered hasAnchor">
<h4>geom_label()<a href="ch-visualization.html#geom_label" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>geom_label()</code>은 <code>geom_text()</code>와 거의 유사한데, 텍스트를 박스 안에 넣어 글자를 구별하기 좀 더 쉽도록 해 준다.</p>
<div class="sourceCode" id="cb1708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1708-1"><a href="ch-visualization.html#cb1708-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> </span>
<span id="cb1708-2"><a href="ch-visualization.html#cb1708-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb1708-3"><a href="ch-visualization.html#cb1708-3" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label=</span>model), <span class="at">nudge_y=</span><span class="fl">0.2</span>, <span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-118-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_bin2d" class="section level4 unnumbered hasAnchor">
<h4><code>geom_bin2d()</code><a href="ch-visualization.html#geom_bin2d" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>두 변수의 결합 분포를 확인하고 싶을 때는 geom_bin2d()를 이용하여 두 수치형 변수를 각각 구간으로 나눈 후, 각 셀별로 빈도수를 계산한다. 그리고 각 셀의 빈도에 따라 색상을 다르게 하여 그래프에 표시한다. <code>binwidth</code> 인수는 가로축과 세로축의 구간을 길이를 지정한다.</p>
<div class="sourceCode" id="cb1709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1709-1"><a href="ch-visualization.html#cb1709-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> <span class="fu">geom_bin2d</span>(<span class="at">binwidth=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-119-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="morethanthree" class="section level3 hasAnchor" number="8.8.7">
<h3><span class="header-section-number">8.8.7</span> 세 변수 이상의 그래프<a href="ch-visualization.html#morethanthree" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>3개 변수 이상의 관계를 파악하고자 할 때 조건부 그래프이다. 조건부 그래프는 관심의 대상인 한 변수의 분포 또는 두 변수의 관계가 다른 변수의 값이 변함에 따라 어떻게 변하는지를 보여준다. <code>ggplot2</code>에서는 facet을 사용하여 이를 수행한다.</p>
<p>다음은 구동 방식(<code>drv</code>)의 차이에 따라 배기량(<code>displ</code>)과 도심 연비(<code>cty</code>)의 관계가 어떻게 변하는지를 보여주는 그래프이다. 전륜 구동(f)의 차일수록 배기량이 커짐에 따라 도심 연비의 감쇄가 크게 나타남을 볼수 있다.</p>
<div class="sourceCode" id="cb1710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1710-1"><a href="ch-visualization.html#cb1710-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, cty)) <span class="sc">+</span> </span>
<span id="cb1710-2"><a href="ch-visualization.html#cb1710-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1710-3"><a href="ch-visualization.html#cb1710-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>drv)</span></code></pre></div>
<pre><code>`geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-120-1.png" width="80%" style="display: block; margin: auto;" />
위에서 사용된 <code>facet_wrap()</code> 함수는 그래프가 매우 많으면 그래프를 줄 바꾸기를 하여 배치를 한다.</p>
<div class="sourceCode" id="cb1712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1712-1"><a href="ch-visualization.html#cb1712-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, cty)) <span class="sc">+</span> </span>
<span id="cb1712-2"><a href="ch-visualization.html#cb1712-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1712-3"><a href="ch-visualization.html#cb1712-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>class)</span></code></pre></div>
<pre><code>`geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-121-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>3개 변수 이상의 관계를 파악할 때 조건부 그래프뿐 아니라, 산점도 상에서 색상 등의 다른 aethetics를 사용하여 제 3의 변수의 영향을 살펴볼 수도 있다. 다음은 구동 방식의 차이를 색상으로 구분하여 한 산점도에 나타낸 예이다.</p>
<div class="sourceCode" id="cb1714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1714-1"><a href="ch-visualization.html#cb1714-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, cty, <span class="at">col=</span>drv)) <span class="sc">+</span> </span>
<span id="cb1714-2"><a href="ch-visualization.html#cb1714-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) </span></code></pre></div>
<pre><code>`geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-122-1.png" width="70%" style="display: block; margin: auto;" />
색상 등의 aesthetics를 제 3의 변수에 매핑하여 그래프를 그리는 것은 한 그래프에 그래프가 모두 함께 표시되어 비교가 쉬운 장점이 있다. 그러나 제 3의 변수가 여러 값을 가지거나 제3, 4, 5의 변수들이 관심있는 두 변수에 영향을 미치는 것을 살펴보려면 너무 그래프가 복잡해서 파악이 어려운 단점이 있다. 다음은 구동방식뿐 아니라 조사 년도(<code>year</code>)가 배기량과 도심 연비의 관계에 어떤 영향을 미치는지 보기 위해 추가적으로 <code>year</code> 변수를 <code>linetype</code>에 매핑한 결과이다. 여러 그래프가 한 곳에 그려지다 보니 구분이 어려운 것을 볼 수 있다. 또한 연도별로 구동방식으로 나누어 비교를 하기도 어렵다.</p>
<div class="sourceCode" id="cb1716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1716-1"><a href="ch-visualization.html#cb1716-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, cty, <span class="at">col=</span>drv, <span class="at">linetype=</span><span class="fu">factor</span>(year))) <span class="sc">+</span> </span>
<span id="cb1716-2"><a href="ch-visualization.html#cb1716-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">linetype=</span><span class="st">&quot;year&quot;</span>)</span></code></pre></div>
<pre><code>`geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-123-1.png" width="70%" style="display: block; margin: auto;" />
facet을 사용하면 제3, 4 변수의 값에 따라 그래프 각각 그린 후 행과 열로 배치해 주므로 그래프를 좀 더 체계적으로 비교해 볼 수 있다. 다음은 <code>drv</code>와 <code>year</code>의 값에 따라 <code>displ</code>와 <code>cty</code>의 관계가 어떻게 변하는지는 facet을 이용하여 그래프를 그린 예이다. <code>facet_grid()</code>은 수식 표현을 사용하여 그래프 배열의 행과 열의 기준이 되는 변수를 지정한다.</p>
<div class="sourceCode" id="cb1718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1718-1"><a href="ch-visualization.html#cb1718-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, cty)) <span class="sc">+</span> </span>
<span id="cb1718-2"><a href="ch-visualization.html#cb1718-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1718-3"><a href="ch-visualization.html#cb1718-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(year<span class="sc">~</span>drv)</span></code></pre></div>
<pre><code>`geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-124-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><code>facet_wrap()</code>이 한 변수를 조건으로 하여 그래프를 그린다면 <code>facet_grid()</code>는 두 변수를 조건으로 그래프를 그려준다. 행이 될 변수를 수식의 왼편에 열이 될 변수를 수식의 오른편에 기술을 한다. 앞의 예에서는 조사 년도별 차이는 행으로, 구동 방식의 차이는 열로 구분되어 그래프를 표시하였다. 전륜 구동(f)의 차들의 연비 감쇄 현상이 더 가파른 것은 연도별로 차이가 없었지만, 1999년도에 비해 2008년도의 전륜구동(f)과 후륜구동(r)의 차들 중에 배기량이 큰 차들이 출시되었고 배기량에 따른 연비 감쇄 경향도 줄어들었음을 볼 수 있다.</p>
</div>
</div>
<div id="modification" class="section level2 hasAnchor" number="8.9">
<h2><span class="header-section-number">8.9</span> 그래프의 외양 바꾸기<a href="ch-visualization.html#modification" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>ggplot2</code>는 사용자가 데이터를 geom의 각 aesthetics 요소로 매핑하면 자동으로 가로축과 세로축의 스케일을 결정하고, 표시할 색상의 스케일도 결정하고, 축과 범례에 표시될 레이블도 결정하여 그래프를 그려준다. 이러한 <code>ggplot2</code>의 기능은 사용자가 그래프의 세부 사항이 아니라 그래프의 핵심적인 매핑과 형태에만 집중할 수 있게 해주므로 매우 편리하다. 그러나 가끔은 <code>ggplot2</code>가 생성한 그래프의 모양이 최종적으로 원하는 형태가 아닐 수 있다. 이러한 경우에 그래프의 세부적인 사항을 조정할 필요가 있다. 사실 발표용 그래프는 세심한 조정이 필요한 경우가 더 많다. 이 장에서는 <code>ggplot2</code>로 그래프를 그린 후 자주 조정하게 되는 요소를 어떻게 변경할 수 있는지를 살펴본다.</p>
<div id="axes" class="section level3 hasAnchor" number="8.9.1">
<h3><span class="header-section-number">8.9.1</span> 좌표축의 조정<a href="ch-visualization.html#axes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ggplot2</code>는 데이터가 <code>x</code>와 <code>y</code> aesthetics에 매핑되면, 이를 이용하여 가로축과 세로축의 축척(scale)를 생성한다. <code>x</code>와 <code>y</code>에 매핑된 변수가 수치형 변수이면 <code>scale_x_continous()</code>와 <code>scale_y_continous()</code>가, 범주형 변수이면 <code>scale_x_discrete()</code>와 <code>scale_y_discrete()</code>가 사용되어 가로축과 세로축의 축척을 생성한다.
좌표축의 축적을 위한 이러한 함수들은 매핑된 데이터의 값을 이용하여 다음 사항을 적절히 결정한다.</p>
<ul>
<li>name: 축의 이름</li>
<li>breaks: 축에 표시될 눈금의 위치</li>
<li>minor_breaks: 축에 표시될 세부 눈금의 위치</li>
<li>labels: 축 눈금에 씌여질 레이블</li>
<li>limits: 축의 상한과 하한</li>
<li>trans: 축에 별도의 변환을 적용할지 여부</li>
<li>position: 축의 그래프 상에서의 위치 등</li>
</ul>
<p><code>ggplot2</code>가 자동으로 설정한 이러한 요소가 원하는 것이 아니라면 직접 이를 조정해야 한다.</p>
<p>midwest 데이터는 미국 중서부의 각 카운티(county)의 인구통계 정보이다.</p>
<div class="sourceCode" id="cb1720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1720-1"><a href="ch-visualization.html#cb1720-1" tabindex="-1"></a>midwest</span></code></pre></div>
<pre><code># A tibble: 437 × 28
     PID county  state  area poptotal popdensity popwhite popblack popamerindian
   &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;    &lt;int&gt;      &lt;dbl&gt;    &lt;int&gt;    &lt;int&gt;         &lt;int&gt;
 1   561 ADAMS   IL    0.052    66090      1271.    63917     1702            98
 2   562 ALEXAN… IL    0.014    10626       759      7054     3496            19
 3   563 BOND    IL    0.022    14991       681.    14477      429            35
 4   564 BOONE   IL    0.017    30806      1812.    29344      127            46
 5   565 BROWN   IL    0.018     5836       324.     5264      547            14
 6   566 BUREAU  IL    0.05     35688       714.    35157       50            65
 7   567 CALHOUN IL    0.017     5322       313.     5298        1             8
 8   568 CARROLL IL    0.027    16805       622.    16519      111            30
 9   569 CASS    IL    0.024    13437       560.    13384       16             8
10   570 CHAMPA… IL    0.058   173025      2983.   146506    16559           331
# ℹ 427 more rows
# ℹ 19 more variables: popasian &lt;int&gt;, popother &lt;int&gt;, percwhite &lt;dbl&gt;,
#   percblack &lt;dbl&gt;, percamerindan &lt;dbl&gt;, percasian &lt;dbl&gt;, percother &lt;dbl&gt;,
#   popadults &lt;int&gt;, perchsd &lt;dbl&gt;, percollege &lt;dbl&gt;, percprof &lt;dbl&gt;,
#   poppovertyknown &lt;int&gt;, percpovertyknown &lt;dbl&gt;, percbelowpoverty &lt;dbl&gt;,
#   percchildbelowpovert &lt;dbl&gt;, percadultpoverty &lt;dbl&gt;,
#   percelderlypoverty &lt;dbl&gt;, inmetro &lt;int&gt;, category &lt;chr&gt;</code></pre>
<ul>
<li>area: 면적</li>
<li>poptotal: 총 인수수</li>
<li>popdensity: 인구밀도</li>
<li>popwhite: 백인 거주자수</li>
<li>popblack: 흑인 거주자수</li>
<li>popamerindian: 인디언 거주자수
popasian: 아시아인 거주자수</li>
<li>popother: 다른 인종 거주자수</li>
<li>percwhite, percwhite, percamerindan, percasian, percother: 각 인종의 비율</li>
<li>popadults: 성인 거주자수</li>
<li>percollege: 대학 졸업자 비율</li>
<li>percprof: 전문직 비율</li>
</ul>
<p>다음은 백인 거주자 비율과 대학 졸업자 비율에 대한 산점도이다.</p>
<div class="sourceCode" id="cb1722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1722-1"><a href="ch-visualization.html#cb1722-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(midwest, <span class="fu">aes</span>(percwhite, percollege)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb1722-2"><a href="ch-visualization.html#cb1722-2" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-126-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>위의 그래프에서 가로축은 백인의 비율인데 25% 단위로 주눈금(<code>breaks</code>)과 눈금의 값이 레이블(<code>labels</code>)로 표시되어 있다. 아울러 주눈금 사이에 보조 눈금(<code>minor.breaks</code>)이 하나씩 그려져 있고 별도의 레이블은 표시되어 있지 않다. 위의 가록축을 10% 단위로 주눈금을 표시하고 보조눈금은 디폴트 값인 주눈금 사이에 하나의 보조눈금이 그려지도록 그래프를 조정해 보자. 또한 눈금에 표시되는 레이블도 숫자만이 아니라 %가 같이 표시되도록 해 본다.</p>
<div class="sourceCode" id="cb1723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1723-1"><a href="ch-visualization.html#cb1723-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by=</span><span class="dv">10</span>), </span>
<span id="cb1723-2"><a href="ch-visualization.html#cb1723-2" tabindex="-1"></a>                  <span class="at">labels=</span><span class="fu">paste0</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-127-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>현재 x와 y 축은 데이터의 최소값과 최대값이 모두 표시될 수 있도록 적절히 그 범위가 설정되어 있다. 그런데 현재 백인의 비율은 대부분 80% 이상이어서 데이터가 서로 구분이 되지 않는다. 따라서 x축을 60에서 100%까지만 표시되도록 조정해 보자. 또한 y축의 이름을 “Percent college educated”로 바꾸어 보자. 이 경우 2개의 관측치가 그래프에 표시되지 않으므로 그에 대한 정보가 함께 출력된다.</p>
<div class="sourceCode" id="cb1724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1724-1"><a href="ch-visualization.html#cb1724-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by=</span><span class="dv">10</span>),  </span>
<span id="cb1724-2"><a href="ch-visualization.html#cb1724-2" tabindex="-1"></a>                       <span class="at">labels=</span><span class="fu">paste0</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>),</span>
<span id="cb1724-3"><a href="ch-visualization.html#cb1724-3" tabindex="-1"></a>                       <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb1724-4"><a href="ch-visualization.html#cb1724-4" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="st">&quot;Percent college educated&quot;</span>)</span></code></pre></div>
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-128-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>아울러 <code>position</code> 인수를 사용하면 좌표축의 위치를 지정할 수 있다. “left”, “right”, “top”, “bottom”의 값이 사용되는데 다음 예는 가로축과 세로축을 좌표평면의 맨 위와 맨 오른쪽으로 조정한 예이다.</p>
<div class="sourceCode" id="cb1726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1726-1"><a href="ch-visualization.html#cb1726-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">position=</span><span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb1726-2"><a href="ch-visualization.html#cb1726-2" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position=</span><span class="st">&quot;right&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-129-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>다음은 각 카운티의 면적과 인구의 산점도이다.</p>
<div class="sourceCode" id="cb1727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1727-1"><a href="ch-visualization.html#cb1727-1" tabindex="-1"></a>ap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(midwest, <span class="fu">aes</span>(area, poptotal)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1727-2"><a href="ch-visualization.html#cb1727-2" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)</span>
<span id="cb1727-3"><a href="ch-visualization.html#cb1727-3" tabindex="-1"></a>ap</span></code></pre></div>
<pre><code>`geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-130-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>대부분의 인구가 100만 미만에 몰려 있어서 그래프를 확인하기 어렵다. 이렇듯 한쪽으로 편향된 데이터를 가진 경우 로그 변환을 하면 데이터를 구분하기 좋은 때가 많다. 앞의 그래프의 y축을 로그 축적으로 변경해 보자.</p>
<div class="sourceCode" id="cb1729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1729-1"><a href="ch-visualization.html#cb1729-1" tabindex="-1"></a>ap <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">&quot;log10&quot;</span>)</span></code></pre></div>
<pre><code>`geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-131-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="좌표계의-변경" class="section level3 hasAnchor" number="8.9.2">
<h3><span class="header-section-number">8.9.2</span> 좌표계의 변경<a href="ch-visualization.html#좌표계의-변경" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>가끔은 그래프의 x와 y축을 변경하고 싶을 때가 있다. 산점도의 경우는 x와 y의 매핑을 바꾸면 간단히 축을 서로 바꿀 수 있지만 다음처럼 히스토그램의 가로축과 세로축을 바꾸려면 좀 복잡한 작업이 필요하다.</p>
<div class="sourceCode" id="cb1731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1731-1"><a href="ch-visualization.html#cb1731-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">1</span>)</span>
<span id="cb1731-2"><a href="ch-visualization.html#cb1731-2" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-132-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>이럴 때 쉽게 사용할 수 있는 것이 coord_flip() 함수이다. coord_flip() 함수는 그래프의 가로축과 세로축을 바꾸어 준다.</p>
<div class="sourceCode" id="cb1732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1732-1"><a href="ch-visualization.html#cb1732-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-133-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>coord_flip() 함수 말고도 좌표계를 변경하는 함수들이 있다. coord_polar()는 직교좌표계를 극좌표계로 변경해 준다.</p>
<div class="sourceCode" id="cb1733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1733-1"><a href="ch-visualization.html#cb1733-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">coord_polar</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-134-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1734-1"><a href="ch-visualization.html#cb1734-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, <span class="at">fill=</span>drv)) <span class="sc">+</span> </span>
<span id="cb1734-2"><a href="ch-visualization.html#cb1734-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;fill&quot;</span>) <span class="sc">+</span> <span class="fu">coord_polar</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-135-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="색상-척도color-scales의-변경" class="section level3 hasAnchor" number="8.9.3">
<h3><span class="header-section-number">8.9.3</span> 색상 척도(color scales)의 변경<a href="ch-visualization.html#색상-척도color-scales의-변경" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ggplot2는 <code>x</code>와 <code>y</code>에 매핑되는 데이터 열의 값의 범위에 따라 좌표축을 자동 생성한다. 마찬가지로 <code>color</code>나 <code>fill</code> 등의 속성에 매핑되는 데이터 열에 따라 자동으로 색상의 척도를 자동으로 지정하여, 데이터의 값에 따라 적절한 색상을 선택하여 그래프를 그린다.</p>
<p>ggplot2는 데이터 열을 색상 속성에 매핑할 때 데이터 열이 연속형 변수인지, 이산형 변수인지에 따라 색상 척도를 다르게 설정한다. 다음 두 그래프를 비고해 보자. 첫번째 그래프는 점의 <code>color</code> 속성에 이산형 변수인 <code>drv</code>가 매핑되었고, 두번재 그래프는 <code>color</code>에 연속형 변수인 <code>cty</code>가 매핑되었다.</p>
<div class="sourceCode" id="cb1735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1735-1"><a href="ch-visualization.html#cb1735-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy))</span>
<span id="cb1735-2"><a href="ch-visualization.html#cb1735-2" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>drv), <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb1735-3"><a href="ch-visualization.html#cb1735-3" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>cty), <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-136-1.png" width="45%" style="display: block; margin: auto;" /><img src="R-visualization_files/figure-html/unnamed-chunk-136-2.png" width="45%" style="display: block; margin: auto;" /></p>
<p>이산형 변수는 구분되는 색상이 지정되는 반면, 연속형 변수는 색상의 그라데이션으로 매핑이 되는 것을 볼 수 있다. 그 이유는 이산형 변수는 구분되는 제한된 값만 가지므로 정해진 색상으로 그래프를 표현할 수 있는 반면, 연속형 변수는 무수히 많은 값을 가질 수 있으므로 색상의 그라데이션의 연속적인 변화로 표현하는 것이 더 적절하기 때문이다.</p>
<p>가끔 데이터의 열이 수치로 입력이 되었지만 이산형 데이터인 경우가 있다. 예를 들어 <code>mpg</code> 데이터의 <code>year</code>는 수치로 데이터가 입력되었지만 구분되는 두 개의 연도를 가진 변수이다. 이렇듯 이산형 변수가 수치로 입력이 되어 있으면 ggplot2는 이 데이터가 연속형 수치로 판단을 하여 그라데이션으로 색상을 표현한다. 이를 방지하려면 원래의 데이터를 <code>factor</code>로 변환하여 이산형 변수로 변환해 주면 구별되는 색상으로 그래프를 표현한다.</p>
<div class="sourceCode" id="cb1736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1736-1"><a href="ch-visualization.html#cb1736-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy))</span>
<span id="cb1736-2"><a href="ch-visualization.html#cb1736-2" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>year), <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb1736-3"><a href="ch-visualization.html#cb1736-3" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(year)), <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-137-1.png" width="45%" style="display: block; margin: auto;" /><img src="R-visualization_files/figure-html/unnamed-chunk-137-2.png" width="45%" style="display: block; margin: auto;" /></p>
<p>ggplot2가 디폴트로 매핑한 색상이 마음에 들지 않으면 이를 직접 조정할 수 있다. 이를 위해서는 색상에 대한 기본적인 지식을 가지고 있어야 한다. 이 책에서는 세부적인 색상 지정과 관련된 내용은 다루지 않고, 대신 이산형 변수와 연속형 변수에 대해서 이미 만들어져 있는 색상 척도 중 하나로 색상 척도를 변경하는 방법만 다루도록 한다.
이산형 변수의 색상 매핑은 <a href="http://colorbrewer2.org">ColorBrewer</a>에서 지정한 색상 매핑(팔레트)을 사용할 수 있다. <code>RColorBrewer</code> 패키지는 ColorBrewer에서 제공하는 다양한 색상 척도를 R에서 사용할 수 있도록 해 준다. <code>RColorBrewer</code> 패키지에서 사용할 수 있는 색상 팔레트를 확인해 보려면 다음 명령을 실행해 본다.</p>
<div class="sourceCode" id="cb1737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1737-1"><a href="ch-visualization.html#cb1737-1" tabindex="-1"></a>RColorBrewer<span class="sc">::</span><span class="fu">display.brewer.all</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-138-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>팔레트에 대한 좀 더 자세한 설명을 확인하려면 다음을 수행한다. maxcolors 열은 팔레트가 이산형 변수에 사용되었을 때 최대 몇 개의 범주를 나타낼 수 있는지를 나타낸다. colorblind 열은 해당 팔레트가 색맹 친화적인 팔레트인지 아닌지에 대한 정보를 준다. category 열은 팔레트의 종류를 나타낸다.</p>
<ul>
<li>Qualitative (qual) 팔레트는 명목형 범주를 나타내기에 좀 더 적합한 팔레트로, 수치형이나 순서형 변수를 표현하기에는 적합하지 않은 팔레트이다.</li>
<li>Sequential (seq) 팔레트는 색상이 밝은 색상에서 어두운 색상으로 변화하는 팔레트로 수치형이나 순서형 변수를 표현하기에 적합한 팔레트이다.</li>
<li>Diverging (div) 팔레트는 팔레트로 수치형이나 순서형 변수를 표현하기에 적합한 팔레트인 것은 seq 팔레트와 동일하지만, 가운데 값을 밝은 색상으로, 양 극단의 값을 어두운 색으로 표현하여 가운데에 분포한 값과 극단에 위치한 값을 구분하여 표현하고 싶을 때 사용한다.</li>
</ul>
<div class="sourceCode" id="cb1738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1738-1"><a href="ch-visualization.html#cb1738-1" tabindex="-1"></a>RColorBrewer<span class="sc">::</span>brewer.pal.info</span></code></pre></div>
<pre><code>         maxcolors category colorblind
BrBG            11      div       TRUE
PiYG            11      div       TRUE
PRGn            11      div       TRUE
PuOr            11      div       TRUE
RdBu            11      div       TRUE
RdGy            11      div      FALSE
RdYlBu          11      div       TRUE
RdYlGn          11      div      FALSE
Spectral        11      div      FALSE
Accent           8     qual      FALSE
Dark2            8     qual       TRUE
Paired          12     qual       TRUE
Pastel1          9     qual      FALSE
Pastel2          8     qual      FALSE
Set1             9     qual      FALSE
Set2             8     qual       TRUE
Set3            12     qual      FALSE
Blues            9      seq       TRUE
BuGn             9      seq       TRUE
BuPu             9      seq       TRUE
GnBu             9      seq       TRUE
Greens           9      seq       TRUE
Greys            9      seq       TRUE
Oranges          9      seq       TRUE
OrRd             9      seq       TRUE
PuBu             9      seq       TRUE
PuBuGn           9      seq       TRUE
PuRd             9      seq       TRUE
Purples          9      seq       TRUE
RdPu             9      seq       TRUE
Reds             9      seq       TRUE
YlGn             9      seq       TRUE
YlGnBu           9      seq       TRUE
YlOrBr           9      seq       TRUE
YlOrRd           9      seq       TRUE</code></pre>
<p>이산형 변수로 매핑된 <code>color</code> 또는 <code>fill</code>의 ColorBrewer 척도를 바꾸려면 <code>scale_color_brewer()</code> 또는 <code>scale_fill_brewer()</code>를 사용한다.</p>
<div class="sourceCode" id="cb1740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1740-1"><a href="ch-visualization.html#cb1740-1" tabindex="-1"></a>p_drv <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>drv), <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb1740-2"><a href="ch-visualization.html#cb1740-2" tabindex="-1"></a>p_drv</span>
<span id="cb1740-3"><a href="ch-visualization.html#cb1740-3" tabindex="-1"></a>p_drv <span class="sc">+</span> <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span>
<span id="cb1740-4"><a href="ch-visualization.html#cb1740-4" tabindex="-1"></a>p_drv <span class="sc">+</span> <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Accent&quot;</span>)</span>
<span id="cb1740-5"><a href="ch-visualization.html#cb1740-5" tabindex="-1"></a>p_drv <span class="sc">+</span> <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-140-1.png" width="45%" style="display: block; margin: auto;" /><img src="R-visualization_files/figure-html/unnamed-chunk-140-2.png" width="45%" style="display: block; margin: auto;" /><img src="R-visualization_files/figure-html/unnamed-chunk-140-3.png" width="45%" style="display: block; margin: auto;" /><img src="R-visualization_files/figure-html/unnamed-chunk-140-4.png" width="45%" style="display: block; margin: auto;" /></p>
<p>연속형 변수로 매핑된 <code>color</code> 또는 <code>fill</code>도 ColorBrewer 척도를 이용하여 연속적인 그라데이션으로 연속형 변수의 값을 표현할 수 있다. ColorBrewer 척도를 바꾸려면 <code>scale_color_distiller()</code> 또는 <code>scale_fill_distiller()</code>를 사용한다. Distiller 척도는 팔레트의 색상을 내삽하여 부드러운 그라데이션을 만들어 준다.</p>
<div class="sourceCode" id="cb1741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1741-1"><a href="ch-visualization.html#cb1741-1" tabindex="-1"></a>p_cty <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>cty), <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb1741-2"><a href="ch-visualization.html#cb1741-2" tabindex="-1"></a>p_cty</span>
<span id="cb1741-3"><a href="ch-visualization.html#cb1741-3" tabindex="-1"></a>p_cty <span class="sc">+</span> <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;RdPu&quot;</span>)</span>
<span id="cb1741-4"><a href="ch-visualization.html#cb1741-4" tabindex="-1"></a>p_cty <span class="sc">+</span> <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;YlOrBr&quot;</span>)</span>
<span id="cb1741-5"><a href="ch-visualization.html#cb1741-5" tabindex="-1"></a>p_cty <span class="sc">+</span> <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;Greens&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-141-1.png" width="45%" style="display: block; margin: auto;" /><img src="R-visualization_files/figure-html/unnamed-chunk-141-2.png" width="45%" style="display: block; margin: auto;" /><img src="R-visualization_files/figure-html/unnamed-chunk-141-3.png" width="45%" style="display: block; margin: auto;" /><img src="R-visualization_files/figure-html/unnamed-chunk-141-4.png" width="45%" style="display: block; margin: auto;" /></p>
</div>
<div id="labelsmodification" class="section level3 hasAnchor" number="8.9.4">
<h3><span class="header-section-number">8.9.4</span> 레이블 조정<a href="ch-visualization.html#labelsmodification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ggplot2</code>는 그래프의 좌표축과 범례의 이름을 자동으로 설정한다.
기본 설정은 사용된 열 이름이나 표현식이다.
데이터를 탐색하기 위해 그래프를 그리는 동안에는 이러한 레이블을 사용하는 것은 문제가 없지만, 발표를 위해서는 독자가 이해하기 쉬운 레이블로 그래프의 제목, 축 이름, 범례의 이름을 바꿔주는 것이 좋다.</p>
<p>labs() 함수는 그래프의 제목, 축 이름, 범례의 이름을 쉽게 바꿀 수 있게 해준다.</p>
<div class="sourceCode" id="cb1742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1742-1"><a href="ch-visualization.html#cb1742-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, cty, <span class="at">color=</span>class, <span class="at">shape=</span><span class="fu">factor</span>(cyl))) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb1742-2"><a href="ch-visualization.html#cb1742-2" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-142-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>위 그래프를 다음처럼 범례 이름, 축의 이름, 그래프의 제목을 좀 더 의미있는 내용으로 바꾸어 보자.</p>
<div class="sourceCode" id="cb1743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1743-1"><a href="ch-visualization.html#cb1743-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;displacement vs. city fuel economy&quot;</span>, </span>
<span id="cb1743-2"><a href="ch-visualization.html#cb1743-2" tabindex="-1"></a>         <span class="at">x=</span><span class="st">&quot;displacement(liter)&quot;</span>, <span class="at">y=</span><span class="st">&quot;city fuel economy(miles/gallon)&quot;</span>,</span>
<span id="cb1743-3"><a href="ch-visualization.html#cb1743-3" tabindex="-1"></a>         <span class="at">color=</span><span class="st">&quot;car class&quot;</span>, <span class="at">shape=</span><span class="st">&quot;number of cylinders&quot;</span>)</span>
<span id="cb1743-4"><a href="ch-visualization.html#cb1743-4" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-143-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="themes" class="section level3 hasAnchor" number="8.9.5">
<h3><span class="header-section-number">8.9.5</span> 테마 변경<a href="ch-visualization.html#themes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>테마는 <code>ggplot2</code> 그래프의 전체적인 외양을 결정한다. 테마는 그래프의 배경 색, 글자 폰트, 격자선 모양, 범례의 위치 등의 그래프의 외양을 결정한다. <code>theme_gray()</code>는 디폴트 테마이며, 다음처럼 테마 함수를 추가하면 관련 테마가 적용된다.</p>
<div class="sourceCode" id="cb1744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1744-1"><a href="ch-visualization.html#cb1744-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_gray</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-144-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1745-1"><a href="ch-visualization.html#cb1745-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-145-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1746-1"><a href="ch-visualization.html#cb1746-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_dark</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-146-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1747-1"><a href="ch-visualization.html#cb1747-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-147-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1748-1"><a href="ch-visualization.html#cb1748-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_linedraw</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-148-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1749-1"><a href="ch-visualization.html#cb1749-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-149-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1750-1"><a href="ch-visualization.html#cb1750-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-150-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>지금까지는 <code>ggplot2</code> 패키지가 자체적으로 제공하는 테마만 보았다. <code>ggthemes</code> 패키지를 설치하면 더 많은 테마를 사용할 수 있다.</p>
<div class="sourceCode" id="cb1751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1751-1"><a href="ch-visualization.html#cb1751-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ggthemes&quot;</span>)</span></code></pre></div>
<p><code>ggthemes</code> 패키지가 제공하는 테마는 매우 많지만 그 중에 몇 가지 예만 살펴본다.</p>
<div class="sourceCode" id="cb1752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1752-1"><a href="ch-visualization.html#cb1752-1" tabindex="-1"></a>p <span class="sc">+</span> ggthemes<span class="sc">::</span><span class="fu">theme_base</span>()       <span class="co"># R의 기본 graphics과 유사한 테마</span></span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-152-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1753-1"><a href="ch-visualization.html#cb1753-1" tabindex="-1"></a>p <span class="sc">+</span> ggthemes<span class="sc">::</span><span class="fu">theme_economist</span>()  <span class="co"># The Economist 그래프와 유사한 테마</span></span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-153-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1754-1"><a href="ch-visualization.html#cb1754-1" tabindex="-1"></a>p <span class="sc">+</span> ggthemes<span class="sc">::</span><span class="fu">theme_excel</span>()      <span class="co"># MS Excel 그래프와 유사한 테마</span></span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-154-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1755-1"><a href="ch-visualization.html#cb1755-1" tabindex="-1"></a>p <span class="sc">+</span> ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()        <span class="co"># Stephen Few가 주창한 가이드를 따르는 테마</span></span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-154-2.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1756-1"><a href="ch-visualization.html#cb1756-1" tabindex="-1"></a>p <span class="sc">+</span> ggthemes<span class="sc">::</span><span class="fu">theme_tufte</span>()      <span class="co"># Edward Turfte가 주창한 가이드를 따르는 테마</span></span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-154-3.png" width="70%" style="display: block; margin: auto;" /></p>
<p>이 중에 어떤 테마를 사용하는가는 시각화의 목적과 사용자의 취향에 달려있다.
그런데 좋은 데이터 시각화의 원칙에서 보면 그래프는 높은 데이터 밀도를 가져야 한다.
높은 데이터 밀도란 사용된 잉크 대비 표현되는 데이터가 많은 것을 의미한다.
따라서 뒷 배경이 복잡하거난 색상이 많은 테마보다는 간결한 테마를 선택하는 것이 좋다.
그래야 시각화에서 강조하려는 부분을 강조할 수 있는 여유 공간이 그래프에 생기고, 독자가 더 빨리 그래프의 의미를 알아차릴 수 있다.</p>
<p>그런데 모든 그래프에 기본 테마가 아닌 테마를 일괄 적용하고 싶으면, 모든 그래프에 해당 theme 함수를 일일이 적용하기보다는 기본 테마 설정을 변경하는 것이 편리하다.
<code>theme_get()</code> 함수는 현재의 기본 테마를 반환하고, <code>theme_set()</code> 함수는 기본 테마를 변경한다.
현재의 기본 테마를 임시 저장한 후, 새로운 테마로 그래프를 그리고, 다시 원해의 기본 테마를 복원하고자 할 때, 이 두 함수가 사용된다. (<code>theme_set()</code>은 현재의 기본 테마를 반환하기 때문에 다음 예에서 <code>oldTheme</code> 변수에 기존 테마를 저장하는 작업을 <code>theme_set()</code> 함수에서도 할 수도 있다.)</p>
<div class="sourceCode" id="cb1757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1757-1"><a href="ch-visualization.html#cb1757-1" tabindex="-1"></a>oldTheme <span class="ot">&lt;-</span> <span class="fu">theme_get</span>()     <span class="co"># 현재 기본 테마 저장</span></span>
<span id="cb1757-2"><a href="ch-visualization.html#cb1757-2" tabindex="-1"></a>p                           <span class="co"># 현재의 기본 테마로 그래프 출력</span></span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-155-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1758-1"><a href="ch-visualization.html#cb1758-1" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>())  <span class="co"># theme_classic으로 기본 테마 설정 </span></span>
<span id="cb1758-2"><a href="ch-visualization.html#cb1758-2" tabindex="-1"></a>p                           <span class="co"># 바뀐 기본 테마로 그래프 출력</span></span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-155-2.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1759-1"><a href="ch-visualization.html#cb1759-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">shape =</span> <span class="st">&quot;실린더 수&quot;</span>, <span class="at">color =</span> <span class="st">&quot;분류&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-155-3.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1760-1"><a href="ch-visualization.html#cb1760-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(mpg<span class="sc">$</span>cty), <span class="at">linetype=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-155-4.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1761-1"><a href="ch-visualization.html#cb1761-1" tabindex="-1"></a><span class="fu">theme_set</span>(oldTheme)         <span class="co"># 원래의 기본 테마 복원</span></span>
<span id="cb1761-2"><a href="ch-visualization.html#cb1761-2" tabindex="-1"></a>p                           <span class="co"># 원래의 기본 테마로 그래프 출력</span></span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-155-5.png" width="70%" style="display: block; margin: auto;" /></p>
<p>사용자는 테마를 바꾸는 것뿐만 아니라, 현재 적용된 테마에 설정된 각 요소를 <code>theme()</code> 함수를 사용하여 직접 변경할 수 있다. 테마에서 가장 빈번이 변경되는 요소가 범례의 위치이다.</p>
<div class="sourceCode" id="cb1762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1762-1"><a href="ch-visualization.html#cb1762-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-156-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>이 외에도 그래프 레이블들의 형태와 백그라운드 색 등 다양한 요소를 조정할 수 있다. 더 자세한 내용을 알고싶으면 <code>??theme</code>을 이용하여 관련 도움말을 확인하기 바란다. 만약 빈번히 사용되는 테마 요소가 있다면 다음 예처럼 변수에 저장을 해 둔 후, 여러 그래프에 적용시킬 수 있다.</p>
<div class="sourceCode" id="cb1763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1763-1"><a href="ch-visualization.html#cb1763-1" tabindex="-1"></a>myTheme <span class="ot">&lt;-</span> <span class="fu">theme</span>(</span>
<span id="cb1763-2"><a href="ch-visualization.html#cb1763-2" tabindex="-1"></a>    <span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold.italic&quot;</span>, <span class="at">size=</span><span class="dv">16</span>, <span class="at">color=</span><span class="st">&quot;orange&quot;</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb1763-3"><a href="ch-visualization.html#cb1763-3" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;lightyellow&quot;</span>, <span class="at">color=</span><span class="st">&quot;green&quot;</span>),</span>
<span id="cb1763-4"><a href="ch-visualization.html#cb1763-4" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb1763-5"><a href="ch-visualization.html#cb1763-5" tabindex="-1"></a>p <span class="sc">+</span> myTheme</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-157-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1764-1"><a href="ch-visualization.html#cb1764-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(hwy, <span class="at">fill=</span>drv)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb1764-2"><a href="ch-visualization.html#cb1764-2" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;A graph with my theme&quot;</span>) <span class="sc">+</span> myTheme </span></code></pre></div>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-158-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그런데 다수의 그래프에 변경된 테마 요소를 적용하여 한다면, 테마 요소를 변수에 저장하였어도 매번 그래프에 일일이 적용해야 하므로 꽤 번거롭다.
이 경우 <code>theme_update()</code> 함수를 사용하면 기본 테마의 요소를 변경할 수 있다.
<code>theme_update()</code> 함수는 <code>theme_set()</code> 함수와 마찬가지로 기존 기본 테마를 반환하므로 이를 저장하였다가 다시 원래의 테마를 복원할 수 있다.</p>
<div class="sourceCode" id="cb1766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1766-1"><a href="ch-visualization.html#cb1766-1" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-159-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1767-1"><a href="ch-visualization.html#cb1767-1" tabindex="-1"></a>oldTheme <span class="ot">&lt;-</span> <span class="fu">theme_update</span>(</span>
<span id="cb1767-2"><a href="ch-visualization.html#cb1767-2" tabindex="-1"></a>    <span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold.italic&quot;</span>, <span class="at">size=</span><span class="dv">16</span>, <span class="at">color=</span><span class="st">&quot;orange&quot;</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb1767-3"><a href="ch-visualization.html#cb1767-3" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;lightyellow&quot;</span>, <span class="at">color=</span><span class="st">&quot;green&quot;</span>),</span>
<span id="cb1767-4"><a href="ch-visualization.html#cb1767-4" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb1767-5"><a href="ch-visualization.html#cb1767-5" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-159-2.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1768-1"><a href="ch-visualization.html#cb1768-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(mpg<span class="sc">$</span>cty), <span class="at">linetype=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-159-3.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1769-1"><a href="ch-visualization.html#cb1769-1" tabindex="-1"></a><span class="fu">theme_set</span>(oldTheme)</span></code></pre></div>
</div>
</div>
<div id="misc" class="section level2 hasAnchor" number="8.10">
<h2><span class="header-section-number">8.10</span> 기타 유용한 팁들<a href="ch-visualization.html#misc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="combinegraph" class="section level3 hasAnchor" number="8.10.1">
<h3><span class="header-section-number">8.10.1</span> 여러 그래프를 한 도표에 넣기<a href="ch-visualization.html#combinegraph" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ggplot2</code>에서 그린 여러 그래프를 한 도표에 넣으려면 <code>gridExtra</code> 패키지의 <code>grid.arrange()</code> 함수를 이용하면 편리하다.
<code>gridExtra</code> 패키지를 사용하려면 먼저 설치를 해야 한다.</p>
<div class="sourceCode" id="cb1770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1770-1"><a href="ch-visualization.html#cb1770-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;gridExtra&quot;</span>)</span></code></pre></div>
<p>그리고 나서 메모리에 적재한다.</p>
<div class="sourceCode" id="cb1771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1771-1"><a href="ch-visualization.html#cb1771-1" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code></pre></div>
<pre><code>
다음의 패키지를 부착합니다: &#39;gridExtra&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:dplyr&#39;:

    combine</code></pre>
<p>다음처럼 4개의 그래프를 <code>ggplot2</code>로 그렸다고 해보자. <code>grid.arrange()</code> 함수는 다양한 방식으로 그래프를 조합하여 하나의 도표를 만들 수 있다.</p>
<div class="sourceCode" id="cb1774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1774-1"><a href="ch-visualization.html#cb1774-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(drv, displ)) <span class="sc">+</span> <span class="fu">geom_jitter</span>()</span>
<span id="cb1774-2"><a href="ch-visualization.html#cb1774-2" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(drv, displ)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span>
<span id="cb1774-3"><a href="ch-visualization.html#cb1774-3" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(drv, displ)) <span class="sc">+</span> <span class="fu">geom_violin</span>()</span>
<span id="cb1774-4"><a href="ch-visualization.html#cb1774-4" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, <span class="at">ncol=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-162-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1775-1"><a href="ch-visualization.html#cb1775-1" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">2</span>) </span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-163-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1776-1"><a href="ch-visualization.html#cb1776-1" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">widths=</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-164-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1777-1"><a href="ch-visualization.html#cb1777-1" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">heights=</span><span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-165-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>다음은 <code>arrangeGrob()</code> 함수로 그래프를 묶은 다음 다시 이를 <code>grid.arrange()</code>에 보내 좀더 다양한 레이아웃의 그래프를 그린 예이다.</p>
<div class="sourceCode" id="cb1778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1778-1"><a href="ch-visualization.html#cb1778-1" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, <span class="fu">arrangeGrob</span>(p2, p3, <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">widths=</span><span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>)), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">heights=</span><span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>))</span></code></pre></div>
<p><img src="R-visualization_files/figure-html/unnamed-chunk-166-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>그런데 <code>gridExtra</code> 패키지의 <code>grid.arrange()</code> 함수는 조합하는 그래프의 패널을 정렬하지 않는다.
따라서 조합된 각 그래프의 축들이 서로 정렬이 되어 나타나지 않을 수 있다.
아울러 조합되는 그래프에 공통된 범례가 있는 경우 하나의 법례를 공통으로 나타내기도 어렵다.
<code>ggpubr</code> 패키지의 <code>ggarrange()</code>을 사용하면 조합되는 그래프의 패널을 정렬시키고 공통의 범례를 부여할 수 있다.
<code>ggpubr</code> 패키지에 대한 자세한 내용은 <a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr: ‘ggplot2’ Based Publication Ready Plots</a>을 참조한다.</p>
</div>
<div id="savegraph" class="section level3 hasAnchor" number="8.10.2">
<h3><span class="header-section-number">8.10.2</span> 그래프 저장하기<a href="ch-visualization.html#savegraph" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>RStudio 사용자가 R에서 그린 그래프를 저장하려면, RStudio의 [Plot] 패널에서 [Export]-[Save as Image…] 메뉴를 이용하면 된다. 이 메뉴를 사용하면 그래프를 저장할 파일 형식, 위치, 이름, 크기를 지정하여 저장할 수 있다. R 콘솔에서 그래프를 저장하려면 다음처럼 <code>ggsave()</code> 함수를 이용한다.</p>
<div class="sourceCode" id="cb1779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1779-1"><a href="ch-visualization.html#cb1779-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cty, hwy)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb1779-2"><a href="ch-visualization.html#cb1779-2" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file=</span><span class="st">&quot;myplot.png&quot;</span>, <span class="at">plot=</span>p, <span class="at">width=</span><span class="dv">5</span>, <span class="at">height=</span><span class="dv">4</span>)</span></code></pre></div>
<!-- ## `grid` 패키지* {#gird} -->
<!-- 이 절은 고급 사용자가 아니면 필요성이 적은 내용이므로 건너뛸 것을 권장한다. -->
<!-- 이 절의 내용은 [Mastering Software Development in R의 grid 패키지 절](https://bookdown.org/rdpeng/RProgDA/the-grid-package.html)를 참조하였다. -->
<!-- `ggplot2` 패키지는 `grid`라는 패키지에 기반하여 그래픽 객체를 생성한다. 또 다른 **R**의 그래픽 패키지인 `lattice`도 `grid`를 기반으로 한다.  -->
<!-- `grid` 패키지는 **R**의 저수준 그래픽 시스템으로 그래프에 표시할 그래픽 객체의 세부적 사항을 직접 조정하고 생성할 수 있다. 그러나 저수준 그래픽 시스템이므로 `grid` 패키지로 그래프를 그리려면 매우 긴 코드를 작성하여야 하나의 그래프를 작성할 수 있다. -->
<!-- 반면 `ggplot2` 패키지는 고수준 그래픽 시스템으로 한두 줄의 코드로도 원하는 그래프를 그릴 수 있다. -->
<!-- 그러므로 그래프를 그릴 때 `grid` 패키지를 사용하는 것은 권장되지 않는다. -->
<!-- `ggplot2` 패키지나, `ggplot2` 패키지를 근거하여 다양한 그래픽 객체를 제공하는 패키지를 찾아보면 대부분의 사용자가 원하는 그래프를 그릴 수 있을 것이다. -->
<!-- 그러나 가끔은 매우 특이한 그래프를 그려야 할 때가 있고, `ggplot2`에 새로운 그래픽 객체를 추가하고 싶을 수도 있다. -->
<!-- 이러한 경우에는 `grid` 패키지를 이용하여 원하는 그래프를 생성할 수 있다. -->
<!-- `ggplot2` 패키지는 `grid` 패키지를 기반으로 하고 있기 대문에 `ggplot2`에서 생성된 그래프를 `grid` 패키지를 이용하여 조정할 수 있다. 반면 **R**의 기본 그래픽 패키지인 `graphics` 패키지는 `grid` 패키지를 저수준 그래픽 시스템으로 사용하지 않는다. `graphics` 패키지는 자체적으로 저수준 그래픽 함수와 `plot()` 같은 고수준 그래픽 함수를 모두 포함하고 있다. -->
<!-- 그렇기 때문에 `graphics` 패키지로 생성된 그래프를 `grid` 기반으로 생성된 그래프와 합치는 것은 쉽지 않다.^[`gridBase`라는 패키지를 사용하면 가능은 하다.] -->
<!-- `grid` 패키지는 시스템 패키지로 포함이 되어서 설치할 필요는 없다. -->
<!-- 그러나 **R** 시작 시 자동으로 적재는 되지 않으므로 사용을 하려면 먼저 적재해야 한다. -->
<!-- ```{r} -->
<!-- library(grid) -->
<!-- ``` -->
<!-- ### Grob (Grid Grapical Object) -->
<!-- Grob은 `grid` 패키지에서 사용하는 그래픽 객체를 의미한다. -->
<!-- 예를 들어 점, 원, 선분, 사각형 등의 다양한 grob 객체가 정의될 수 있다. -->
<!-- Grob 객체들은 `ggplot2` 패키지의 geom 객체처럼 더 큰 gropb 객체에 더해기저나 제거될 수 있다. -->
<!-- `grid` 패키지는 grob 객체를 생성하고 변경할 수 있도록 `*Grob` 함수족을 제공한다. -->
<!-- 대표적은 `circleGrob`, `lineGrob`, `polygonGrob`, `rectGrob`, `rasterGrob`, `segmentsGrob`, `legendGrob`, `xaxisGrob`, `yaxisGrob` 등의 Grob 함수가 있다. -->
<!-- 이 외에도 `gridExtra` 같은 패키지에서 다른 종류의 grob 객체도 제공한다. -->
<!-- 예를 들어 `gridExtra` 패키지로 `arrangeGrob()`나 `grid.arrange()` 함수로 여러 grob 객체의 배열인 grob 객체를 만들 수도 있고, `tableGrob()` 함수로 표를 grob 객체로 만들 수도 있다. -->
<!-- Grob 함수는 일반적으로 grob 객체가 놓여질 위치를 인수로 갖는다. -->
<!-- 예를 들어, `pointGrob`의 경우 `x`와 `y` 인수로 점의 위치를 설정하고, `segmentsGrob` 함수는 각 선분의 시작과 끝 위치를 `x0`, `x1`, `y0`, `y1` 인수로 지정한다. -->
<!-- 또한 Grob 함수는 `gp`라는 인수로 그래픽 객체의 색상, 선 종류, 선 두게 등의 그래픽 속성을 지정받는다. -->
<!-- `gp` 인수의 입력으로는 `gpar()` 함수의 결과를 전달한다. -->
<!-- 다음은 파란색 사각형 안에 붉은색 파선으로 된 원 grob 객체를 생성한 예이다.  -->
<!-- 사각형과 원의 위치는 중앙에 사각형의 폭과 높이, 원의 반지름은 좌표 평면을 가득채우게 설정되었다.  -->
<!-- ```{r} -->
<!-- blue_rect <- rectGrob(name="blue_rect", x=0.5, y=0.5, width=1, height=1,  -->
<!--                       gp = gpar(col="blue", lty=1)) -->
<!-- red_circle <- circleGrob(x=0.5, y=0.5, r=0.5, -->
<!--                          gp = gpar(col="red", lty=2)) -->
<!-- ``` -->
<!-- `gpar()`로 지정할 수 있는 그래픽 속성은 색상(`col`), 채우기 색상(`fill`), 투명도(`alpha`), 선 종류(`lty`), 선 두께(`lwd`), 글자 크기(`fontsize`) 등을 지정할 수 있다. -->
<!-- Grob 객체를 만들었으면 `grid.draw()` 함수를 사용하여 현재의 그래픽 장치에 만든 grob 객체를 그려보자. -->
<!-- ```{r} -->
<!-- grid.draw(blue_rect) -->
<!-- grid.draw(red_circle) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- grid.draw(blue_rect) -->
<!-- grid.draw(red_circle) -->
<!-- grid.ls() -->
<!-- grid.edit("blue_rect", gp=gpar(col="gray")) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- p <- ggplot(mpg, aes(displ, cty)) + -->
<!--   geom_point() +  -->
<!--   theme_minimal() -->
<!-- p -->
<!-- grid.force() -->
<!-- grid.ls() -->
<!-- ``` -->

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="7">
<li id="fn7"><p>함수를 <code>+</code>로 결합시키는 것은 ggplot2에서만 사용하는 방식으로 다른 R 함수에는 적용되지는 않는다.<a href="ch-visualization.html#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p><code>mapping</code>에 범주형 변수가 맵핑되면 <code>group</code> 속성에 함께 이용되므로, <code>group=``이 없으면 이 예에서는</code>cut`의 수준별로 상대 빈도를 구하게 된다.<a href="ch-visualization.html#fnref8" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch-dataTransformation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-R-Advanced-Data-Mgmt.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R-programming-3rd.pdf", "R-programming-3rd.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
